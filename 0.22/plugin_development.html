<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]--><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="Asciidoctor 2.0.13"><link href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" /><link rel="stylesheet" href="https://cdn.staticaly.com/gh/afeld/bootstrap-toc/v1.0.0/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" /><title>Plugin development</title><style>/*Default CSS*/

/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove the comments around the @import statement below when using this as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400";*/
/* @import "https://stylishthemes.github.io/Syntax-Themes/pygments/css-github/pygments-base16-monokai-dark.css"; */

article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
nav,
section,
summary {
  display: block;
}
audio,
canvas,
video {
  display: inline-block;
}
audio:not([controls]) {
  display: none;
  height: 0;
}
[hidden],
template {
  display: none;
}
script {
  display: none !important;
}
/* html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%} */
body {
  margin: 0;
}
a {
  background: transparent;
  text-decoration: none !important;
}
a:focus {
  outline: thin dotted;
}
a:active,
a:hover {
  outline: 0;
}
h1 {
  font-size: 2em;
  margin: 0.67em 0;
}
abbr[title] {
  border-bottom: 1px dotted;
}
b,
strong {
  font-weight: bold;
}
dfn {
  font-style: italic;
}
hr {
  -moz-box-sizing: content-box;
  box-sizing: content-box;
  height: 0;
}
mark {
  background: #ff0;
  color: #000;
}
code,
kbd,
pre,
samp {
  font-family: monospace;
  font-size: 1em;
}
pre {
  white-space: pre-wrap;
}
q {
  quotes: "\201C" "\201D" "\2018" "\2019";
}
small {
  font-size: 80%;
}
sub,
sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}
sup {
  top: -0.5em;
}
sub {
  bottom: -0.25em;
}
img {
  border: 0;
}
svg:not(:root) {
  overflow: hidden;
}
figure {
  margin: 0;
}
fieldset {
  border: 1px solid silver;
  margin: 0 2px;
  padding: 0.35em 0.625em 0.75em;
}
legend {
  border: 0;
  padding: 0;
}
/* button,input,select,textarea{font-family:inherit;font-size:100%;margin:0} */
button,
input {
  line-height: normal;
}
button,
select {
  text-transform: none;
}
button,
html input[type="button"],
input[type="reset"],
input[type="submit"] {
  -webkit-appearance: button;
  cursor: pointer;
}
button[disabled],
html input[disabled] {
  cursor: default;
}
input[type="checkbox"],
input[type="radio"] {
  box-sizing: border-box;
  padding: 0;
}
input[type="search"] {
  -webkit-appearance: textfield;
  -moz-box-sizing: content-box;
  -webkit-box-sizing: content-box;
  box-sizing: content-box;
}
input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
  -webkit-appearance: none;
}
button::-moz-focus-inner,
input::-moz-focus-inner {
  border: 0;
  padding: 0;
}
textarea {
  overflow: auto;
  vertical-align: top;
}
table {
  border-collapse: collapse;
  border-spacing: 0;
}
*,
*:before,
*:after {
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  box-sizing: border-box;
}
html,
body {
  font-size: 100%;
}
/* body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto} */
a:hover {
  cursor: pointer;
}
img,
object,
embed {
  max-width: 100%;
  height: auto;
}
object,
embed {
  height: 100%;
}
img {
  -ms-interpolation-mode: bicubic;
}
#map_canvas img,
#map_canvas embed,
#map_canvas object,
.map_canvas img,
.map_canvas embed,
.map_canvas object {
  max-width: none !important;
}
.left {
  float: left !important;
}
.right {
  float: right !important;
}
.text-left {
  text-align: left !important;
}
.text-right {
  text-align: right !important;
}
.text-center {
  text-align: center !important;
}
.text-justify {
  text-align: justify !important;
}
.hide {
  display: none;
}
.antialiased,
body {
  -webkit-font-smoothing: antialiased;
}
img {
  display: inline-block;
  vertical-align: middle;
}
textarea {
  height: auto;
  min-height: 50px;
}
select {
  width: 100%;
}
p.lead,
.paragraph.lead > p,
#preamble > .sectionbody > .paragraph:first-of-type p {
  font-size: 1.21875em;
  line-height: 1.6;
}
.subheader,
.admonitionblock td.content > .title,
.audioblock > .title,
.exampleblock > .title,
.imageblock > .title,
.listingblock > .title,
.literalblock > .title,
.stemblock > .title,
.openblock > .title,
.paragraph > .title,
.quoteblock > .title,
table.tableblock > .title,
.verseblock > .title,
.videoblock > .title,
.dlist > .title,
.olist > .title,
.ulist > .title,
.qlist > .title,
.hdlist > .title {
  line-height: 1.45;
  color: #7a2518;
  font-weight: 400;
  margin-top: 0;
  margin-bottom: 0.25em;
}
div,
dl,
dt,
dd,
ul,
ol,
li,
h1,
h2,
h3,
#toctitle,
.sidebarblock > .content > .title,
h4,
h5,
h6,
pre,
form,
p,
blockquote,
th,
td {
  margin: 0;
  padding: 0;
  direction: ltr;
}
a {
  color: #2156a5;
  text-decoration: underline;
  line-height: inherit;
}
a:hover,
a:focus {
  color: #1d4b8f;
}
a img {
  border: none;
}
p {
  font-family: inherit;
  font-weight: 400;
  font-size: 1em;
  line-height: 1.6;
  margin-bottom: 1.25em;
  text-rendering: optimizeLegibility;
}
p aside {
  font-size: 0.875em;
  line-height: 1.35;
  font-style: italic;
}
h1,
h2,
h3,
#toctitle,
.sidebarblock > .content > .title,
h4,
h5,
h6 {
  font-family: "Open Sans", "DejaVu Sans", sans-serif;
  font-weight: 300;
  font-style: normal;
  color: #e44c3a;
  text-rendering: optimizeLegibility;
  margin-top: 1em;
  margin-bottom: 0.5em;
  line-height: 1.0125em;
}
h1 small,
h2 small,
h3 small,
#toctitle small,
.sidebarblock > .content > .title small,
h4 small,
h5 small,
h6 small {
  font-size: 60%;
  color: #e99b8f;
  line-height: 0;
}
h1 {
  font-size: 2.125em;
}
h2 {
  font-size: 1.6875em;
}
h3,
#toctitle,
.sidebarblock > .content > .title {
  font-size: 1.375em;
}
h4,
h5 {
  font-size: 1.125em;
}
h6 {
  font-size: 1em;
}
hr {
  border: solid #ddddd8;
  border-width: 1px 0 0;
  clear: both;
  margin: 1.25em 0 1.1875em;
  height: 0;
}
em,
i {
  font-style: italic;
  line-height: inherit;
}
strong,
b {
  font-weight: bold;
  line-height: inherit;
}
small {
  font-size: 60%;
  line-height: inherit;
}
code {
  font-family: "Droid Sans Mono", "DejaVu Sans Mono", monospace;
  font-weight: 400;
  color: rgba(0, 0, 0, 0.9);
}
ul,
ol,
dl {
  font-size: 1em;
  line-height: 1.6;
  margin-bottom: 1.25em;
  list-style-position: outside;
  font-family: inherit;
}
ul,
ol,
ul.no-bullet,
ol.no-bullet {
  margin-left: 1.5em;
}
ul li ul,
ul li ol {
  margin-left: 1.25em;
  margin-bottom: 0;
  font-size: 1em;
}
ul.square li ul,
ul.circle li ul,
ul.disc li ul {
  list-style: inherit;
}
ul.square {
  list-style-type: square;
}
ul.circle {
  list-style-type: circle;
}
ul.disc {
  list-style-type: disc;
}
ul.no-bullet {
  list-style: none;
}
ol li ul,
ol li ol {
  margin-left: 1.25em;
  margin-bottom: 0;
}
dl dt {
  margin-bottom: 0.3125em;
  font-weight: bold;
}
dl dd {
  margin-bottom: 1.25em;
}
abbr,
acronym {
  text-transform: uppercase;
  font-size: 90%;
  color: rgba(0, 0, 0, 0.8);
  border-bottom: 1px dotted #ddd;
  cursor: help;
}
abbr {
  text-transform: none;
}
blockquote {
  margin: 0 0 1.25em;
  padding: 0.5625em 1.25em 0 1.1875em;
  border-left: 1px solid #ddd;
}
blockquote cite {
  display: block;
  font-size: 0.9375em;
  color: rgba(0, 0, 0, 0.6);
}
blockquote cite:before {
  content: "\2014 \0020";
}
blockquote cite a,
blockquote cite a:visited {
  color: rgba(0, 0, 0, 0.6);
}
blockquote,
blockquote p {
  line-height: 1.6;
  color: rgba(0, 0, 0, 0.85);
}
@media only screen and (min-width: 768px) {
  h1,
  h2,
  h3,
  #toctitle,
  .sidebarblock > .content > .title,
  h4,
  h5,
  h6 {
    line-height: 1.2;
  }
  h1 {
    font-size: 2.75em;
  }
  h2 {
    font-size: 2.3125em;
  }
  h3,
  #toctitle,
  .sidebarblock > .content > .title {
    font-size: 1.6875em;
  }
  h4 {
    font-size: 1.4375em;
  }
}
table {
  /* background: #fff; */
  margin-bottom: 1.25em;
  /* border: solid 1px #dedede; */
}
table thead,
table tfoot {
  /* background: #f7f8f7; */
  font-weight: bold;
}
table thead tr th,
table thead tr td,
table tfoot tr th,
table tfoot tr td {
  padding: 0.5em 0.625em 0.625em;
  font-size: inherit;
  color: rgba(0, 0, 0, 0.8);
  text-align: left;
}
table tr th,
table tr td {
  padding: 0.5625em 0.625em;
  font-size: inherit;
  color: rgba(0, 0, 0, 0.8);
}
table tr.even,
table tr.alt,
table tr:nth-of-type(even) {
  background: #f8f8f7;
}
table thead tr th,
table tfoot tr th,
table tbody tr td,
table tr td,
table tfoot tr td {
  display: table-cell;
  line-height: 1.6;
}
h1,
h2,
h3,
#toctitle,
.sidebarblock > .content > .title,
h4,
h5,
h6 {
  line-height: 1.2;
  word-spacing: -0.05em;
}
h1 strong,
h2 strong,
h3 strong,
#toctitle strong,
.sidebarblock > .content > .title strong,
h4 strong,
h5 strong,
h6 strong {
  font-weight: 400;
}
.clearfix:before,
.clearfix:after,
.float-group:before,
.float-group:after {
  content: " ";
  display: table;
}
.clearfix:after,
.float-group:after {
  clear: both;
}
*:not(pre) > code {
  font-size: 0.9375em;
  font-style: normal !important;
  letter-spacing: 0;
  padding: 0.1em 0.5ex;
  word-spacing: -0.15em;
  /* background-color: #f7f7f8; */
  -webkit-border-radius: 4px;
  border-radius: 4px;
  line-height: 1.45;
  text-rendering: optimizeSpeed;
}
pre,
pre > code {
  line-height: 1.45;
  /* color: rgba(0, 0, 0, 0.9); */
  font-family: "Droid Sans Mono", "DejaVu Sans Mono", monospace;
  font-weight: 400;
  text-rendering: optimizeSpeed;
}
.keyseq {
  color: rgba(51, 51, 51, 0.8);
}
kbd {
  display: inline-block;
  color: rgba(0, 0, 0, 0.8);
  font-size: 0.75em;
  line-height: 1.4;
  background-color: #f7f7f7;
  border: 1px solid #ccc;
  -webkit-border-radius: 3px;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset;
  box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em #fff inset;
  margin: -0.15em 0.15em 0 0.15em;
  padding: 0.2em 0.6em 0.2em 0.5em;
  vertical-align: middle;
  white-space: nowrap;
}
.keyseq kbd:first-child {
  margin-left: 0;
}
.keyseq kbd:last-child {
  margin-right: 0;
}
.menuseq,
.menu {
  color: rgba(0, 0, 0, 0.8);
}
b.button:before,
b.button:after {
  position: relative;
  top: -1px;
  font-weight: 400;
}
b.button:before {
  content: "[";
  padding: 0 3px 0 2px;
}
b.button:after {
  content: "]";
  padding: 0 2px 0 3px;
}
p a > code:hover {
  color: rgba(0, 0, 0, 0.9);
}
#header,
#content,
#footnotes,
#footer {
  width: 100%;
  margin-left: auto;
  margin-right: auto;
  margin-top: 0;
  margin-bottom: 0;
  *zoom: 1;
  position: relative;
  padding-left: 0.9375em;
  padding-right: 0.9375em;
}
#header:before,
#header:after,
#content:before,
#content:after,
#footnotes:before,
#footnotes:after,
#footer:before,
#footer:after {
  content: " ";
  display: table;
}
#header:after,
#content:after,
#footnotes:after,
#footer:after {
  clear: both;
}
#content {
  margin-top: 1.25em;
}
#content:before {
  content: none;
}
#header > h1:first-child {
  color: rgba(0, 0, 0, 0.85);
  margin-top: 2.25rem;
  margin-bottom: 0;
}
#header > h1:first-child + #toc {
  margin-top: 8px;
  border-top: 1px solid #ddddd8;
}
#header > h1:only-child,
body.toc2 #header > h1:nth-last-child(2) {
  border-bottom: 1px solid #ddddd8;
  padding-bottom: 8px;
}
#header .details {
  border-bottom: 1px solid #ddddd8;
  line-height: 1.45;
  padding-top: 0.25em;
  padding-bottom: 0.25em;
  padding-left: 0.25em;
  color: rgba(0, 0, 0, 0.6);
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -ms-flex-flow: row wrap;
  -webkit-flex-flow: row wrap;
  flex-flow: row wrap;
}
#header .details span:first-child {
  margin-left: -0.125em;
}
#header .details span.email a {
  color: rgba(0, 0, 0, 0.85);
}
#header .details br {
  display: none;
}
#header .details br + span:before {
  content: "\00a0\2013\00a0";
}
#header .details br + span.author:before {
  content: "\00a0\22c5\00a0";
  color: rgba(0, 0, 0, 0.85);
}
#header .details br + span#revremark:before {
  content: "\00a0|\00a0";
}
#header #revnumber {
  text-transform: capitalize;
}
#header #revnumber:after {
  content: "\00a0";
}
#content > h1:first-child:not([class]) {
  color: rgba(0, 0, 0, 0.85);
  border-bottom: 1px solid #ddddd8;
  padding-bottom: 8px;
  margin-top: 0;
  padding-top: 1rem;
  margin-bottom: 1.25rem;
}
#toc {
  border-bottom: 1px solid #efefed;
  padding-bottom: 0.5em;
}
#toc > ul {
  margin-left: 0.125em;
}
#toc ul.sectlevel0 > li > a {
  font-style: italic;
}
#toc ul.sectlevel0 ul.sectlevel1 {
  margin: 0.5em 0;
}
#toc ul {
  font-family: "Open Sans", "DejaVu Sans", sans-serif;
  list-style-type: none;
}
#toc a {
  text-decoration: none;
}
#toc a:active {
  text-decoration: underline;
}
#toctitle {
  color: #7a2518;
  font-size: 1.2em;
}
@media only screen and (min-width: 768px) {
  #toctitle {
    font-size: 1.375em;
  }
  body.toc2 {
    padding-left: 15em;
    padding-right: 0;
  }
  #toc.toc2 {
    margin-top: 0 !important;
    background-color: #f8f8f7;
    position: fixed;
    width: 15em;
    left: 0;
    top: 0;
    border-right: 1px solid #efefed;
    border-top-width: 0 !important;
    border-bottom-width: 0 !important;
    z-index: 1000;
    padding: 1.25em 1em;
    height: 100%;
    overflow: auto;
  }
  #toc.toc2 #toctitle {
    margin-top: 0;
    font-size: 1.2em;
  }
  #toc.toc2 > ul {
    font-size: 0.9em;
    margin-bottom: 0;
  }
  #toc.toc2 ul ul {
    margin-left: 0;
    padding-left: 1em;
  }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 {
    padding-left: 0;
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
  body.toc2.toc-right {
    padding-left: 0;
    padding-right: 15em;
  }
  body.toc2.toc-right #toc.toc2 {
    border-right-width: 0;
    border-left: 1px solid #efefed;
    left: auto;
    right: 0;
  }
}
@media only screen and (min-width: 1280px) {
  body.toc2 {
    padding-left: 20em;
    padding-right: 0;
  }
  #toc.toc2 {
    width: 20em;
  }
  #toc.toc2 #toctitle {
    font-size: 1.375em;
  }
  #toc.toc2 > ul {
    font-size: 0.95em;
  }
  #toc.toc2 ul ul {
    padding-left: 1.25em;
  }
  body.toc2.toc-right {
    padding-left: 0;
    padding-right: 20em;
  }
}
#content #toc {
  border-style: solid;
  border-width: 1px;
  border-color: #e0e0dc;
  margin-bottom: 1.25em;
  padding: 1.25em;
  background: #f8f8f7;
  -webkit-border-radius: 4px;
  border-radius: 4px;
}
#content #toc > :first-child {
  margin-top: 0;
}
#content #toc > :last-child {
  margin-bottom: 0;
}
#footer {
  max-width: 100%;
  background-color: #2e3336;
  padding: 1.25em;
}
#footer-text {
  color: rgba(255, 255, 255, 0.8);
  line-height: 1.44;
}
.sect1 {
  padding-bottom: 0.625em;
}
@media only screen and (min-width: 768px) {
  .sect1 {
    padding-bottom: 1.25em;
  }
}
.sect1 + .sect1 {
  border-top: 1px solid #efefed;
}
#content h1 > a.anchor,
h2 > a.anchor,
h3 > a.anchor,
#toctitle > a.anchor,
.sidebarblock > .content > .title > a.anchor,
h4 > a.anchor,
h5 > a.anchor,
h6 > a.anchor {
  position: absolute;
  z-index: 1001;
  width: 1.5ex;
  margin-left: -1.5ex;
  display: block;
  text-decoration: none !important;
  visibility: hidden;
  text-align: center;
  font-weight: 400;
}
#content h1 > a.anchor:before,
h2 > a.anchor:before,
h3 > a.anchor:before,
#toctitle > a.anchor:before,
.sidebarblock > .content > .title > a.anchor:before,
h4 > a.anchor:before,
h5 > a.anchor:before,
h6 > a.anchor:before {
  content: "\00A7";
  font-size: 0.85em;
  display: block;
  padding-top: 0.1em;
}
#content h1:hover > a.anchor,
#content h1 > a.anchor:hover,
h2:hover > a.anchor,
h2 > a.anchor:hover,
h3:hover > a.anchor,
#toctitle:hover > a.anchor,
.sidebarblock > .content > .title:hover > a.anchor,
h3 > a.anchor:hover,
#toctitle > a.anchor:hover,
.sidebarblock > .content > .title > a.anchor:hover,
h4:hover > a.anchor,
h4 > a.anchor:hover,
h5:hover > a.anchor,
h5 > a.anchor:hover,
h6:hover > a.anchor,
h6 > a.anchor:hover {
  visibility: visible;
}
#content h1 > a.link,
h2 > a.link,
h3 > a.link,
#toctitle > a.link,
.sidebarblock > .content > .title > a.link,
h4 > a.link,
h5 > a.link,
h6 > a.link {
  color: #e44c3a;
  text-decoration: none;
}
#content h1 > a.link:hover,
h2 > a.link:hover,
h3 > a.link:hover,
#toctitle > a.link:hover,
.sidebarblock > .content > .title > a.link:hover,
h4 > a.link:hover,
h5 > a.link:hover,
h6 > a.link:hover {
  color: #a53221;
}
.audioblock,
.imageblock,
.literalblock,
.listingblock,
.stemblock,
.videoblock {
  margin-bottom: 1.25em;
}
.admonitionblock td.content > .title,
.audioblock > .title,
.exampleblock > .title,
.imageblock > .title,
.listingblock > .title,
.literalblock > .title,
.stemblock > .title,
.openblock > .title,
.paragraph > .title,
.quoteblock > .title,
table.tableblock > .title,
.verseblock > .title,
.videoblock > .title,
.dlist > .title,
.olist > .title,
.ulist > .title,
.qlist > .title,
.hdlist > .title {
  text-rendering: optimizeLegibility;
  text-align: left;
  font-family: "Noto Serif", "DejaVu Serif", serif;
  font-size: 1rem;
  font-style: italic;
}
table.tableblock > caption.title {
  white-space: nowrap;
  overflow: visible;
  max-width: 0;
}
.paragraph.lead > p,
#preamble > .sectionbody > .paragraph:first-of-type p {
  color: rgba(0, 0, 0, 0.85);
}
table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p {
  font-size: inherit;
}
.admonitionblock > table {
  border-collapse: separate;
  border: 0;
  background: none;
  width: 100%;
}
.admonitionblock > table td.icon {
  text-align: center;
  width: 80px;
}
.admonitionblock > table td.icon img {
  max-width: none;
}
.admonitionblock > table td.icon .title {
  font-weight: bold;
  font-family: "Open Sans", "DejaVu Sans", sans-serif;
  text-transform: uppercase;
}
.admonitionblock > table td.content {
  padding-left: 1.125em;
  padding-right: 1.25em;
  border-left: 1px solid #ddddd8;
  color: rgba(0, 0, 0, 0.6);
}
.admonitionblock > table td.content > :last-child > :last-child {
  margin-bottom: 0;
}
.exampleblock > .content {
  border-style: solid;
  border-width: 1px;
  border-color: #e6e6e6;
  margin-bottom: 1.25em;
  padding: 1.25em;
  background: #fff;
  -webkit-border-radius: 4px;
  border-radius: 4px;
}
.exampleblock > .content > :first-child {
  margin-top: 0;
}
.exampleblock > .content > :last-child {
  margin-bottom: 0;
}
.sidebarblock {
  border-style: solid;
  border-width: 1px;
  border-color: #e0e0dc;
  margin-bottom: 1.25em;
  padding: 1.25em;
  background: #f8f8f7;
  -webkit-border-radius: 4px;
  border-radius: 4px;
}
.sidebarblock > :first-child {
  margin-top: 0;
}
.sidebarblock > :last-child {
  margin-bottom: 0;
}
.sidebarblock > .content > .title {
  color: #7a2518;
  margin-top: 0;
  text-align: center;
}
.exampleblock > .content > :last-child > :last-child,
.exampleblock > .content .olist > ol > li:last-child > :last-child,
.exampleblock > .content .ulist > ul > li:last-child > :last-child,
.exampleblock > .content .qlist > ol > li:last-child > :last-child,
.sidebarblock > .content > :last-child > :last-child,
.sidebarblock > .content .olist > ol > li:last-child > :last-child,
.sidebarblock > .content .ulist > ul > li:last-child > :last-child,
.sidebarblock > .content .qlist > ol > li:last-child > :last-child {
  margin-bottom: 0;
}
.literalblock pre,
.listingblock pre[class="highlight"],
.listingblock pre[class^="highlight "],
.listingblock pre.CodeRay,
.listingblock pre.prettyprint {
  background: #f7f7f8;
}
.sidebarblock .literalblock pre,
.sidebarblock .listingblock pre[class="highlight"],
.sidebarblock .listingblock pre[class^="highlight "],
.sidebarblock .listingblock pre.CodeRay,
.sidebarblock .listingblock pre.prettyprint {
  background: #f2f1f1;
}
.literalblock pre,
.literalblock pre[class],
.listingblock pre,
.listingblock pre[class] {
  -webkit-border-radius: 4px;
  border-radius: 4px;
  word-wrap: break-word;
  padding: 1em;
  font-size: 0.8125em;
}
.literalblock pre.nowrap,
.literalblock pre[class].nowrap,
.listingblock pre.nowrap,
.listingblock pre[class].nowrap {
  overflow-x: auto;
  white-space: pre;
  word-wrap: normal;
}
@media only screen and (min-width: 768px) {
  .literalblock pre,
  .literalblock pre[class],
  .listingblock pre,
  .listingblock pre[class] {
    font-size: 0.90625em;
  }
}
@media only screen and (min-width: 1280px) {
  .literalblock pre,
  .literalblock pre[class],
  .listingblock pre,
  .listingblock pre[class] {
    font-size: 1em;
  }
}
.literalblock.output pre {
  color: #f7f7f8;
  background-color: rgba(0, 0, 0, 0.9);
}
.listingblock pre.highlightjs {
  padding: 0;
}
.listingblock pre.highlightjs > code {
  padding: 1em;
  -webkit-border-radius: 4px;
  border-radius: 4px;
}
.listingblock pre.prettyprint {
  border-width: 0;
}
.listingblock > .content {
  position: relative;
}
.listingblock code[data-lang]:before {
  display: none;
  content: attr(data-lang);
  position: absolute;
  font-size: 0.75em;
  top: 0.425rem;
  right: 0.5rem;
  line-height: 1;
  text-transform: uppercase;
  color: #999;
}
.listingblock:hover code[data-lang]:before {
  display: block;
}
.listingblock.terminal pre .command:before {
  content: attr(data-prompt);
  padding-right: 0.5em;
  color: #999;
}
.listingblock.terminal pre .command:not([data-prompt]):before {
  content: "$";
}
table.pyhltable {
  border-collapse: separate;
  border: 0;
  margin-bottom: 0;
  background: none;
}
table.pyhltable td {
  vertical-align: top;
  padding-top: 0;
  padding-bottom: 0;
}
table.pyhltable td.code {
  padding-left: 0.75em;
  padding-right: 0;
}
pre.pygments .lineno,
table.pyhltable td:not(.code) {
  color: #999;
  padding-left: 0;
  padding-right: 0.5em;
  border-right: 1px solid #ddddd8;
}
pre.pygments .lineno {
  display: inline-block;
  margin-right: 0.25em;
}
table.pyhltable .linenodiv {
  background: none !important;
  padding-right: 0 !important;
}
.quoteblock {
  margin: 0 1em 1.25em 1.5em;
  display: table;
}
.quoteblock > .title {
  margin-left: -1.5em;
  margin-bottom: 0.75em;
}
.quoteblock blockquote,
.quoteblock blockquote p {
  color: rgba(0, 0, 0, 0.85);
  font-size: 1.15rem;
  line-height: 1.75;
  word-spacing: 0.1em;
  letter-spacing: 0;
  font-style: italic;
  text-align: justify;
}
.quoteblock blockquote {
  margin: 0;
  padding: 0;
  border: 0;
}
.quoteblock blockquote:before {
  content: "\201c";
  float: left;
  font-size: 2.75em;
  font-weight: bold;
  line-height: 0.6em;
  margin-left: -0.6em;
  color: #7a2518;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}
.quoteblock blockquote > .paragraph:last-child p {
  margin-bottom: 0;
}
.quoteblock .attribution {
  margin-top: 0.5em;
  margin-right: 0.5ex;
  text-align: right;
}
.quoteblock .quoteblock {
  margin-left: 0;
  margin-right: 0;
  padding: 0.5em 0;
  border-left: 3px solid rgba(0, 0, 0, 0.6);
}
.quoteblock .quoteblock blockquote {
  padding: 0 0 0 0.75em;
}
.quoteblock .quoteblock blockquote:before {
  display: none;
}
.verseblock {
  margin: 0 1em 1.25em 1em;
}
.verseblock pre {
  font-family: "Open Sans", "DejaVu Sans", sans;
  font-size: 1.15rem;
  color: rgba(0, 0, 0, 0.85);
  font-weight: 300;
  text-rendering: optimizeLegibility;
}
.verseblock pre strong {
  font-weight: 400;
}
.verseblock .attribution {
  margin-top: 1.25rem;
  margin-left: 0.5ex;
}
.quoteblock .attribution,
.verseblock .attribution {
  font-size: 0.9375em;
  line-height: 1.45;
  font-style: italic;
}
.quoteblock .attribution br,
.verseblock .attribution br {
  display: none;
}
.quoteblock .attribution cite,
.verseblock .attribution cite {
  display: block;
  letter-spacing: -0.05em;
  color: rgba(0, 0, 0, 0.6);
}
.quoteblock.abstract {
  margin: 0 0 1.25em 0;
  display: block;
}
.quoteblock.abstract blockquote,
.quoteblock.abstract blockquote p {
  text-align: left;
  word-spacing: 0;
}
.quoteblock.abstract blockquote:before,
.quoteblock.abstract blockquote p:first-of-type:before {
  display: none;
}
table.tableblock {
  max-width: 100%;
  border-collapse: separate;
}
table.tableblock td > .paragraph:last-child p > p:last-child,
table.tableblock th > p:last-child,
table.tableblock td > p:last-child {
  margin-bottom: 0;
}
table.spread {
  width: 100%;
}
table.tableblock,
th.tableblock,
td.tableblock {
  border: 0 solid #dedede;
}
table.grid-all th.tableblock,
table.grid-all td.tableblock {
  border-width: 0 1px 1px 0;
}
table.grid-all tfoot > tr > th.tableblock,
table.grid-all tfoot > tr > td.tableblock {
  border-width: 1px 1px 0 0;
}
table.grid-cols th.tableblock,
table.grid-cols td.tableblock {
  border-width: 0 1px 0 0;
}
table.grid-all * > tr > .tableblock:last-child,
table.grid-cols * > tr > .tableblock:last-child {
  border-right-width: 0;
}
table.grid-rows th.tableblock,
table.grid-rows td.tableblock {
  border-width: 0 0 1px 0;
}
table.grid-all tbody > tr:last-child > th.tableblock,
table.grid-all tbody > tr:last-child > td.tableblock,
table.grid-all thead:last-child > tr > th.tableblock,
table.grid-rows tbody > tr:last-child > th.tableblock,
table.grid-rows tbody > tr:last-child > td.tableblock,
table.grid-rows thead:last-child > tr > th.tableblock {
  border-bottom-width: 0;
}
table.grid-rows tfoot > tr > th.tableblock,
table.grid-rows tfoot > tr > td.tableblock {
  border-width: 1px 0 0 0;
}
table.frame-all {
  border-width: 1px;
}
table.frame-sides {
  border-width: 0 1px;
}
table.frame-topbot {
  border-width: 1px 0;
}
th.halign-left,
td.halign-left {
  text-align: left;
}
th.halign-right,
td.halign-right {
  text-align: right;
}
th.halign-center,
td.halign-center {
  text-align: center;
}
th.valign-top,
td.valign-top {
  vertical-align: top;
}
th.valign-bottom,
td.valign-bottom {
  vertical-align: bottom;
}
th.valign-middle,
td.valign-middle {
  vertical-align: middle;
}
table thead th,
table tfoot th {
  font-weight: bold;
}
tbody tr th {
  display: table-cell;
  line-height: 1.6;
  background: #f7f8f7;
}
tbody tr th,
tbody tr th p,
tfoot tr th,
tfoot tr th p {
  color: rgba(0, 0, 0, 0.8);
  font-weight: bold;
}
p.tableblock > code:only-child {
  background: none;
  padding: 0;
}
p.tableblock {
  font-size: 1em;
}
td > div.verse {
  white-space: pre;
}
ol {
  margin-left: 1.75em;
}
ul li ol {
  margin-left: 1.5em;
}
dl dd {
  margin-left: 1.125em;
}
dl dd:last-child,
dl dd:last-child > :last-child {
  margin-bottom: 0;
}
ol > li p,
ul > li p,
ul dd,
ol dd,
.olist .olist,
.ulist .ulist,
.ulist .olist,
.olist .ulist {
  margin-bottom: 0.625em;
}
ul.unstyled,
ol.unnumbered,
ul.checklist,
ul.none {
  list-style-type: none;
}
ul.unstyled,
ol.unnumbered,
ul.checklist {
  margin-left: 0.625em;
}
ul.checklist li > p:first-child > .fa-square-o:first-child,
ul.checklist li > p:first-child > .fa-check-square-o:first-child {
  width: 1em;
  font-size: 0.85em;
}
ul.checklist li > p:first-child > input[type="checkbox"]:first-child {
  width: 1em;
  position: relative;
  top: 1px;
}
ul.inline {
  margin: 0 auto 0.625em auto;
  margin-left: -1.375em;
  margin-right: 0;
  padding: 0;
  list-style: none;
  overflow: hidden;
}
ul.inline > li {
  list-style: none;
  float: left;
  margin-left: 1.375em;
  display: block;
}
ul.inline > li > * {
  display: block;
}
.unstyled dl dt {
  font-weight: 400;
  font-style: normal;
}
ol.arabic {
  list-style-type: decimal;
}
ol.decimal {
  list-style-type: decimal-leading-zero;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}
ol.lowergreek {
  list-style-type: lower-greek;
}
.hdlist > table,
.colist > table {
  border: 0;
  background: none;
}
.hdlist > table > tbody > tr,
.colist > table > tbody > tr {
  background: none;
}
td.hdlist1 {
  padding-right: 0.75em;
  font-weight: bold;
}
td.hdlist1,
td.hdlist2 {
  vertical-align: top;
}
.literalblock + .colist,
.listingblock + .colist {
  margin-top: -0.5em;
}
.colist > table tr > td:first-of-type {
  padding: 0 0.75em;
  line-height: 1;
}
.colist > table tr > td:last-of-type {
  padding: 0.25em 0;
}
.thumb,
.th {
  line-height: 0;
  display: inline-block;
  border: solid 4px #fff;
  -webkit-box-shadow: 0 0 0 1px #ddd;
  box-shadow: 0 0 0 1px #ddd;
}
.imageblock.left,
.imageblock[style*="float: left"] {
  margin: 0.25em 0.625em 1.25em 0;
}
.imageblock.right,
.imageblock[style*="float: right"] {
  margin: 0.25em 0 1.25em 0.625em;
}
.imageblock > .title {
  margin-bottom: 0;
}
.imageblock.thumb,
.imageblock.th {
  border-width: 6px;
}
.imageblock.thumb > .title,
.imageblock.th > .title {
  padding: 0 0.125em;
}
.image.left,
.image.right {
  margin-top: 0.25em;
  margin-bottom: 0.25em;
  display: inline-block;
  line-height: 0;
}
.image.left {
  margin-right: 0.625em;
}
.image.right {
  margin-left: 0.625em;
}
a.image {
  text-decoration: none;
}
span.footnote,
span.footnoteref {
  vertical-align: super;
  font-size: 0.875em;
}
span.footnote a,
span.footnoteref a {
  text-decoration: none;
}
span.footnote a:active,
span.footnoteref a:active {
  text-decoration: underline;
}
#footnotes {
  padding-top: 0.75em;
  padding-bottom: 0.75em;
  margin-bottom: 0.625em;
}
#footnotes hr {
  width: 20%;
  min-width: 6.25em;
  margin: -0.25em 0 0.75em 0;
  border-width: 1px 0 0 0;
}
#footnotes .footnote {
  padding: 0 0.375em;
  line-height: 1.3;
  font-size: 0.875em;
  margin-left: 1.2em;
  text-indent: -1.2em;
  margin-bottom: 0.2em;
}
#footnotes .footnote a:first-of-type {
  font-weight: bold;
  text-decoration: none;
}
#footnotes .footnote:last-of-type {
  margin-bottom: 0;
}
#content #footnotes {
  margin-top: -0.625em;
  margin-bottom: 0;
  padding: 0.75em 0;
}
.gist .file-data > table {
  border: 0;
  background: #fff;
  width: 100%;
  margin-bottom: 0;
}
.gist .file-data > table td.line-data {
  width: 99%;
}
div.unbreakable {
  page-break-inside: avoid;
}
.big {
  font-size: larger;
}
.small {
  font-size: smaller;
}
.underline {
  text-decoration: underline;
}
.overline {
  text-decoration: overline;
}
.line-through {
  text-decoration: line-through;
}
.aqua {
  color: #00bfbf;
}
.aqua-background {
  background-color: #00fafa;
}
.black {
  color: #000;
}
.black-background {
  background-color: #000;
}
.blue {
  color: #0000bf;
}
.blue-background {
  background-color: #0000fa;
}
.fuchsia {
  color: #bf00bf;
}
.fuchsia-background {
  background-color: #fa00fa;
}
.gray {
  color: #606060;
}
.gray-background {
  background-color: #7d7d7d;
}
.green {
  color: #006000;
}
.green-background {
  background-color: #007d00;
}
.lime {
  color: #00bf00;
}
.lime-background {
  background-color: #00fa00;
}
.maroon {
  color: #600000;
}
.maroon-background {
  background-color: #7d0000;
}
.navy {
  color: #000060;
}
.navy-background {
  background-color: #00007d;
}
.olive {
  color: #606000;
}
.olive-background {
  background-color: #7d7d00;
}
.purple {
  color: #600060;
}
.purple-background {
  background-color: #7d007d;
}
.red {
  color: #bf0000;
}
.red-background {
  background-color: #fa0000;
}
.silver {
  color: #909090;
}
.silver-background {
  background-color: #bcbcbc;
}
.teal {
  color: #006060;
}
.teal-background {
  background-color: #007d7d;
}
.white {
  color: #bfbfbf;
}
.white-background {
  background-color: #fafafa;
}
.yellow {
  color: #bfbf00;
}
.yellow-background {
  background-color: #fafa00;
}
span.icon > .fa {
  cursor: default;
}
.admonitionblock td.icon [class^="fa icon-"] {
  font-size: 2.5em;
  text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
  cursor: default;
}
.admonitionblock td.icon .icon-note:before {
  content: "\f05a";
  color: #19407c;
}
.admonitionblock td.icon .icon-tip:before {
  content: "\f0eb";
  text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8);
  color: #111;
}
.admonitionblock td.icon .icon-warning:before {
  content: "\f071";
  color: #bf6900;
}
.admonitionblock td.icon .icon-caution:before {
  content: "\f06d";
  color: #bf3400;
}
.admonitionblock td.icon .icon-important:before {
  content: "\f06a";
  color: #bf0000;
}
.conum[data-value] {
  display: inline-block;
  color: #fff !important;
  background-color: rgba(0, 0, 0, 0.8);
  -webkit-border-radius: 100px;
  border-radius: 100px;
  text-align: center;
  font-size: 0.75em;
  width: 1.67em;
  height: 1.67em;
  line-height: 1.67em;
  font-family: "Open Sans", "DejaVu Sans", sans-serif;
  font-style: normal;
  font-weight: bold;
}
.conum[data-value] * {
  color: #fff !important;
}
.conum[data-value] + b {
  display: none;
}
.conum[data-value]:after {
  content: attr(data-value);
}
pre .conum[data-value] {
  position: relative;
  top: -0.125em;
}
b.conum * {
  color: inherit !important;
}
.conum:not([data-value]):empty {
  display: none;
}
h1,
h2 {
  letter-spacing: -0.01em;
}
dt,
th.tableblock,
td.content {
  text-rendering: optimizeLegibility;
}
p,
td.content {
  letter-spacing: -0.01em;
}
p strong,
td.content strong {
  letter-spacing: -0.005em;
}
p,
blockquote,
dt,
td.content {
  font-size: 1.0625rem;
}
p {
  margin-bottom: 1.25rem;
}
.sidebarblock p,
.sidebarblock dt,
.sidebarblock td.content,
p.tableblock {
  font-size: 1em;
}
.exampleblock > .content {
  background-color: #fffef7;
  border-color: #e0e0dc;
  -webkit-box-shadow: 0 1px 4px #e0e0dc;
  box-shadow: 0 1px 4px #e0e0dc;
}
.print-only {
  display: none !important;
}
@media print {
  @page {
    margin: 1.25cm 0.75cm;
  }
  * {
    -webkit-box-shadow: none !important;
    box-shadow: none !important;
    text-shadow: none !important;
  }
  a {
    color: inherit !important;
    text-decoration: underline !important;
  }
  a.bare,
  a[href^="#"],
  a[href^="mailto:"] {
    text-decoration: none !important;
  }
  a[href^="http:"]:not(.bare):after,
  a[href^="https:"]:not(.bare):after {
    content: "(" attr(href) ")";
    display: inline-block;
    font-size: 0.875em;
    padding-left: 0.25em;
  }
  abbr[title]:after {
    content: " (" attr(title) ")";
  }
  pre,
  blockquote,
  tr,
  img {
    page-break-inside: avoid;
  }
  thead {
    display: table-header-group;
  }
  img {
    max-width: 100% !important;
  }
  p,
  blockquote,
  dt,
  td.content {
    font-size: 1em;
    orphans: 3;
    widows: 3;
  }
  h2,
  h3,
  #toctitle,
  .sidebarblock > .content > .title {
    page-break-after: avoid;
  }
  #toc,
  .sidebarblock,
  .exampleblock > .content {
    background: none !important;
  }
  #toc {
    border-bottom: 1px solid #ddddd8 !important;
    padding-bottom: 0 !important;
  }
  .sect1 {
    padding-bottom: 0 !important;
  }
  .sect1 + .sect1 {
    border: 0 !important;
  }
  #header > h1:first-child {
    margin-top: 1.25rem;
  }
  body.book #header {
    text-align: center;
  }
  body.book #header > h1:first-child {
    border: 0 !important;
    margin: 2.5em 0 1em 0;
  }
  body.book #header .details {
    border: 0 !important;
    display: block;
    padding: 0 !important;
  }
  body.book #header .details span:first-child {
    margin-left: 0 !important;
  }
  body.book #header .details br {
    display: block;
  }
  body.book #header .details br + span:before {
    content: none !important;
  }
  body.book #toc {
    border: 0 !important;
    text-align: left !important;
    padding: 0 !important;
    margin: 0 !important;
  }
  body.book #toc,
  body.book #preamble,
  body.book h1.sect0,
  body.book .sect1 > h2 {
    page-break-before: always;
  }
  .listingblock code[data-lang]:before {
    display: block;
  }
  #footer {
    background: none !important;
    padding: 0 0.9375em;
  }
  #footer-text {
    color: rgba(0, 0, 0, 0.6) !important;
    font-size: 0.9em;
  }
  .hide-on-print {
    display: none !important;
  }
  .print-only {
    display: block !important;
  }
  .hide-for-print {
    display: none !important;
  }
  .show-for-print {
    display: inherit !important;
  }
}

.pygments .highlight pre,
pre > code {
  color: #f8f8f2 !important;
}

/*Custom CSS*/
body {
  background: #f5f5f5;
}
#header-main-title {
  float: left;
}
#cards {
  clear: both;
}
#cards .btn-primary {
  background-color: #e44c3a;
  border-color: #e44c3a;
}
#asciinema-player-section {
  margin-bottom: 25px;
}
.logo {
  width: 70%;
  padding-top: 20px;
  padding-bottom: 10px;
}
#main-row {
  min-height: 100%;
  height: 100%;
}
#toc {
  border-bottom: none;
  overflow-y: auto;
  margin: 0;
  top: 0px;
  z-index: 9;
}

#toc .nav-link {
  font-size: 13px;
}
.toc {
  margin-top: 116px;
  word-break: break-all;
  max-width: 223px;
}
#toctitle {
  font-size: 1.2em;
}
#aws-link {
  width: 80%;
}
.sectlevel1 {
  padding-left: 7px;
}
/* .border-columns{ */
/* background-color: #2E3336; */
/* } */
.footer {
  display: block;
  bottom: 0;
  width: 75%;
  height: 40px;
  line-height: 40px;
  background-color: #2e3336;
  margin: 0 auto;
}
.footer > .container {
  padding-right: 15px;
  padding-left: 15px;
}
nav[data-toggle="toc"] .nav > li > a {
  display: block;
  padding: 4px 20px;
  font-size: 13px;
  font-weight: 500;
  color: rgba(0, 0, 0, 0.65);
}
nav[data-toggle="toc"] .nav > li > a:hover {
  background-color: #e44c3a;
  color: rgba(0, 0, 0, 0.65);
}
.text-muted {
  color: rgba(0, 0, 0, 0.65) !important;
}
nav[data-toggle="toc"] .nav .nav > li > a,
nav[data-toggle="toc"] .nav .nav > li > a:focus,
nav[data-toggle="toc"] .nav .nav > li > a:hover {
  padding-left: 10px;
}
nav[data-toggle="toc"] .nav .nav > li > .active,
nav[data-toggle="toc"] .nav .nav > li > .active:focus,
nav[data-toggle="toc"] .nav .nav > li > .active:hover,
nav[data-toggle="toc"] .nav-link.active,
nav[data-toggle="toc"] .nav-link.active:focus,
nav[data-toggle="toc"] .nav-link.active:hover {
  /* padding-left: 10px; */
  font-weight: 700;
  color: #e44c3a;
  background-color: transparent;
  border-left: 2px solid #e44c3a;
}
#toc > ul > li > ul {
  margin-left: 10px;
}

/* small screens */
@media (max-width: 767px) {
  /* override stickyness so that the navigation does not follow scrolling */
  nav[data-toggle="toc"] {
    margin-bottom: 42px;
  }
  nav[data-toggle="toc"] .nav .active .nav {
    display: none;
  }
  #aws-link {
    width: 50%;
    margin-bottom: 5px;
  }
  .border-right {
    border: none !important;
  }
}

html,
body {
  height: 100%;
}

/* Scrollbar styles */
#toc::-webkit-scrollbar {
  width: 3px;
}

/* Track */
#toc::-webkit-scrollbar-track {
  background: transparent;
}

/* Handle */
#toc::-webkit-scrollbar-thumb {
  background: rgb(182, 182, 182);
}

/* Handle on hover */
#toc::-webkit-scrollbar-thumb:hover {
  background: rgb(163, 163, 163);
}

/* Gernal styles */
.toggle-nav-btn {
  position: absolute;
  right: 30px;
  top: 34px;
}
.bd-sidebar {
  height: 100vh !important;
}
.bd-sidebar .nav > li > a {
  padding: 4px 20px;
  font-size: 13px;
  font-weight: 500;
  color: rgba(0, 0, 0, 0.65);
  padding-left: 12px;
}
.main-link {
  border-left: 2px solid #e44c3a;
  color: #ba3925 !important;
  cursor: pointer;
  font-weight: bold;
}

/* card styles */
.card-wrapper {
  height: min-content;
  -webkit-box-shadow: 0 0 30px rgba(0, 0, 0, 0.1); /* Safari 3-4, iOS 4.0.2 - 4.2, Android 2.3+ */
  -moz-box-shadow: 0 0 30px rgba(0, 0, 0, 0.1); /* Firefox 3.5 - 3.6 */
  box-shadow: 0 0 30px rgba(0, 0, 0, 0.1);
}
.card-wrapper .card-body {
  display: flex;
  flex-direction: column;
  justify-content: space-between;
}
.card-wrapper .content .card-text {
  margin-bottom: 12px;
}
.card-wrapper .card-body .card-title {
  color: #e44c3a;
  font-size: 22px;
  font-weight: 500;
}
.LogoAndToggle {
  border-bottom: 1px solid gainsboro;
  margin: 0px;
  display: block;
  padding-bottom: 12px;
  background: whitesmoke;
  padding-top: 4px;
}
/* media quires */
@media (max-width: 767px) {
  .bd-sidebar {
    height: 100px !important;
    border: 0;
  }

  #toc {
    min-width: 100%;
    padding-top: 15px;
  }
  #toc.show {
    border-bottom: none;
    left: 0;
    min-width: 100%;
    margin: 0;
    padding-top: 15px;
    box-shadow: 0px 7px 10px 2px #ababab3b;
  }
  .LogoAndToggle {
    display: flex;
    justify-content: space-around;
    width: 100%;
    margin: 0;
  }
  .bd-links {
    background: white;
    z-index: 9;
    position: relative;
    max-height: 300px;
    overflow-y: scroll;
    margin-top: -5px;
    border-bottom: 1px solid #d6d6d6;
  }
}
@media (min-width: 768px) {
  .bd-links {
    height: 100% !important;
    overflow-y: auto;
    display: block !important;
  }
  #toc {
    position: relative;
    top: 0;
    max-width: 100%;
    margin: 0;
    padding-left: 10px;
  }
  .toc {
    /* height: calc(100vh - 97px) !important; */
    height: calc(100vh - 160px) !important;
  }
  .bd-sidebar {
    padding-right: 20px;
    top: 0 !important;
  }
}

.bdr-right {
  border-right: 1px solid gainsboro;
}
.bdr-left {
  border-left: 1px solid gainsboro;
}

nav[data-toggle="toc"] .nav > li > a:focus,
nav[data-toggle="toc"] .nav > li > a:hover {
  border-left: 2px solid #e44c3a;
}
nav[data-toggle="toc"] .nav > li > a:hover {
  background-color: #ba39251a;
  color: rgba(0, 0, 0, 0.65);
}
/* pre.pygments .tok-n , pre.pygments .tok-p{
    color: rgba(0,0,0,.9) !important;
} */

table.linenotable {
  width: 100%;
}
.pygments code {
  width: max-content;
  overflow-x: auto;
  display: block;
  min-width: 100%;
}
.bd-search {
  padding: 0;
  margin: auto;
  padding-bottom: 10px;
  padding-top: 10px;
}
@media (max-width: 767px) {
  .bd-search {
    background-color: white;
    border-bottom: 1px solid #ddddd7;
  }
}
.bd-search .algolia-autocomplete {
  width: 100%;
}
.bd-search input {
  border-color: #3333331c;
  left: 0px;
  margin: auto;
  padding: 0;
  padding: 7px;
  width: 90%;
  max-width: 90%;
}

.bd-search .form-control:focus {
  border-color: #e44c3a61;
  box-shadow: 0 0 0 3px rgb(237 152 142 / 50%);
}
.bd-links {
  padding-top: 1rem;
}

/* Blue #167bb7 */
/* Green #29a9c9 */
/* Red #e44c3a */

#toc.right-side-menu ul li ul {
  padding: 0;
}
#toc.right-side-menu ul li ul {
  margin: 0;
}
#toc.right-side-menu ul li ul li a {
  padding-left: 30px !important;
  border-left: 2px solid #33333326;
}
#toc.right-side-menu ul li ul li a.active {
  padding-left: 30px !important;
  border-left: 2px solid #e44c3a;
  font-weight: 600 !important;
}

nav.right-side-menu .nav > li > a {
  display: block;
}
nav.right-side-menu > ul > li > a {
  color: #e44c3a;
  font-weight: 800 !important;
  background-color: transparent;
  border-left: 2px solid #33333326;
}
nav.right-side-menu > ul > li > a.active {
  color: #e44c3a;
  background-color: transparent;
  border-left: 2px solid #e44c3a;
}
nav[data-toggle="toc"].right-side-menu .nav-link + ul {
  display: block;
}

pre.pygments .tok-mf, pre.pygments .tok-mi{
  color: #f8f8f2 !important
}
</style>
<style>pre { line-height: 125%; }
td.linenos pre { color: #000000; background-color: #f0f0f0; padding-left: 5px; padding-right: 5px; }
span.linenos { color: #000000; background-color: #f0f0f0; padding-left: 5px; padding-right: 5px; }
td.linenos pre.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
pre.pygments .hll { background-color: #49483e }
pre.pygments { background: #272822; color: #f8f8f2 }
pre.pygments .tok-c { color: #75715e } /* Comment */
pre.pygments .tok-err { color: #960050; background-color: #1e0010 } /* Error */
pre.pygments .tok-k { color: #66d9ef } /* Keyword */
pre.pygments .tok-l { color: #ae81ff } /* Literal */
pre.pygments .tok-n { color: #f8f8f2 } /* Name */
pre.pygments .tok-o { color: #f92672 } /* Operator */
pre.pygments .tok-p { color: #f8f8f2 } /* Punctuation */
pre.pygments .tok-ch { color: #75715e } /* Comment.Hashbang */
pre.pygments .tok-cm { color: #75715e } /* Comment.Multiline */
pre.pygments .tok-cp { color: #75715e } /* Comment.Preproc */
pre.pygments .tok-cpf { color: #75715e } /* Comment.PreprocFile */
pre.pygments .tok-c1 { color: #75715e } /* Comment.Single */
pre.pygments .tok-cs { color: #75715e } /* Comment.Special */
pre.pygments .tok-gd { color: #f92672 } /* Generic.Deleted */
pre.pygments .tok-ge { font-style: italic } /* Generic.Emph */
pre.pygments .tok-gi { color: #a6e22e } /* Generic.Inserted */
pre.pygments .tok-go { color: #66d9ef } /* Generic.Output */
pre.pygments .tok-gp { color: #f92672; font-weight: bold } /* Generic.Prompt */
pre.pygments .tok-gs { font-weight: bold } /* Generic.Strong */
pre.pygments .tok-gu { color: #75715e } /* Generic.Subheading */
pre.pygments .tok-kc { color: #66d9ef } /* Keyword.Constant */
pre.pygments .tok-kd { color: #66d9ef } /* Keyword.Declaration */
pre.pygments .tok-kn { color: #f92672 } /* Keyword.Namespace */
pre.pygments .tok-kp { color: #66d9ef } /* Keyword.Pseudo */
pre.pygments .tok-kr { color: #66d9ef } /* Keyword.Reserved */
pre.pygments .tok-kt { color: #66d9ef } /* Keyword.Type */
pre.pygments .tok-ld { color: #e6db74 } /* Literal.Date */
pre.pygments .tok-m { color: #ae81ff } /* Literal.Number */
pre.pygments .tok-s { color: #e6db74 } /* Literal.String */
pre.pygments .tok-na { color: #a6e22e } /* Name.Attribute */
pre.pygments .tok-nb { color: #f8f8f2 } /* Name.Builtin */
pre.pygments .tok-nc { color: #a6e22e } /* Name.Class */
pre.pygments .tok-no { color: #66d9ef } /* Name.Constant */
pre.pygments .tok-nd { color: #a6e22e } /* Name.Decorator */
pre.pygments .tok-ni { color: #f8f8f2 } /* Name.Entity */
pre.pygments .tok-ne { color: #a6e22e } /* Name.Exception */
pre.pygments .tok-nf { color: #a6e22e } /* Name.Function */
pre.pygments .tok-nl { color: #f8f8f2 } /* Name.Label */
pre.pygments .tok-nn { color: #f8f8f2 } /* Name.Namespace */
pre.pygments .tok-nx { color: #a6e22e } /* Name.Other */
pre.pygments .tok-py { color: #f8f8f2 } /* Name.Property */
pre.pygments .tok-nt { color: #f92672 } /* Name.Tag */
pre.pygments .tok-nv { color: #f8f8f2 } /* Name.Variable */
pre.pygments .tok-ow { color: #f92672 } /* Operator.Word */
pre.pygments .tok-w { color: #f8f8f2 } /* Text.Whitespace */
pre.pygments .tok-mb { color: #ae81ff } /* Literal.Number.Bin */
pre.pygments .tok-mf { color: #ae81ff } /* Literal.Number.Float */
pre.pygments .tok-mh { color: #ae81ff } /* Literal.Number.Hex */
pre.pygments .tok-mi { color: #ae81ff } /* Literal.Number.Integer */
pre.pygments .tok-mo { color: #ae81ff } /* Literal.Number.Oct */
pre.pygments .tok-sa { color: #e6db74 } /* Literal.String.Affix */
pre.pygments .tok-sb { color: #e6db74 } /* Literal.String.Backtick */
pre.pygments .tok-sc { color: #e6db74 } /* Literal.String.Char */
pre.pygments .tok-dl { color: #e6db74 } /* Literal.String.Delimiter */
pre.pygments .tok-sd { color: #e6db74 } /* Literal.String.Doc */
pre.pygments .tok-s2 { color: #e6db74 } /* Literal.String.Double */
pre.pygments .tok-se { color: #ae81ff } /* Literal.String.Escape */
pre.pygments .tok-sh { color: #e6db74 } /* Literal.String.Heredoc */
pre.pygments .tok-si { color: #e6db74 } /* Literal.String.Interpol */
pre.pygments .tok-sx { color: #e6db74 } /* Literal.String.Other */
pre.pygments .tok-sr { color: #e6db74 } /* Literal.String.Regex */
pre.pygments .tok-s1 { color: #e6db74 } /* Literal.String.Single */
pre.pygments .tok-ss { color: #e6db74 } /* Literal.String.Symbol */
pre.pygments .tok-bp { color: #f8f8f2 } /* Name.Builtin.Pseudo */
pre.pygments .tok-fm { color: #a6e22e } /* Name.Function.Magic */
pre.pygments .tok-vc { color: #f8f8f2 } /* Name.Variable.Class */
pre.pygments .tok-vg { color: #f8f8f2 } /* Name.Variable.Global */
pre.pygments .tok-vi { color: #f8f8f2 } /* Name.Variable.Instance */
pre.pygments .tok-vm { color: #f8f8f2 } /* Name.Variable.Magic */
pre.pygments .tok-il { color: #ae81ff } /* Literal.Number.Integer.Long */</style></head><body data-spy="scroll" data-target="#toc" class="book"><div class="container-fluid"><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 bd-sidebar sticky-top border-columns border-right p-0"><div class="mx-auto text-center LogoAndToggle"><a href="https://docs.killbill.io/"><img class="logo rounded mx-auto d-block img-fluid" src="https://github.com/killbill/killbill-docs/raw/v3/userguide/assets/img/logo.png" /></a><button class="btn btn-link bd-search-docs-toggle d-md-none p-0 ml-3 toggle-nav-btn" type="button" data-toggle="collapse" data-target="#toc" aria-controls="toc" aria-expanded="false" aria-label="Toggle docs navigation"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30" width="30" height="30" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-miterlimit="10" d="M4 7h22M4 15h22M4 23h22"></path></svg></button></div><form role="search" class="bd-search d-flex align-items-center"><input type="search" class="form-control" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off" data-docs-version="4.4"></form><nav id="toc" class="collapse bd-links toc"><ul class="nav navbar-nav"><li><a class="bd-toc-link main-link">Getting started</a><ul class="nav navbar-nav"><li><a class="nav-link" href="https://docs.killbill.io/latest/what_is_kill_bill.html">What is Kill Bill?</a></li><li><a class="nav-link" href="https://docs.killbill.io/latest/getting_started.html">Quick start</a></li></ul></li></ul><ul class="nav navbar-nav"><li><a class="bd-toc-link main-link">Installation</a><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a class="nav-link" href="https://docs.killbill.io/latest/aws.html">AWS Development</a></li><li><a class="nav-link" href="https://docs.killbill.io/latest/stripe_plugin.html">Kill Bill + Stripe DIY</a></li><li><a class="nav-link" href="https://docs.killbill.io/latest/userguide_deployment.html">Going to production</a></li><li><a class="nav-link" href="https://docs.killbill.io/latest/database_migrations.html">Database migrations</a></li><li><a class="nav-link" href="https://github.com/killbill/killbill/releases" onclick="getOutboundLink('https://github.com/killbill/killbill/releases'); return false;">Release&nbsp;notes</a></li></ul></li></ul><ul class="nav navbar-nav"><li><a class="bd-toc-link main-link ml-2">Manuals</a><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a class="nav-link" href="https://docs.killbill.io/latest/userguide_subscription.html">Subscription&nbsp;Billing</a></li><li><a class="nav-link" href="https://docs.killbill.io/latest/userguide_payment.html">Payment processing</a></li><li><a class="nav-link" href="https://docs.killbill.io/latest/userguide_kaui.html">Kaui, the Administrative&nbsp;UI</a></li><li><a class="nav-link" href="https://docs.killbill.io/latest/userguide_analytics.html">Analytics plugin</a></li><li><a class="nav-link" href="https://docs.killbill.io/latest/userguide_configuration.html">Kill Bill&nbsp;configuration</a></li><li><a class="nav-link" href="https://docs.killbill.io/latest/internationalization.html">Kill Bill&nbsp;internationalization</a></li><li><a class="nav-link" href="https://docs.killbill.io/latest/migration_guide.html">Migrating to Kill Bill</a></li></ul></li></ul><ul class="nav navbar-nav"><li><a class="bd-toc-link main-link">Tutorials</a><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a class="nav-link" href="https://docs.killbill.io/latest/plan_alignment.html">Plans alignments</a></li><li><a class="nav-link" href="https://docs.killbill.io/latest/overdue.html">Overdue system</a></li><li><a class="nav-link" href="https://docs.killbill.io/latest/consumable_in_arrear.html">In Arrear UsageBilling</a></li><li><a class="nav-link" href="https://docs.killbill.io/latest/ha.html">Hierarchical Accounts</a></li></ul></li></ul><ul class="nav navbar-nav"><li><a class="bd-toc-link main-link">Integration</a><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a href="http://killbill.github.io/slate" onclick="getOutboundLink('http://killbill.github.io/slate'); return false;">REST API reference</a></li><li><a href="https://docs.killbill.io/latest/swagger_documentation.html">Swagger UI Documentation           </a></li><li><a href="https://docs.killbill.io/latest/postman.html">Postman Integration</a></li><li><a href="https://docs.killbill.io/latest/debugging.html">Debugging</a></li><li><a href="https://docs.killbill.io/latest/push_notifications.html">Push notifications</a></li></ul></li></ul><ul class="nav navbar-nav"><li><a class="bd-toc-link main-link">Plugin development</a><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a href="https://docs.killbill.io/latest/plugin_development.html">Plugin Development</a></li><li><a href="https://docs.killbill.io/latest/plugin_use_cases.html">Special Plugin Use Cases</a></li><li><a href="https://docs.killbill.io/latest/notification_plugin.html">Notification Plugins</a></li><li><a href="https://docs.killbill.io/latest/payment_plugin.html">Payment Plugins</a></li><li><a href="https://docs.killbill.io/latest/payment_control_plugin.html">Payment Control Plugins</a></li><li><a href="https://docs.killbill.io/latest/invoice_plugin.html">Invoice Plugins</a></li><li><a href="https://docs.killbill.io/latest/catalog_plugin.html">Catalog Plugins</a></li></ul></li></ul><ul class="nav navbar-nav"><li><a class="bd-toc-link main-link">Operational guides</a><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a href="https://docs.killbill.io/latest/user_management.html">Users, Roles and Permissions</a></li><li><a href="https://docs.killbill.io/latest/plugin_management.html">Plugin Management</a></li></ul></li></ul><ul class="nav navbar-nav"><li><a class="bd-toc-link main-link">Client libraries</a><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a href="https://docs.killbill.io/latest/java_client.html">Java</a></li><li><a href="http://github.com/killbill/killbill-client-ruby" onclick="getOutboundLink('http://github.com/killbill/killbill-client-ruby'); return false;">Ruby</a></li><li><a href="http://github.com/killbill/killbill-client-php" onclick="getOutboundLink('http://github.com/killbill/killbill-client-php'); return false;">PHP</a></li><li><a href="http://github.com/killbill/killbill-client-js" onclick="getOutboundLink('http://github.com/killbill/killbill-client-js'); return false;">Node.js</a></li><li><a href="http://github.com/killbill/killbill-client-python" onclick="getOutboundLink('http://github.com/killbill/killbill-client-python'); return false;">Python</a></li><li><a href="http://github.com/killbill/kbcli" onclick="getOutboundLink('http://github.com/killbill/kbcli'); return false;">Go</a></li></ul></li></ul><ul class="nav navbar-nav"><li><a class="bd-toc-link main-link">About Kill Bill</a><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a href="https://docs.killbill.io/latest/demo.html"> Demo</a></li><li><a href="https://docs.killbill.io/latest/features.html">Features list</a></li><li><a href="https://docs.killbill.io/latest/faq.html"> FAQ</a></li></ul></li></ul><ul class="nav navbar-nav"><li><a class="bd-toc-link main-link">Internal</a><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a href="https://docs.killbill.io/latest/internal_design.html">Internal design</a></li><li><a href="https://docs.killbill.io/latest/entitlement_subsystem.html">Entitlement Subsystem</a></li><li><a href="https://docs.killbill.io/latest/invoice_subsystem.html">Invoice Subsystem</a></li><li><a href="https://docs.killbill.io/latest/development.html">Development</a></li></ul></li></ul><ul class="nav navbar-nav"><li><a class="bd-toc-link main-link">References</a><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a href="https://github.com/killbill/killbill-docs/tree/v3/swagger" onclick="getOutboundLink('https://github.com/killbill/killbill-docs/tree/v3/swagger'); return false;">Swagger&nbsp;API schema</a></li><li><a href="https://docs.killbill.io/latest/catalog.xsd">Catalog XSD reference</a></li><li><a href="https://docs.killbill.io/latest/overdue.xsd">Overdue XSD reference</a></li></ul></li></ul></nav></div><div class="col-12 col-md-9 col-xl-8 border-right"><div id="header"><h1>Plugin development</h1></div><div id="content"><div class="sect1"><h2 id="_scope">Scope</h2><div class="sectionbody"><div class="paragraph"><p>This document is intended to provide some information about plugin development:</p></div>
<div class="ulist"><ul><li><p>What are plugins and what can be achieved through plugins?</p></li><li><p>Where to start the development?</p></li><li><p>Tooling and APIs to build and deploy plugins</p></li></ul></div></div></div>
<div class="sect1"><h2 id="_kill_bill_plugins">Kill Bill Plugins</h2><div class="sectionbody"><div class="paragraph"><p>Kill Bill Plugins are based on the <a href="https://docs.osgi.org/">OSGI standard</a> to provide a way to write isolated code on top of the Kill Bill platform and interact with the system through different ways:</p></div>
<div class="ulist"><ul><li><p>They can be called from the Kill Bill platform through <a href="https://github.com/killbill/killbill-plugin-api">plugin APIs</a>. This happens when a plugin that implements one of those APIs (or 'SPI' to be more precise) was correctly registered in the system.</p></li><li><p>They can receive notifications (bus events) from the Kill Bill platform</p></li><li><p>They can make <a href="https://github.com/killbill/killbill-api">API calls</a> to Kill Bill</p></li></ul></div>
<div class="paragraph"><p>Here are a few examples:</p></div>
<div class="ulist"><ul><li><p>Notification Plugin: A plugin registered to receive bus events. When a bus event is being delivered to the plugin, the plugin calls back Kill Bill through API calls to retrieve additional state for this event or to change the state in the system</p></li><li><p>Plugin that registered as an implementor of a specific <a href="https://github.com/killbill/killbill-plugin-api">plugin API</a>: A payment plugin for instance would have registered itself as an implementor of the <a href="https://github.com/killbill/killbill-plugin-api/blob/master/payment/src/main/java/org/killbill/billing/payment/plugin/api/PaymentPluginApi.java">PaymentPluginApi</a> and the payment system would then invoke that plugin for issuing payment operations. The plugin would have the ability to call back Kill Bill using APIs to retrieve more state or create/change state in the system.</p></li></ul></div>
<div class="paragraph"><p>A Kill Bill plugin will either implement one (or several) plugin API(s) and/or also listen to Kill Bill bus events to be notified of changes and take appropriate actions. It often makes sense to specialize plugins and have them implement only one of the <a href="https://github.com/killbill/killbill-plugin-api">plugin APIs</a>, but this is a design choice, and there is nothing preventing a plugin from implementing multiple of those APIs. Although we don&#8217;t recommend it, a plugin could implement the <a href="https://github.com/killbill/killbill-plugin-api/blob/master/payment/src/main/java/org/killbill/billing/payment/plugin/api/PaymentPluginApi.java">PaymentPluginApi</a> and the <a href="https://github.com/killbill/killbill-plugin-api/blob/master/control/src/main/java/org/killbill/billing/control/plugin/api/PaymentControlPluginApi.java">PaymentControlPluginApi</a>, and that would qualify it as a 'payment and payment control plugin'.</p></div>
<div class="paragraph"><p>Kill Bill Plugins can be used in a variety of ways:</p></div>
<div class="ulist"><ul><li><p>Extend Kill Bill subsytem: Payment plugins are a good example of such plugins; they extend the core payment functionality by connecting to third party systems</p></li><li><p>Provide additional business logic: Payment control plugins and invoice plugins allow to intercept the requests so as to modify it, abort it, or change state on the fly.</p></li><li><p>Listen to system events: The analytics plugin is a good example of such plugin</p></li></ul></div>
<div class="paragraph"><p>Kill Bill Plugins have full power (and therefore need to be designed and tested carefully):</p></div>
<div class="ulist"><ul><li><p>They have access to the database so as to maintain their own state. However they <strong>should not interact with the Kill Bill core tables directly</strong> but rely on APIs to retrieve and change state,</p></li><li><p>They have access to system properties</p></li><li><p>They have the ability to export their own HTTP endpoints under a <code>/plugins/&lt;pluginName&gt;</code> namespace</p></li><li><p>They receive all events in the system</p></li><li><p>They are isolated from the rest of the code and can use their own libraries (versions) without risk of conflict</p></li></ul></div></div></div>
<div class="sect1"><h2 id="_where_to_start">Where to Start?</h2><div class="sectionbody"><div class="paragraph"><p>A good starting point is to assess what the plugin should do and then based on that, read the various <a href="http://docs.killbill.io/">plugin docs in the developer guide section</a> that describe the different types of plugins offered in Kill Bill:</p></div>
<div class="ulist"><ul><li><p><a href="http://docs.killbill.io/latest/catalog_plugin.html">Catalog Plugin</a></p></li><li><p><a href="http://docs.killbill.io/latest/payment_plugin.html">Payment Plugin</a></p></li><li><p><a href="http://docs.killbill.io/latest/payment_control_plugin.html">(Payment) Control Plugin</a></p></li><li><p>Entitlement plugin</p></li><li><p><a href="http://docs.killbill.io/latest/invoice_plugin.html">Invoice Plugin</a></p></li><li><p><a href="http://docs.killbill.io/latest/notification_plugin.html">Notification Plugin</a></p></li></ul></div>
<div class="paragraph"><p>The next stage is to identify existing (similar) plugins which could be used as a starting point to write the code. At this point, this becomes a normal software development cycle, including writing unit tests for that plugin (independent of Kill Bill).</p></div></div></div>
<div class="sect1"><h2 id="_development">Development</h2><div class="sectionbody"><div class="paragraph"><p>This section explains how you can get started with developing your own plugin. It is recommended to clone some of our existing plugins to get started.  The <a href="https://github.com/killbill/killbill-hello-world-java-plugin">hello world plugin</a> is a good starting point. Once set up, this can be used as the basis for developing your own plugin.</p></div>
<div class="paragraph"><p>We provide a <a href="https://github.com/killbill/killbill-plugin-framework-java">Java plugin framework</a> that can be used to implement some of the work that plugins need to do - although your plugin does not have to rely on this framework, it is often a good idea to leverage it to avoid boilerplate code.</p></div>
<div class="paragraph"><p>Also, for internal reference, you might want to take a look at <a href="https://github.com/killbill/killbill-platform/blob/killbill-platform-0.36.2/osgi-bundles/libs/killbill/src/main/java/org/killbill/billing/osgi/libs/killbill/KillbillActivatorBase.java#L59">KillbillActivatorBase</a>, which provides all the abstractions that plugins require (access to java APIs, database connections, system properties, logging, &#8230;&#8203;).</p></div>
<div class="sect2"><h3 id="_prerequisites">Prerequisites</h3><div class="olist arabic"><ol class="arabic"><li><p>Ensure that you have <strong>Maven 3.5.2</strong> or higher (It can be downloaded from <a href="http://maven.apache.org/download.cgi">here</a>)</p></li><li><p>Ensure that you have <strong>JDK 8</strong> or higher (It can be downloaded from <a href="https://www.oracle.com/in/java/technologies/javase-downloads.html">here</a>)</p></li><li><p>Ensure that <strong>JAVA_HOME</strong> environment variable is set to the path of your JDK installation (For example, if JDK is installed at <strong>C:\Software\jdk1.8.0_102</strong>, you need to set <strong>JAVA_HOME</strong> to <strong>C:\Software\jdk1.8.0_102</strong>)</p></li></ol></div></div>
<div class="sect2"><h3 id="_setting_up_the_code_in_an_ide">Setting up the Code in an IDE</h3><div class="paragraph"><p>The first step is to set up the code for the  <a href="https://github.com/killbill/killbill-hello-world-java-plugin">hello world plugin</a> in an IDE. For this, you need to do the following:</p></div>
<div class="olist arabic"><ol class="arabic"><li><p>Clone the <strong>hello world plugin</strong> repository from <a href="https://github.com/killbill/killbill-hello-world-java-plugin">here</a></p></li><li><p>Set up the code in the IDE of your choice. You can refer to our <a href="https://docs.killbill.io/latest/development.html#_setting_up_code_in_an_ide">development document</a>  for detailed instructions on how to clone a repository and set up the code in Eclipse</p></li><li><p>This path where the repository is cloned will be referred to as <strong>PROJECT_ROOT</strong> from now on. For example, if you choose <code>C:/MyProjects/killbill-hello-world-java-plugin</code>, <strong>PROJECT_ROOT</strong> refers to this path.</p></li><li><p>Once the code is set up in Eclipse, your Eclipse workspace should look like this:
<span class="image"><img src="https://github.com/killbill/killbill-docs/raw/v3/userguide/assets/img/plugin_development/eclipse_workspace_with_helloworldplugin.png" alt="eclipse workspace with helloworldplugin"></span></p></li></ol></div></div>
<div class="sect2"><h3 id="_build">Build</h3><div class="paragraph"><p>The Hello World plugin is a standard Maven project. So you can build it as follows:</p></div>
<div class="olist arabic"><ol class="arabic"><li><p>Open a command prompt/terminal window and navigate to the <strong>PROJECT_ROOT</strong>  directory</p></li><li><p>Run the following command:</p><div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="bash"><span></span> mvn clean install -DskipTests</code></pre></div></div></li><li><p>Verify that a <strong>BUILD SUCCESS</strong> message is displayed on the console and that the plugin jar file
is created as <code>PROJECT_ROOT/target/&lt;artifact_id&gt;-&lt;version&gt;.jar</code></p></li></ol></div></div>
<div class="sect2"><h3 id="_deployment">Deployment</h3><div class="paragraph"><p>The Hello World plugin can be deployed in a Tomcat or Docker installation of the Kill Bill application. You can also install the Kill Bill application via kpm as specified <a href="https://github.com/killbill/killbill-cloud/tree/master/kpm#kill-bill-installation">here</a> and then install the plugin. However, if you are using the plugin as a basis to develop your own plugin, it would be useful to deploy the plugin in a standalone Jetty set up. This section explains how you can do this.</p></div>
<div class="olist arabic"><ol class="arabic"><li><p>Ensure that you have <strong>kpm</strong> installed as per the instructions given <a href="https://github.com/killbill/killbill-cloud/tree/master/kpm">here</a></p></li><li><p>Open a command prompt/terminal window and run the following command to install the plugin (Replace <code>PROJECT_ROOT</code> with your actual project root, <code>&lt;artifact_id&gt;-&lt;version&gt;</code> with your JAR file name and  <code>path_to_install_plugin</code> with the actual path where you would like to install the plugin):</p><div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="bash"><span></span>kpm install_java_plugin <span class="tok-s1">&#39;dev:hello&#39;</span> --from-source-file<span class="tok-o">=</span>PROJECT_ROOT/target/&lt;artifact_id&gt;-&lt;version&gt;.jar --destination<span class="tok-o">=</span>&lt;path_to_install_plugin&gt;</code></pre></div></div></li><li><p>Verify that the <code>&lt;artifact_id&gt;-&lt;version&gt;.jar</code> is copied at the <code>path_to_install_plugin</code> path</p></li><li><p>Ensure that the Kill Bill application is configured as per the instructions <a href="https://docs.killbill.io/latest/development.html#_setting_up_kill_bill_in_your_development_environment">here</a></p></li><li><p>Open <code>PROJECT_ROOT/profiles/killbill/src/main/resources/killbill-server.properties</code> and specify the following property (Replace <code>plugin_path</code> with the actual path where the plugin is installed. Note that if this property is not specified, the application looks for the plugin at the <code>/var/tmp/bundles/</code> path):</p><div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="properties"><span></span><span class="tok-na">org.killbill.osgi.bundle.install.dir</span><span class="tok-o">=</span><span class="tok-s">&lt;plugin_path&gt;</span></code></pre></div></div></li><li><p>Open a command prompt/terminal window and navigate to the <strong>PROJECT_ROOT</strong>  directory. Start Kill Bill by running the following command (Replace <code>PROJECT_ROOT</code> with your actual project root):</p><div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="bash"><span></span> mvn -Dorg.killbill.server.properties<span class="tok-o">=</span>file:///PROJECT_ROOT/profiles/killbill/src/main/resources/killbill-server.properties -Dlogback.configurationFile<span class="tok-o">=</span>./profiles/killbill/src/main/resources/logback.xml jetty:run</code></pre></div></div></li><li><p>Verify that the following is displayed in the Kill Bill logs which confirms that the plugin is installed successfully:</p><div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="bash"><span></span>  GET /               <span class="tok-o">[</span>*/*<span class="tok-o">]</span>     <span class="tok-o">[</span>*/*<span class="tok-o">]</span>    <span class="tok-o">(</span>/HelloWorldServlet.hello<span class="tok-o">)</span>
  GET /healthcheck    <span class="tok-o">[</span>*/*<span class="tok-o">]</span>     <span class="tok-o">[</span>*/*<span class="tok-o">]</span>    <span class="tok-o">(</span>/HelloWorldHealthcheckServlet.check<span class="tok-o">)</span>
listening on:
  http://localhost:8080/plugins/hello-world-plugin/</code></pre></div></div></li><li><p>Open a browser and type http://localhost:8080/plugins/hello-world-plugin/. If the plugin is installed properly, the following should be displayed in the Kill Bill logs:</p><div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="bash"><span></span><span class="tok-m">2020</span>-12-09T04:58:15,750+0000 <span class="tok-nv">lvl</span><span class="tok-o">=</span><span class="tok-s1">&#39;INFO&#39;</span>, <span class="tok-nv">log</span><span class="tok-o">=</span><span class="tok-s1">&#39;HelloWorldServlet&#39;</span>, <span class="tok-nv">th</span><span class="tok-o">=</span><span class="tok-s1">&#39;http-nio-8080-exec-1&#39;</span>, <span class="tok-nv">xff</span><span class="tok-o">=</span><span class="tok-s1">&#39;&#39;</span>, <span class="tok-nv">rId</span><span class="tok-o">=</span><span class="tok-s1">&#39;b79decfb-e809-4c01-9064-cff18722a67c&#39;</span>, <span class="tok-nv">tok</span><span class="tok-o">=</span><span class="tok-s1">&#39;&#39;</span>, <span class="tok-nv">aRId</span><span class="tok-o">=</span><span class="tok-s1">&#39;&#39;</span>, <span class="tok-nv">tRId</span><span class="tok-o">=</span><span class="tok-s1">&#39;&#39;</span>, Hello world</code></pre></div></div></li></ol></div></div>
<div class="sect2"><h3 id="_a_closer_look_at_helloworldservlet">A closer look at HelloWorldServlet</h3><div class="paragraph"><p>The <code>HelloWorldServlet</code> has a method called <code>hello</code> which provides some basic skeleton code. It can be expanded as required. A few pointers about this method:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="java"><span></span>  <span class="tok-nd">@GET</span>
    <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">hello</span><span class="tok-p">(</span><span class="tok-nd">@Local</span> <span class="tok-nd">@Named</span><span class="tok-p">(</span><span class="tok-s">&quot;killbill_tenant&quot;</span><span class="tok-p">)</span> <span class="tok-kd">final</span> <span class="tok-n">Optional</span><span class="tok-o">&lt;</span><span class="tok-n">Tenant</span><span class="tok-o">&gt;</span> <span class="tok-n">tenant</span><span class="tok-p">)</span> <span class="tok-p">{</span>
        <span class="tok-c1">// Find me on http://127.0.0.1:8080/plugins/hello-world-plugin</span>
        <span class="tok-n">logger</span><span class="tok-p">.</span><span class="tok-na">info</span><span class="tok-p">(</span><span class="tok-s">&quot;Hello world&quot;</span><span class="tok-p">);</span>
        <span class="tok-k">if</span><span class="tok-p">(</span><span class="tok-n">tenant</span> <span class="tok-o">!=</span> <span class="tok-kc">null</span> <span class="tok-o">&amp;&amp;</span> <span class="tok-n">tenant</span><span class="tok-p">.</span><span class="tok-na">isPresent</span><span class="tok-p">()</span> <span class="tok-p">)</span> <span class="tok-p">{</span>
        	<span class="tok-n">logger</span><span class="tok-p">.</span><span class="tok-na">info</span><span class="tok-p">(</span><span class="tok-s">&quot;tenant is available&quot;</span><span class="tok-p">);</span>
        	<span class="tok-n">Tenant</span> <span class="tok-n">t1</span> <span class="tok-o">=</span> <span class="tok-n">tenant</span><span class="tok-p">.</span><span class="tok-na">get</span><span class="tok-p">();</span>
        	<span class="tok-n">logger</span><span class="tok-p">.</span><span class="tok-na">info</span><span class="tok-p">(</span><span class="tok-s">&quot;tenant id:&quot;</span><span class="tok-o">+</span><span class="tok-n">t1</span><span class="tok-p">.</span><span class="tok-na">getId</span><span class="tok-p">());</span>
        <span class="tok-p">}</span>
        <span class="tok-k">else</span> <span class="tok-p">{</span>
        	<span class="tok-n">logger</span><span class="tok-p">.</span><span class="tok-na">info</span><span class="tok-p">(</span><span class="tok-s">&quot;tenant is not available&quot;</span><span class="tok-p">);</span>
        <span class="tok-p">}</span>
    <span class="tok-p">}</span></code></pre></div></div>
<div class="ulist"><ul><li><p>This method provides the code for the http://localhost:8080/plugins/hello-world-plugin endpoint.</p></li><li><p>It accepts a parameter corresponding to <code>Tenant</code> which is an <code>Optional</code>.</p></li><li><p>If the headers <strong>X-Killbill-ApiKey / X-Killbill-ApiSecret</strong> are set while accessing this endpoint as shown below, Kill Bill automatically injects a <code>Tenant</code> object into the servlet.</p><div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="bash"><span></span>curl -v -u admin:password -H <span class="tok-s2">&quot;X-Killbill-ApiKey: bob&quot;</span> -H <span class="tok-s2">&quot;X-Killbill-ApiSecret: lazar&quot;</span> <span class="tok-s2">&quot;http://127.0.0.1:8080/plugins/hello-world-plugin&quot;</span></code></pre></div></div></li><li><p>The <code>Tenant</code> object can then be used to retrieve tenant information like <code>tenantId</code> as demonstrated in the code above.</p></li><li><p>If the headers <strong>X-Killbill-ApiKey / X-Killbill-ApiSecret</strong> are NOT set while accessing this endpoint as shown below, Kill Bill injects an empty <code>Optional</code> into the servlet.</p><div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="bash"><span></span>curl -v -u admin:password <span class="tok-s2">&quot;http://127.0.0.1:8080/plugins/hello-world-plugin&quot;</span></code></pre></div></div></li></ul></div></div>
<div class="sect2"><h3 id="_setting_up_a_breakpoint_and_debugging">Setting up a breakpoint and debugging</h3><div class="paragraph"><p>When you start developing your own plugin, it would be useful to be able to set up a break point and debug the plugin code. This section explains how you can achieve this.</p></div>
<div class="olist arabic"><ol class="arabic"><li><p>Create a new environment variable <strong>MAVEN_OPTS</strong> and set it to <code>-Xdebug -Xnoagent -Djava.compiler=NONE -Xrunjdwp:transport=dt_socket,address=8000,server=y,suspend=n</code></p></li><li><p>Open Eclipse and do the following:</p><div class="olist loweralpha"><ol class="loweralpha" type="a"><li><p>Set up a break point in the HelloWorldServlet#L41</p></li><li><p>Click <code>Run &gt; Debug Configurations</code></p></li><li><p>Double click  <code>New Remote Java Application</code></p></li><li><p>Enter the name that you would like to give to this debug configuration in the <strong>Name</strong> field</p></li><li><p>Click <strong>Apply</strong></p></li><li><p>Click <strong>Close</strong></p></li></ol></div></li><li><p>Restart the Kill Bill application as explained in <a href="#_deployment">[_deployment]</a> section above</p></li><li><p>Click <code>Run &gt; Debug Configurations</code> and double click the  the Debug configuration that you created above</p></li><li><p>This runs the application in debug mode. You can also set additional breakpoints as required.</p></li></ol></div></div>
<div class="sect2"><h3 id="_additional_configuration">Additional Configuration</h3><div class="paragraph"><p>This section is a work in progress and will be updated soon!</p></div>
<div class="paragraph"><p><code>java</code> plugins rely on the <a href="http://felix.apache.org/documentation/subprojects/apache-felix-maven-bundle-plugin-bnd.html"><code>maven-bundle-plugin</code></a> to produce the correct OSGI plugin (with the correct <code>MANIFEST.MF</code>). It is recommended to start from a plugin that already works, as the build configuration can be quite tricky. A good example is to look at the <code>pom.xml</code> from the <a href="https://github.com/killbill/killbill-hello-world-java-plugin/blob/master/pom.xml">hello world plugin</a></p></div>
<div class="paragraph"><p>The build will produce a <code>jar</code> under the <code>target</code> directory which should contain all the classes and configuration files directly accessible for that plugin. OSGI also provides a way to import classes that are exported by other plugins and this is configured in the <code>Import-Package</code> section of the <code>maven-bundle-plugin</code>. The hello world plugin provides some default based on the <a href="https://github.com/killbill/killbill-platform/blob/killbill-platform-0.36.2/osgi/src/main/java/org/killbill/billing/osgi/config/OSGIConfig.java#L49">classes exported by the system bundle in Kill Bill</a>. Kill Bill offers a system property, <code>org.killbill.osgi.system.bundle.export.packages.extra</code>, to specify additional packages to be exported by the system bundle and that could in turn be imported by the plugin. Designing which packages are served by the plugin jar and which one are imported from another bundle (and mostly the system bundle inside Kill Bill) is one of the challenges of the OSGI mechanism.</p></div></div>
<div class="sect2"><h3 id="_examples_of_plugins">Examples of Plugins</h3><div class="paragraph"><p>The Kill Bill team already provides many open source plugins. Some of these are are follows:</p></div>
<div class="ulist"><ul><li><p><a href="https://github.com/killbill/killbill-analytics-plugin">Analytics plugin</a> (<a href="https://docs.killbill.io/latest/notification_plugin.html">notification plugin</a>)</p></li><li><p><a href="https://github.com/killbill/killbill-adyen-plugin">Adyen plugin</a> (<a href="https://docs.killbill.io/latest/payment_plugin.html">payment plugin</a>)</p></li><li><p><a href="https://github.com/killbill/killbill-accertify-plugin">Accertify plugin</a> (<a href="https://docs.killbill.io/latest/payment_control_plugin.html">payment control plugin</a>)</p></li><li><p><a href="https://github.com/killbill/killbill-coupon-plugin-demo">Coupon plugin</a> (<a href="https://github.com/killbill/killbill-plugin-api/blob/master/entitlement/src/main/java/org/killbill/billing/entitlement/plugin/api/EntitlementPluginApi.java">entitlement plugin</a>)</p></li><li><p><a href="https://github.com/killbill/killbill-avatax-plugin">Avalara plugin</a> (<a href="https://docs.killbill.io/latest/invoice_plugin.html">invoice plugin</a>)</p></li><li><p><a href="https://github.com/killbill/killbill-catalog-plugin-test">Catalog test plugin</a> (<a href="https://docs.killbill.io/latest/catalog_plugin.html">catalog plugin</a>)</p></li></ul></div>
<div class="paragraph"><p>You can check the <a href="https://github.com/killbill">Kill Bill Github</a> page for the complete list of plugins maintained by the Kill Bill team.</p></div></div></div></div>
<div class="sect1"><h2 id="_plugin_layout">Plugin Layout</h2><div class="sectionbody"><div class="sect2"><h3 id="_overview">Overview</h3><div class="paragraph"><p>Kill Bill will scan the filesystem on startup and will start all the plugins that were detected. Kill Bill will use the value of the system property <code>org.killbill.osgi.bundle.install.dir</code> to determine the root of plugin directory structure.
By default, this value is set to <code>/var/tmp/bundles</code>, as indicated by the <a href="https://github.com/killbill/killbill-platform/blob/killbill-platform-0.36.2/osgi/src/main/java/org/killbill/billing/osgi/config/OSGIConfig.java#L44">Kill Bill OSGIConfig file</a>.</p></div>
<div class="paragraph"><p>The directory structure looks like the following:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code><span></span>root (org.killbill.osgi.bundle.install.dir)
|_sha1.yml
|_platform
|_plugins
  |_java
  |_plugin_identifiers.json</code></pre></div></div>
<div class="paragraph"><p>Under <code>root</code>, we will find the following:</p></div>
<div class="ulist"><ul><li><p>A <code>sha1.yml</code> file which is a used by the <code>KPM</code> tool to keep track of artifacts that were already downloaded to avoid downloading binaries already present on the filesystem. KPM also offers the <code>--force-download</code> to override that behavior.</p></li><li><p>A <code>platform</code> folder which contains a set of <a href="http://felix.apache.org/downloads.cgi">pure OSGI bundles</a> (unrelated to Kill Bill plugins) and required for things like OSGI logging, OSGI console, &#8230;&#8203;</p></li><li><p>A <code>plugins</code> folder which contains:</p><div class="ulist"><ul><li><p>A <code>java</code> folder. Under <code>java</code>, we will find one entry per plugin per version.
For instance, if we had installed two versions for the <code>stripe</code> plugin, we would see the following (<code>SET_DEFAULT</code> is a symbolic link that point to the default active version):</p><div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="bash"><span></span> java
  <span class="tok-p">|</span>_killbill-stripe
   <span class="tok-p">|</span>_ <span class="tok-m">3</span>.0.2
   <span class="tok-p">|</span>_ <span class="tok-m">3</span>.0.1
   <span class="tok-p">|</span>_ SET_DEFAULT</code></pre></div></div></li><li><p>A <code>plugin_identifiers.json</code> file which is used to keep a mapping between the <code>pluginKey</code> (the user visible plugin identifer), and the <code>pluginName</code> (runtime identifier used by Kill Bill when scanning the filesystem). The next section provides more details about those.</p></li></ul></div></li></ul></div></div>
<div class="sect2"><h3 id="_plugin_coordinates_plugin_key_plugin_name">Plugin Coordinates, Plugin Key, Plugin Name, &#8230;&#8203;</h3><div class="paragraph"><p>Today, plugins are released through maven and are therefore identified through their maven coordinates. We might support other schemes in the future but today this is the only way we offer to download and install publicly released plugins. Plugin Coordinates are too cumbersome to manipulate though and are unsuitable for non-published plugins (typical use case for a plugin being developed), so we introduced some identifers.</p></div>
<div class="paragraph"><p>As mentioned earlier, Kill Bill will scan the filesystem (<code>org.killbill.osgi.bundle.install.dir</code>) on start-up to detect and then start all the plugins. The name on the filesystem (e.g. in our previous example <code>killbill-stripe</code>) constitutes what we call the <strong><code>pluginName</code></strong>.</p></div>
<div class="paragraph"><p>When installing using KPM, the <code>pluginName</code> is dependent on how the plugin was packaged. For well known publicly available Kill Bill plugins, we adopted a (sane) convention, but we have no way to enforce that convention for third party plugins. Also, note that we could change the name of <code>killbill-stripe</code> to <code>foo</code> on the filesystem (<code>mv killbill-stripe foo</code>) and then suddenly Kill Bill would see that plugin as being the <code>foo</code> plugin. Therefore, the <code>pluginName</code> is not a reliable way to identify the plugin, and is used solely by Kill Bill as an runtime identifier.</p></div>
<div class="paragraph"><p>The <code>pluginKey</code> is the identifier for the plugin and is used for all the user visible operations, whether through the KPM command line tool or whether using the <a href="http://docs.killbill.io/latest/plugin_management.html">Plugin Management APIs</a>.
There is a distinction to be made between publicly released Kill Bill plugins and third party plugins:</p></div>
<div class="ulist"><ul><li><p>(Publicly Released) Kill Bill Plugins: All the plugins developed by the Kill Bill core team are maintained in a <a href="https://github.com/killbill/killbill-cloud/blob/master/kpm/lib/kpm/plugins_directory.yml">repository</a> (we provide today a simple file-based repository, but this may change in the future as we start accepting certified third-party plugins).
Each entry in that repository is identified by a key, and that key is the <code>pluginKey</code>.</p></li><li><p>Third party plugins: For third party plugins, the key is specified at the time the plugin gets installed. The key must be of the form <code>&lt;prefix&gt;::&lt;something&gt;</code> to make sure there is no name collision with Kill Bill plugin keys.</p></li></ul></div></div></div></div>
<div class="sect1"><h2 id="_plugin_installation">Plugin Installation</h2><div class="sectionbody"><div class="paragraph"><p>As explained earlier, Kill Bill looks for plugins at the path specified by the <code>org.killbill.osgi.bundle.install.dir</code> property in the Kill Bill configuration file. So, installing the plugin simply means placing the plugin artifact at this path. This can either be done manually or via kpm as explained below.</p></div>
<div class="sect2"><h3 id="_deploying_by_hand">Deploying by Hand</h3><div class="paragraph"><p>Deploying by hand consists of building the self contained OSGI jar, and copying that jar at the right location. For example, the <code>adyen</code> plugin with a version with version <code>0.3.2</code> would show up as the following:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code><span></span>java
|_adyen-plugin
  |_ 0.3.2
    |_ adyen-plugin-0.3.2.jar</code></pre></div></div></div>
<div class="sect2"><h3 id="_deployment_through_kpm">Deployment Through KPM</h3><div class="paragraph"><p>The standard way to deploy plugins is to use the Kill Bill Package Manager (<a href="https://github.com/killbill/killbill-cloud/blob/master/kpm">KPM</a>).</p></div>
<div class="paragraph"><p>KPM can be used for:</p></div>
<div class="ulist"><ul><li><p>Deploying <strong>custom</strong> (plugins developed by you) plugins</p></li><li><p>Deploying <strong>Kill Bill</strong> (plugins maintained by the Kill Bill team) plugins</p></li><li><p>Deploying <strong>Third-party</strong> (plugins developed and maintained by a third party and not by the Kill Bill team) plugins</p></li></ul></div>
<div class="sect3"><h4 id="_custom_plugins">Custom plugins</h4><div class="paragraph"><p>If you are a developer and either modifying an existing plugin or creating a new plugin, you can use KPM to install the plugin.</p></div>
<div class="paragraph"><p>A custom Java plugin can be installed using the <code>kpm install_java_plugin</code> command as shown below:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="bash"><span></span>kpm install_java_plugin <span class="tok-s1">&#39;&lt;plugin-key&gt;&#39;</span> --from-source-file<span class="tok-o">=</span><span class="tok-s2">&quot;&lt;jar_path&gt;.jar&quot;</span>
--destination<span class="tok-o">=</span><span class="tok-s2">&quot;&lt;path_to_install_plugin&gt;&quot;</span></code></pre></div></div>
<div class="ulist"><ul><li><p>Replace <code>plugin-key</code> with an appropriate value. We suggest that you specify a plugin_key with a namespace <strong>dev:</strong> to make it clear this is not a released version. So, you can use a plugin-key called <code>dev:pluginname</code></p></li><li><p>Replace <code>&lt;jar_path&gt;</code> by the full path of the JAR file</p></li><li><p>Replace <code>&lt;path_to_install_plugin&gt;</code> with the path where you want to install the plugin. This path should match the path specified by the <code>org.killbill.osgi.bundle.install.dir</code> property in the Kill Bill configuration file.</p></li><li><p>If <code>--destination</code> is not specified, the plugin is installed by default in the <code>var/tmp/bundles</code> directory</p></li><li><p>For detailed instructions, refer to the <a href="https://docs.killbill.io/latest/plugin_development.html#_deployment">deployment</a> section above.</p></li></ul></div></div>
<div class="sect3"><h4 id="_kill_bill_plugins_2">Kill Bill Plugins</h4><div class="paragraph"><p>A Kill Bill plugin is a plugin that is maintained by the Kill Bill team. Such plugins have a key in the Kill Bill <a href="https://github.com/killbill/killbill-cloud/blob/master/kpm/lib/kpm/plugins_directory.yml">Plugin Directory</a>. So, in order to install such a plugin, its key needs to be specified.</p></div>
<div class="paragraph"><p>A Kill Bill Java plugin can be installed using the <code>kpm install_java_plugin</code> command as follows:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="bash"><span></span>kpm install_java_plugin <span class="tok-s1">&#39;&lt;plugin-key&gt;&#39;</span></code></pre></div></div>
<div class="ulist"><ul><li><p>Replace <code>plugin-key</code> with an appropriate value from the Kill Bill <a href="https://github.com/killbill/killbill-cloud/blob/master/kpm/lib/kpm/plugins_directory.yml">Plugin Directory</a>.</p></li><li><p>For example, in order to install the stripe plugin, you can replace <code>plugin-key</code> with <code>stripe</code></p></li></ul></div></div>
<div class="sect3"><h4 id="_third_party_plugins">Third party plugins</h4><div class="paragraph"><p>Third-party plugins are plugins developed and maintained by a third party and not by the Kill Bill team.  Such plugins can be installed via KPM from their binary repositories (Maven Central, GitHub Packages and Cloudsmith).</p></div>
<div class="paragraph"><p>A third party Java plugin can be installed using the <code>kpm install_java_plugin</code> command as follows:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="bash"><span></span>kpm install_java_plugin <span class="tok-s1">&#39;&lt;plugin-key&gt;&#39;</span>
--group_id<span class="tok-o">=</span><span class="tok-s2">&quot;&lt;group id&gt;&quot;</span>
--artifact_id<span class="tok-o">=</span><span class="tok-s2">&quot;&lt;artifact_id&gt;&quot;</span>
--version<span class="tok-o">=</span><span class="tok-s2">&quot;&lt;version&gt;&quot;</span></code></pre></div></div>
<div class="ulist"><ul><li><p>Replace <code>plugin-key</code> with the plugin name.</p></li><li><p>Replace <code>&lt;group id&gt;</code>, <code>&lt;artifact_id&gt;</code>, <code>&lt;version&gt;</code> with appropriate values from the binary repository.</p></li></ul></div></div></div></div></div>
<div class="sect1"><h2 id="_plugin_configuration">Plugin Configuration</h2><div class="sectionbody"><div class="sect2"><h3 id="_system_properties">System Properties</h3><div class="paragraph"><p>Kill Bill plugins can access Kill Bill properties through the use of a special interface <a href="https://github.com/killbill/killbill-platform/blob/master/osgi-api/src/main/java/org/killbill/billing/osgi/api/OSGIConfigProperties.java">OSGIConfigProperties</a>. System properties passed to the JVM and properties from the <code>killbill.properties</code> configuration file are then accessible to the plugins and can be used to tweak the behavior of the plugin as needed.</p></div></div>
<div class="sect2"><h3 id="_configuration_file">Configuration File</h3><div class="paragraph"><p>Property files can be used to configure global settings for a plugin. Those property files need to be part of the archive (the OSGI mechanism will make sure these are only visible to the particular plugin):</p></div>
<div class="ulist"><ul><li><p>The property file needs to be on the classpath (<code>resource</code> directory)</p></li><li><p>There is no restriction on the format of the property file, but typically  plugins will rely on <code>key-value</code> properties, <code>json</code> or <code>xml</code> files.</p></li></ul></div></div>
<div class="sect2"><h3 id="_per_tenant_configuration">Per-tenant Configuration</h3><div class="paragraph"><p>The two previous mechanisms work well for global settings, but are inadequate to configure the plugins on a per-tenant fashion (e.g for a payment plugin interacting with a payment gateway, different credentials might be needed for different tenants). In those situations, Kill Bill provides APIs to upload/retrieve/delete per-tenant plugin configurations:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="bash"><span></span><span class="tok-c1"># Upload new config</span>
curl -v <span class="tok-se">\</span>
     -X POST <span class="tok-se">\</span>
     -u admin:password <span class="tok-se">\</span>
     -H <span class="tok-s1">&#39;X-Killbill-ApiKey: bob&#39;</span> <span class="tok-se">\</span>
     -H <span class="tok-s1">&#39;X-Killbill-ApiSecret: lazar&#39;</span> <span class="tok-se">\</span>
     -H <span class="tok-s1">&#39;X-Killbill-CreatedBy: admin&#39;</span> <span class="tok-se">\</span>
     -H <span class="tok-s1">&#39;Content-Type: text/plain&#39;</span> <span class="tok-se">\</span>
     -d <span class="tok-s1">&#39;&lt;CONFIG&gt;&#39;</span> <span class="tok-se">\</span>
     http://127.0.0.1:8080/1.0/kb/tenants/uploadPluginConfig/&lt;pluginName&gt;</code></pre></div></div>
<div class="paragraph"><p>The <code>&lt;CONFIG&gt;</code> is treaded as a string and it could be the content of an <code>xml</code> or <code>json</code> file, a list of <code>key-value</code> parameters, &#8230;&#8203;</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="bash"><span></span><span class="tok-c1"># Retrieve config</span>
curl -v <span class="tok-se">\</span>
     -u admin:password <span class="tok-se">\</span>
     -H <span class="tok-s1">&#39;X-Killbill-ApiKey: bob&#39;</span> <span class="tok-se">\</span>
     -H <span class="tok-s1">&#39;X-Killbill-ApiSecret: lazar&#39;</span> <span class="tok-se">\</span>
     -H <span class="tok-s1">&#39;X-Killbill-CreatedBy: admin&#39;</span> <span class="tok-se">\</span>
     -H <span class="tok-s1">&#39;Content-Type: application/json&#39;</span> <span class="tok-se">\</span>
     http://127.0.0.1:8080/1.0/kb/tenants/uploadPluginConfig/&lt;pluginName&gt;</code></pre></div></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="bash"><span></span><span class="tok-c1"># Delete config</span>
curl -v <span class="tok-se">\</span>
     -X DELETE <span class="tok-se">\</span>
     -u admin:password <span class="tok-se">\</span>
     -H <span class="tok-s1">&#39;X-Killbill-ApiKey: bob&#39;</span> <span class="tok-se">\</span>
     -H <span class="tok-s1">&#39;X-Killbill-ApiSecret: lazar&#39;</span> <span class="tok-se">\</span>
     -H <span class="tok-s1">&#39;X-Killbill-CreatedBy: admin&#39;</span> <span class="tok-se">\</span>
     http://127.0.0.1:8080/1.0/kb/tenants/uploadPluginConfig/&lt;pluginName&gt;</code></pre></div></div>
<div class="paragraph"><p>At a high level, the mechanism works in the following way:</p></div>
<div class="olist arabic"><ol class="arabic"><li><p>The administrator uses the kill bill API (or Kaui) to upload the configuration</p></li><li><p>Kill Bill stores the config in the <code>tenant_kvs</code> table using a <code>tenant_key</code> of <code>PLUGIN_CONFIG_&lt;pluginName&gt;</code> and sets the <code>tenant_value</code> with the config provided</p></li><li><p>Kill Bill broadcasts the change across the cluster of nodes and emits a configuration bus event: <code>TENANT_CONFIG_CHANGE</code> or <code>TENANT_CONFIG_DELETION</code></p></li><li><p>The plugin code is <strong>responsible to listen to these events</strong> and take appropriate action to reload/delete its configuration for that specific tenant.</p></li></ol></div>
<div class="paragraph"><p>Note that if the <a href="https://github.com/killbill/killbill-plugin-framework-java">plugin framework</a> is used, some amount of work is already provided as can be seen from this <a href="https://github.com/killbill/killbill-plugin-framework-java/blob/killbill-base-plugin-1.1.0/src/main/java/org/killbill/billing/plugin/api/notification/PluginConfigurationEventHandler.java#L37">listener</a></p></div></div></div></div>
<div class="sect1"><h2 id="_faq">FAQ</h2><div class="sectionbody"><div class="paragraph"><p>This section lists some common errors that are encountered while <a href="https://docs.killbill.io/latest/plugin_development.html#_development">developing</a> plugins and how you can fix them.</p></div>
<div class="sect2"><h3 id="_authentication_error">Authentication Error</h3><div class="paragraph"><p>Sometimes, you may see the <code>org.apache.shiro.authz.UnauthenticatedException: This subject is anonymous</code>. This occurs when your plugin code invokes any of the read/write Kill Bill operations without authenticating against Kill Bill. So, you first need to invoke <code>SecurityApi#login</code> API.</p></div>
<div class="paragraph"><p>Here is how it can be used in a Servlet for instance:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-kd">private</span> <span class="tok-kt">void</span> <span class="tok-nf">login</span><span class="tok-p">(</span><span class="tok-kd">final</span> <span class="tok-n">HttpServletRequest</span> <span class="tok-n">req</span><span class="tok-p">)</span> <span class="tok-p">{</span>
    <span class="tok-n">String</span> <span class="tok-n">authHeader</span> <span class="tok-o">=</span> <span class="tok-n">req</span><span class="tok-p">.</span><span class="tok-na">getHeader</span><span class="tok-p">(</span><span class="tok-s">&quot;Authorization&quot;</span><span class="tok-p">);</span>
    <span class="tok-k">if</span> <span class="tok-p">(</span><span class="tok-n">authHeader</span> <span class="tok-o">==</span> <span class="tok-kc">null</span><span class="tok-p">)</span> <span class="tok-p">{</span>
        <span class="tok-k">return</span><span class="tok-p">;</span>
    <span class="tok-p">}</span>

    <span class="tok-kd">final</span> <span class="tok-n">String</span><span class="tok-o">[]</span> <span class="tok-n">authHeaderChunks</span> <span class="tok-o">=</span> <span class="tok-n">authHeader</span><span class="tok-p">.</span><span class="tok-na">split</span><span class="tok-p">(</span><span class="tok-s">&quot; &quot;</span><span class="tok-p">);</span>
    <span class="tok-k">if</span> <span class="tok-p">(</span><span class="tok-n">authHeaderChunks</span><span class="tok-p">.</span><span class="tok-na">length</span> <span class="tok-o">&lt;</span> <span class="tok-mi">2</span><span class="tok-p">)</span> <span class="tok-p">{</span>
        <span class="tok-k">return</span><span class="tok-p">;</span>
    <span class="tok-p">}</span>

    <span class="tok-k">try</span> <span class="tok-p">{</span>
        <span class="tok-kd">final</span> <span class="tok-n">String</span> <span class="tok-n">credentials</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">String</span><span class="tok-p">(</span><span class="tok-n">BaseEncoding</span><span class="tok-p">.</span><span class="tok-na">base64</span><span class="tok-p">().</span><span class="tok-na">decode</span><span class="tok-p">(</span><span class="tok-n">authHeaderChunks</span><span class="tok-o">[</span><span class="tok-mi">1</span><span class="tok-o">]</span><span class="tok-p">),</span> <span class="tok-s">&quot;UTF-8&quot;</span><span class="tok-p">);</span>
        <span class="tok-kt">int</span> <span class="tok-n">p</span> <span class="tok-o">=</span> <span class="tok-n">credentials</span><span class="tok-p">.</span><span class="tok-na">indexOf</span><span class="tok-p">(</span><span class="tok-s">&quot;:&quot;</span><span class="tok-p">);</span>
        <span class="tok-k">if</span> <span class="tok-p">(</span><span class="tok-n">p</span> <span class="tok-o">==</span> <span class="tok-o">-</span><span class="tok-mi">1</span><span class="tok-p">)</span> <span class="tok-p">{</span>
            <span class="tok-k">return</span><span class="tok-p">;</span>
        <span class="tok-p">}</span>

        <span class="tok-kd">final</span> <span class="tok-n">String</span> <span class="tok-n">login</span> <span class="tok-o">=</span> <span class="tok-n">credentials</span><span class="tok-p">.</span><span class="tok-na">substring</span><span class="tok-p">(</span><span class="tok-mi">0</span><span class="tok-p">,</span> <span class="tok-n">p</span><span class="tok-p">).</span><span class="tok-na">trim</span><span class="tok-p">();</span>
        <span class="tok-kd">final</span> <span class="tok-n">String</span> <span class="tok-n">password</span> <span class="tok-o">=</span> <span class="tok-n">credentials</span><span class="tok-p">.</span><span class="tok-na">substring</span><span class="tok-p">(</span><span class="tok-n">p</span> <span class="tok-o">+</span> <span class="tok-mi">1</span><span class="tok-p">).</span><span class="tok-na">trim</span><span class="tok-p">();</span>
        <span class="tok-n">killbillAPI</span><span class="tok-p">.</span><span class="tok-na">getSecurityApi</span><span class="tok-p">().</span><span class="tok-na">login</span><span class="tok-p">(</span><span class="tok-n">login</span><span class="tok-p">,</span> <span class="tok-n">password</span><span class="tok-p">);</span>
    <span class="tok-p">}</span> <span class="tok-k">catch</span> <span class="tok-p">(</span><span class="tok-n">UnsupportedEncodingException</span> <span class="tok-n">ignored</span><span class="tok-p">)</span> <span class="tok-p">{</span>
    <span class="tok-p">}</span>
<span class="tok-p">}</span></code></pre></div></div></div>
<div class="sect2"><h3 id="_maven_build_error">Maven Build Error</h3><div class="paragraph"><p>Sometimes, when you run <code>mvn clean install</code> on the plugin code, you may see the following maven error:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="bash"><span></span>Failed to execute goal org.apache.maven.plugins:maven-enforcer-plugin:3.0.0-M3:enforce <span class="tok-o">(</span>default<span class="tok-o">)</span> on project killbill-plugin-momo: Some Enforcer rules have failed.</code></pre></div></div>
<div class="paragraph"><p>This generally occurs when your <code>pom.xml</code> contains dependencies that are not recommended. The maven build has lots of checks in place to make sure the right dependencies are pulled in, there are no duplicate dependencies, there are no obvious bugs, etc.
If you&#8217;d like to ignore all these checks and still proceed with the build, you can run the following command:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="bash"><span></span>mvn clean install -Dcheck.fail-enforcer<span class="tok-o">=</span><span class="tok-nb">false</span> -Dcheck.fail-dependency<span class="tok-o">=</span><span class="tok-nb">false</span> -Dcheck.fail-dependency-scope<span class="tok-o">=</span><span class="tok-nb">false</span> -Dcheck.fail-dependency-versions<span class="tok-o">=</span><span class="tok-nb">false</span> -Dcheck.fail-duplicate-finder<span class="tok-o">=</span><span class="tok-nb">false</span> -Dcheck.fail-enforcer<span class="tok-o">=</span><span class="tok-nb">false</span> -Dcheck.fail-spotbugs<span class="tok-o">=</span><span class="tok-nb">false</span> -Dcheck.ignore-rat<span class="tok-o">=</span><span class="tok-nb">true</span></code></pre></div></div>
<div class="paragraph"><p>However, this is <strong>not recommended</strong>, we recommend that you fix the POM file and run the build with all the checks in place.</p></div></div></div></div></div></div><div class="col-12 col-md-3 col-xl-2 bd-sidebar sticky-top border-columns border-right p-0"><nav class="collapse bd-links toc right-side-menu" id="toc" data-toggle="toc"></nav></div></div></div><div class="container-fluid"><div class="row"><div class="col-12 border-columns"></div><div id="footer"><div id="footer-text">Last updated 2021-04-16 07:23:16 UTC</div><script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
          ga('create','UA-32705710-3','auto');
          ga('send','pageview');
          var getOutboundLink = function(url) {
            ga('send', {
              hitType: 'event',
              eventCategory: 'outbound',
              eventAction: 'click',
              eventLabel: url,
              hitCallback: function(){document.location = url;}
            });
          }
          </script></div><script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script><script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script><script src="https://cdn.staticaly.com/gh/afeld/bootstrap-toc/v1.0.0/dist/bootstrap-toc.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script><script type="text/javascript">docsearch({apiKey: '9d2f6d24a05863f83c8844f6e7492c66',indexName: 'killbill',inputSelector: '#search-input',debug: false});</script></body></html>