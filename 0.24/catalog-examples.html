<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]--><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="Asciidoctor 2.0.20"><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.staticaly.com/gh/afeld/bootstrap-toc/v1.0.0/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3"><link rel="preconnect" href="https://S2ISXITURI-dsn.algolia.net"><style type="text/css"></style><title>Catalog Examples</title><style>/*Default CSS*/

/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */

@import "https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap";

*,
*::before,
*::after {
  -webkit-box-sizing: border-box;
  box-sizing: border-box;
}

ul,
ol {
  padding: 0;
  list-style-type: none;
}

body,
h1,
h2,
h3,
h4,
p,
ul[class],
ol[class],
li,
figure,
figcaption,
blockquote,
dl,
dd {
  margin: 0;
}

body {
  min-height: 100vh;
  scroll-behavior: smooth;
  text-rendering: optimizeSpeed;
  font-family: 'Inter', sans-serif;
  font-size: 16px;
  line-height: 150%;
  color: #374151;
  max-width: 100%;
  overflow-x: hidden;
}

ul[class],
ol[class] {
  list-style: none;
}

img {
  max-width: 100%;
  display: block;
}

img[align=center] {
  margin: 0 auto;
}

button {
  cursor: pointer;
}

input,
button,
textarea,
select {
  font: inherit;
}
a {
  color: #167BB7;
}
h1,
h3,
h4 {
  font-weight: 400;
}
h2,
h3,
h4 {
  color: #1F2937;
}
h1 {
  font-size: 40px;
  line-height: 120%;
  letter-spacing: -0.025em;
  color: #FFFFFF;
}
h2 {
  font-weight: 600;
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
  font-weight: 500;
}

.header {
  padding: 16px 0;
  background: #FFFFFF;
  box-shadow: 0 1px 3px rgba(0, 0, 0, .1), 0 1px 2px rgba(0, 0, 0, .06);
}
@media (min-width: 768px) {
  .header-logo {
    width: 320px;
  }
}
.header-wrapper .logo {
  max-width: 215px;
  margin: auto;
  width: 80%;
}
.header-wrapper .logo img {
  object-fit: contain;
}
@media (max-width: 767px) {
  .header-wrapper .logo a {
    display: flex;
    justify-content: center;
  }
}
.header-search {
  flex-grow: 1;
  padding-right: 16px;
}
@media (min-width: 768px) {
  .header-search {
    /*flex-grow: 1;*/
    /*max-width: calc(100% - 590px);*/
    /*padding-right: 53px;*/
    /*padding-left: 45px;*/
  }
}
@media (min-width: 1200px) {
  .header-search {
    max-width: calc(100% - 590px);
    padding-right: 53px;
    padding-left: 45px;
  }
}

.header-wrapper .search-form-wrapper {
  flex-grow: 1;
}
.header-wrapper .search-form {
  position: relative;
}
.header-wrapper .search-form .algolia-autocomplete {
  width: 100%;
}
.header-wrapper .search-form input[type="search"] {
  width: 100%;
  padding: 9px 9px 9px 40px;
  border: 1px solid #D1D5DB;
  border-radius: 6px;
  box-shadow: 0 1px 2px rgba(0, 0, 0, .05);
}
.header-wrapper .search-form .ds-dropdown-menu {
  max-width: none;
  width: 100%;
}
.header-wrapper .search-form .search-form-icon {
  position: absolute;
  left: 13px;
  top: 9px;
  z-index: 1;
  width: 20px;
  height: 20px;
  pointer-events: none;
}
.content-wrapper {
  padding: 24px 20px;
}
@media (min-width: 1024px) {
  .content-wrapper {
    padding-right: 54px;
    padding-left: 54px;
  }
}

.content-wrapper .banner {
  position: relative;
  display: flex;
  align-items: center;
  min-height: 174px;
  margin-bottom: 24px;
  padding: 0 40px;
  background-color: #167BB7;
  border-radius: 8px;
}
.content-wrapper .banner .bg-image {
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
  pointer-events: none;
}

.main {
  position: relative;
  line-height: 1.5;
}

.main p {
  margin-bottom: 12px;
}

.main .sidebar {
  width: calc(100% + 15px);
  flex-shrink: 0;
  margin-right: 40px;
  position: sticky;
  top: 0;
  margin-left: -15px;
  padding: 24px 16px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, .1), 0 1px 2px rgba(0, 0, 0, .06);
}

.main .sidebar .icon-title {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding-top: 8px;
  padding-bottom: 8px;
  cursor: pointer;
}

.main .sidebar .icon-title .left-part{
  display: flex;
  align-items: center;
  order: 2;
  flex-grow: 1;
}

.main .sidebar .icon-title .chevron,
.main .sidebar .icon-title.bd-link-active-wrap .chevron.rotated {
  transform: rotate(180deg);
}

.main .sidebar .icon-title.bd-link-active-wrap .bd-toc-link {
  color: #167BB7;
}

.main .sidebar .open .icon-title .chevron,
.main .sidebar .icon-title.bd-link-active-wrap .chevron{
  transform: rotate(0);
  transition-duration: .25s;
  transform-origin: center;
}

.main .sidebar .bd-link-active-wrap  .chevron path {
  fill: #D1D5DB;
}

.main .sidebar .bd-link-active-wrap svg path {
  fill: #167BB7;
}

.main .sidebar .icon-title svg {
  width: 16px;
  order: 1;
}
.main .sidebar-nav {
  height: 100vh;
}
.main .sidebar-nav,
.main .right-side-menu {
  overflow-y: scroll;
  padding: 0 24px;
}

.main .right-side-menu {
  direction: rtl;
  padding: 24px 0 0 24px;
}

.main .right-side-menu .navbar-nav {
  direction: ltr;
}

.main .sidebar-nav::-webkit-scrollbar,
.main .right-side-menu::-webkit-scrollbar
{
  width: 8px;
}

.main .sidebar-nav::-webkit-scrollbar-track,
.main .right-side-menu::-webkit-scrollbar-track
{
  background-color: transparent;
}

.main .sidebar-nav::-webkit-scrollbar-thumb,
.main .right-side-menu::-webkit-scrollbar-thumb
{
  background-color: #F3F4F6;
  width: 6px;
  border-radius: 32px;
}

.main .sidebar-nav a.nav-link {
  transition-duration: .25s;
  transition-property: color;
}
.main .sidebar-nav a.nav-link:hover {
  color: #167BB7;
}
.main .sidebar-nav a {
  color: #6B7280;
}

.main .sidebar-nav a.bd-toc-link {
  padding-left: 12px;
  font-weight: 500;
  font-size: 14px;
  display: block;
  color: #6B7280;
  transition-duration: .25s;
  transition-property: color;
}
.main .sidebar-nav li:hover a.bd-toc-link,
.main .sidebar-nav li.active a.bd-toc-link,
.main .sidebar-nav .open a.bd-toc-link {
  color: #374151;
}
@media (min-width: 768px) {
  .main .sidebar:after {
    content: '';
    position: absolute;
    top: 30px;
    right: -12px;
    width: 13px;
    height: 24px;
    border-radius: 4px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1), 0 1px 2px rgba(0, 0, 0, 0.06);
  }
}
.sidebar-toggler {
  display: none;
}
@media (min-width: 768px) {
  .sidebar-toggler {
    display: block;
    position: absolute;
    top: 30px;
    right: -12px;
    width: 24px;
    height: 24px;
    border-radius: 4px;
    cursor: pointer;
    background-color: #F3F4F6;
    transition-duration: .25s;
    z-index: 2;
  }
  .sidebar-toggler:hover {
    background-color: #efefef;
  }
  .sidebar-toggler:after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 8px;
    height: 12px;
    transform: translate(-50%, -50%) rotate(0deg);
    background-image: url("data:image/svg+xml,%3Csvg width='8' height='12' viewBox='0 0 8 12' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M6.33337 10.6666L1.66671 5.99998L6.33337 1.33331' stroke='%23167BB7' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E%0A");
    background-size: contain;
    background-repeat: no-repeat;
    transition-duration: .25s;
  }
  .sidebar-toggler.active:after {
    transform: translate(-50%, -50%) rotate(180deg);
  }
}


pre.pygments .tok-o {
  color: #167BB7;
}

.main p code {
  color: inherit;
  font-size: inherit;
}

.main table,.main table td,.main table th {
  border: 1px solid #dedede;
  padding: 10px;
}

.main .note table,.main .note table td,.main .note table th {
  border: none;
}

.main .note .icon {
  width: 60px;
}

.main .note .icon .fa.icon-note {
  display: none;
}

.main .note .content {
  font-weight: normal;
  color: #374151;
}

.main table td.icon svg{
  width: 30px;
  height: auto;
}

.main table td.icon .title {
  display: none;
}

.main table {
  width: 100%;
  border-collapse: collapse;
  margin-bottom: 15px;
}

.main table .title {
  text-transform: uppercase;
  font-weight: 600;
  padding: 0 5px;
}

pre.pygments .tok-o {
  color: #167BB7!important;
}

.main .sidebar-nav > ul li ul {
  display: none;
  padding-left: 16px;
  padding-bottom: 8px;
  font-size: 14px;
  border-bottom: 1px solid #F3F4F6;
}

.main .sidebar-nav > ul li ul.active-list {
  display: block;
}

.main .sidebar-nav > ul li ul li a{
  display: block;
  position: relative;
  padding-left: 16px;
  font-size: 14px;
}

.main .sidebar-nav .list-item-active a {
  color: #167BB7;
}

.main .sidebar-nav > .navbar-nav  > li {
  margin-bottom: 8px;
}

.main .right-side-menu {
  position: sticky;
  top: 16px;
  height: calc(100vh - 40px);
  margin-top: 24px;
}

.main .right-side-menu > .navbar-nav {
  position: relative;
}

.sidebar-wrapper {
  margin-left: 0;
  transition-duration: .25s;
  flex-shrink: 0;
  width: calc(100% - 16px);
}
.main-wrapper {
  flex-grow: 1;
}
.bd-links-wrapper {
  flex-shrink: 0;
}
.right-side-menu ul ul {
  padding-left: 16px;
}
@media (min-width: 768px) {
  .sidebar-wrapper {
    width: 310px;
  }
  .sidebar-hide .sidebar-wrapper {
    margin-left: -280px;
  }
  .main-wrapper {
    width: calc(100% - 520px);
  }
}
@media (min-width: 1200px) {
  .main-wrapper {
    width: calc(100% - 590px);
  }
  .bd-links-wrapper {
    width: 268px;
  }
}


.main .right-side-menu > .navbar-nav:before {
  content: "In this document";
  display: block;
  margin-bottom: 8px;
  font-weight: 500;
  font-size: 14px;
  line-height: 16px;
  text-transform: uppercase;
  color: #1F2937;
}

.main .right-side-menu > ul > li > a {
  font-size: 14px;
  font-weight: 300;
  margin-bottom: 7px;
  padding: 4px 0;
}

.main .right-side-menu .nav-link {
  border: none!important;
  color: #6B7280!important;
}

.main .right-side-menu .nav-link.active{
  padding-left: 0;
  color: #167BB7!important;
  font-weight: 500;
}

.main .right-side-menu .navbar-nav {
  display: block;
}
.main nav[data-toggle=toc] .nav > li > a {
  padding-left: 0;
  transition-property: color;
  transition-duration: .25s;
}
.main nav[data-toggle=toc] .nav > li > a:focus,
.main nav[data-toggle=toc] .nav > li > a:hover {
  color: #167BB7!important;
}
.main nav[data-toggle=toc] .nav .nav > li > a:focus,
.main nav[data-toggle=toc] .nav .nav > li > a:hover,
.main nav[data-toggle=toc] .nav .nav > li > .active,
.main nav[data-toggle=toc] .nav .nav > li > .active:focus,
.main nav[data-toggle=toc] .nav .nav > li > .active:hover {
  padding-left: 0;
}
.main nav[data-toggle=toc] .nav-link.active:hover {
  padding-left: 0;
}

.main img {
  box-shadow: none;
  border-radius: 0;
  margin-bottom: 24px;
  margin-top: 10px;
  display: inline;
}

.main .note img {
  box-shadow: none;
  border-radius: 0;
  min-width: 40px;
  width: 40px;
  margin-bottom: 10px;
}

.main .imageblock img {
  height: auto;
}
.main p span.image {
  display: inline-flex;
  flex-direction: column;
  align-items: center;
  height: 16px;
  width: 20px;
  margin-left: 4px;
  margin-right: 4px;
}
.main p span.image img {
  height: 100%;
  width: 100%;
  margin-bottom: 0;
  margin-top: 0;
  box-shadow: none;
  object-fit: cover;
}

.main .listingblock, .literalblock > .content pre {
  padding: 8px 14px;
  background: #50576A;
  border-radius: 4px;
  margin-bottom: 24px;
  font-size: 14px;
  font-weight: 400;
  color: #CECECE;
}

pre.pygments {
  background: #50576A!important;
  margin-bottom: 0;
}

.main .listingblock  .tok-nt {
  color: #29A9C9;
}

.main .listingblock .tok-s {
  color: #E44C3A;
}

.main .listingblock  .tok-p {
  color: #F5FBFF;
}

.main ol {
  counter-reset: my-awesome-counter;
  list-style: none;
  color: #167BB7;
  margin-left: 20px;
  margin-bottom: 16px;
}

.main ol > li {
  position: relative;
  counter-increment: my-awesome-counter;
  font-weight: 600;
}

.main ol.arabic > li::before {
  content: counter(my-awesome-counter);
  position: absolute;
  top: -1px;
  left: -20px;
  display: flex;
  justify-content: center;
  align-items: center;
  width: 24px;
  height: 24px;
  border-radius: 50%;
  background-color: #E5E7EB;
  color: #6B7280;
  font-weight: 400;
  font-size: inherit;
}
.main ol > li::before {
}

.main ol.arabic:first-child p {
  color: #374151;
  margin-left: 10px;
  font-weight: 400;
}

.main .content-wrapper ul{
  color: #374151;
  list-style: disc;
  margin-left: 20px;
}

.main .content-wrapper ul > li ul {
  margin-left: 0;
  list-style-type: none;
}

.main .content-wrapper ul.nav-tabs{
  list-style: none;
}
.main ol ol {
  margin-left: 30px;
}
.main ol.loweralpha[type=a] > li {
  list-style-type: lower-alpha;
}
.main ol.lowerroman[type=i] > li {
  list-style-type: lower-roman;
}
.main ol li::marker {
  color: #6B7280;
}

.main h2, .main h3 {
  margin-bottom: 16px;
  padding-top: 24px;
}

.main h4 {
  margin-bottom: 16px;
  padding-top: 16px;
}

.content-wrapper h2 a, .content-wrapper h3 a, .content-wrapper h4 a {
  display: none;
  margin-left: 5px;
}

.content-wrapper h4 a svg {
  height: 14px;
  width: auto;
}

.content-wrapper h2:hover a, .content-wrapper h3:hover a, .content-wrapper h4:hover a {
  display: inline;
}

.breadcrumbs-wrapper {
  margin-bottom: 24px;
}
.breadcrumbs-list {
  display: flex;
  align-items: center;
}
.breadcrumbs-list li {
  display: flex;
  align-items: center;
}
.breadcrumbs-list li:not(:last-of-type):after {
  content: '/';
  margin-left: 6px;
  margin-right: 6px;
}
.breadcrumbs-list a {
  display: flex;
  align-items: center;
  letter-spacing: -0.025em;
  color: #374151;
}
.breadcrumbs-list a svg {
  width: 24px;
  height: 24px;
  margin-right: 4px;
}

.note table code {
  color: #374151;
}

.banner .absolute-figure {
  position: absolute;
}

.banner .absolute-figure.abstract-figure {
  right: 0;
}

.banner .absolute-figure.circle2 {
  right: 30%;
  top: 10%;
}

.banner .absolute-figure.circle3 {
  right: 15%;
  top: 10%;
}

.banner .absolute-figure.circle4 {
  left: 5%;
  top: 10%;
}

.banner .absolute-figure.circle5 {
  left: 30%;
}

.banner .absolute-figure.circle6 {
  left: 6%;
  bottom: 0;
}

.banner .absolute-figure.circle7 {
  left: 35%;
  bottom: 15%;
}

.banner .absolute-figure.circle8 {
  left: 55%;
  bottom: 0;
}

.banner .absolute-figure.circle9 {
  bottom: 0;
  right: 0;
}

.doclink {
  position: fixed;
  bottom: 0;
  padding: 0 15px 10px;
  background-color: #FBFDFF;
  z-index: 1000;
  font-size: 12px;
}

.btn-primary, .btn-primary:hover {
  background-color: #167BB7;
  border-color: #167BB7;
}

.card {
  height: 100%;
}
.card-wrapper .card-text {
  min-height: 80px;
  margin-bottom: 16px;
}

.card-wrapper .card-body {
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  padding: 1rem 0.25rem;
}

pre.pygments .tok-c1 {
  color: #29A9C9!important;
}

@media screen and (max-width: 1520px) {
  .card-wrapper .card-text {
    min-height: 110px;
  }
}

.DocSearch.DocSearch-Button {
    margin-left: 0;
    width: 100%;
    height: 38px;
    padding: 0 15px;
    background-color: transparent;
    border: 1px solid #D1D5DB;
    box-shadow: 0 1px 2px rgba(0, 0, 0, .05);
    border-radius: 6px;
    font-weight: 400;
    font-size: 14px;
    line-height: 20px;
    color: #6B7280;
}
.search-form-wrapper .DocSearch-Button-Keys {
  display: none;
}
.DocSearch-Hit-content-wrapper {
  overflow-x: inherit !important;
}
.search-form-wrapper .DocSearch-Button .DocSearch-Search-Icon {
  color: #9CA3AF;
  width: 16px;
  height: 16px;
}
.search-form-wrapper .DocSearch-Button-Placeholder {
  padding-left: 10px;
}
.oneline_with_image img {
    display: inline-block;
    height: 30px;
    margin: 0 10px;
}

.warning table td, .warning table,
.important table td, .important table {
  border: none;
}
.copy-icon {
  display: flex;
  align-items: center;
  justify-content: flex-end;
  height: 40px;
  margin: -8px -14px 8px;
  padding: 0 16px;
  background-color: #3C4356;
  border-top-left-radius: 4px;
  border-top-right-radius: 4px;
}
.copy-icon svg {
  cursor: pointer;
}
.icon-tip {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 502 502' xml:space='preserve'%3E%3Cpath d='M230.523 78.722c-35.583-.342-69.221 13.48-94.756 38.802-25.528 25.316-39.587 58.839-39.587 94.396 0 34.708 13.278 67.567 37.387 92.524 24 24.844 37.216 57.409 37.216 91.697v70.281c0 5.523 4.477 10 10 10h12.756C197.871 491.185 211.53 502 227.676 502s29.805-10.815 34.138-25.578h16.166c5.523 0 10-4.477 10-10v-70.275c0-34.627 12.99-66.961 36.576-91.044 24.522-25.04 38.027-58.133 38.027-93.185 0-35.38-13.723-68.697-38.64-93.812-24.902-25.1-58.079-39.086-93.42-39.384zM227.676 482c-4.787 0-9.076-2.17-11.936-5.578h23.872c-2.86 3.408-7.149 5.578-11.936 5.578zm40.304-25.578h-77.197v-37.125h77.197v37.125zm42.287-165.313c-27.269 27.844-42.287 65.148-42.287 105.039v3.15h-77.197v-3.156c0-39.5-15.211-77-42.832-105.593-20.488-21.208-31.771-49.133-31.771-78.629 0-30.183 11.958-58.663 33.67-80.194 21.72-21.538 50.338-33.226 80.505-33.005 61.882.521 112.228 51.301 112.228 113.197 0 29.789-11.477 57.912-32.316 79.191zM229.381 55.584c5.523 0 10-4.477 10-10V10c0-5.523-4.477-10-10-10s-10 4.477-10 10v35.584c0 5.523 4.477 10 10 10zM85.246 29.896a9.988 9.988 0 0 0 8.099 4.123 9.96 9.96 0 0 0 5.87-1.91c4.468-3.247 5.458-9.5 2.212-13.968l-7.108-9.783C91.073 3.89 84.82 2.9 80.351 6.146c-4.468 3.247-5.458 9.5-2.212 13.968l7.107 9.782zM124.729 84.239a9.988 9.988 0 0 0 8.099 4.123 9.96 9.96 0 0 0 5.87-1.91c4.468-3.246 5.458-9.5 2.212-13.968l-19.113-26.308c-3.246-4.468-9.499-5.459-13.968-2.212-4.468 3.246-5.458 9.5-2.212 13.968l19.112 26.307zM37.031 160.15l33.843 10.996a10.01 10.01 0 0 0 3.092.492c4.215 0 8.136-2.687 9.509-6.913 1.707-5.253-1.168-10.894-6.42-12.601l-33.843-10.996c-5.251-1.705-10.894 1.168-12.601 6.42-1.707 5.254 1.167 10.895 6.42 12.602zM84.808 260.51c-1.707-5.253-7.346-8.126-12.601-6.42l-33.843 10.996c-5.252 1.707-8.127 7.348-6.42 12.601 1.373 4.226 5.293 6.913 9.509 6.913a10.01 10.01 0 0 0 3.092-.492l33.843-10.996c5.252-1.708 8.126-7.349 6.42-12.602zM102.626 391.668c-4.467-3.246-10.721-2.255-13.968 2.212l-8.903 12.253c-3.246 4.468-2.256 10.722 2.212 13.968a9.952 9.952 0 0 0 5.87 1.91 9.99 9.99 0 0 0 8.099-4.123l8.903-12.253c3.246-4.467 2.256-10.72-2.213-13.967z'/%3E%3Cpath d='M134.544 347.736c-4.468-3.246-10.722-2.255-13.968 2.212l-8.845 12.175c-3.246 4.468-2.255 10.722 2.212 13.968a9.952 9.952 0 0 0 5.87 1.91 9.99 9.99 0 0 0 8.099-4.123l8.845-12.175c3.246-4.467 2.255-10.721-2.213-13.967zM338.347 336.895c-3.246-4.468-9.499-5.459-13.968-2.212-4.468 3.247-5.458 9.5-2.212 13.968l20.916 28.789a9.988 9.988 0 0 0 8.099 4.123 9.96 9.96 0 0 0 5.87-1.91c4.468-3.247 5.458-9.5 2.212-13.968l-20.917-28.79zM426.045 260.984l-33.843-10.997c-5.252-1.705-10.894 1.168-12.601 6.42-1.707 5.252 1.168 10.894 6.42 12.601l33.843 10.997a10.01 10.01 0 0 0 3.092.492c4.215 0 8.136-2.687 9.509-6.913 1.707-5.251-1.167-10.893-6.42-12.6zM471.39 130.367c-1.706-5.252-7.347-8.127-12.601-6.42l-14.678 4.769c-5.252 1.707-8.127 7.348-6.42 12.601 1.373 4.226 5.293 6.913 9.509 6.913a10.01 10.01 0 0 0 3.092-.492l14.678-4.769c5.252-1.708 8.126-7.349 6.42-12.602zM387.777 167.536a10.01 10.01 0 0 0 3.092-.492l25.994-8.446c5.252-1.707 8.127-7.348 6.42-12.601-1.707-5.252-7.347-8.127-12.601-6.42l-25.994 8.446c-5.252 1.707-8.127 7.348-6.42 12.601 1.374 4.225 5.294 6.912 9.509 6.912zM320.89 83.916a9.952 9.952 0 0 0 5.87 1.91 9.99 9.99 0 0 0 8.099-4.123l20.916-28.789c3.246-4.468 2.255-10.722-2.212-13.968-4.469-3.246-10.722-2.255-13.968 2.212l-20.916 28.789c-3.248 4.469-2.257 10.722 2.211 13.969zM288.349 135.549c-11.289-8.76-24.609-14.981-38.521-17.992-5.395-1.169-10.721 2.26-11.889 7.659-1.168 5.398 2.261 10.721 7.659 11.889 11.007 2.382 21.55 7.308 30.491 14.245a9.954 9.954 0 0 0 6.124 2.1 9.981 9.981 0 0 0 7.907-3.87c3.385-4.363 2.592-10.645-1.771-14.031zM202.914 119.066c-41.096 11.729-69.797 49.799-69.797 92.579 0 5.523 4.477 10 10 10s10-4.477 10-10c0-33.895 22.735-64.056 55.287-73.346 5.311-1.516 8.387-7.05 6.872-12.361-1.518-5.31-7.052-8.388-12.362-6.872z'/%3E%3C/svg%3E");
  width: 42px;
  height: 42px;
  background-repeat: no-repeat;
  background-position: center;
}
.main table td.icon {
  text-align: center;
}
.icon-warning {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='554.2' height='554.199' xml:space='preserve' fill='%23E44C3A'%3E%3Cpath d='M538.5 386.199 356.5 70.8a91.803 91.803 0 0 0-79.501-45.9c-32.8 0-63.1 17.5-79.5 45.9L12.3 391.6a91.793 91.793 0 0 0 0 91.8c16.4 28.4 46.7 45.9 79.5 45.9H462.4c50.7 0 91.8-41.101 91.8-91.8 0-19-5.8-36.7-15.7-51.301zm-222.2 30.7c0 21.7-16.7 38.3-39.2 38.3s-39.2-16.6-39.2-38.3V416c0-21.601 16.7-38.301 39.2-38.301S316.3 394.3 316.3 416v.899zm.9-258.199-19.4 169.4c-1.3 12.2-9.4 19.8-20.7 19.8s-19.4-7.7-20.7-19.8L237 158.6c-1.3-13.1 5.801-23 18-23h44.1c12.2.1 19.4 10 18.1 23.1z'/%3E%3C/svg%3E%0A");
  width: 40px;
  height: 39px;
  background-size: 100%;
}
.icon-important {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100'%3E%3Cg transform='scale(.521)'%3E%3Ccircle cx='96' cy='96' r='74' fill='%23E44C3A'/%3E%3Cpath d='M86 48h20l-4 72H90z' fill='%23fff'/%3E%3Ccircle cx='96' cy='140' r='10' fill='%23fff'/%3E%3C/g%3E%3C/svg%3E");
  width: 40px;
  height: 40px;
  background-size: 100%;
}
.main .admonitionblock.tip table,
.main .admonitionblock.tip table td {
  border: none;
}
/*Light box start*/

.lightbox-modal {
  display: none;
  position: fixed;
  top: 50%;
  left: 50%;
  background-color: #ebebeb;
  padding: 20px;
  transform: translate(-50%, -50%);
  z-index: 100;
  border-radius: 8px;
  max-width: 95vw;
  width: 100%;
  height: 90vh;
}
.lightbox-modal .img {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 100%;
  height: 100%;
}
.lightbox-modal .img img {
  width: 100%;
  height: 100%;
  object-fit: contain;
  margin: 0;
}
@media (max-width: 1023px) {
  .lightbox-modal {
    height: auto;
    max-width: 95vw;
  }
}
#close-ligtbox {
  position: absolute;
  right: -35px;
  top: -35px;
  display: block;
  width: 30px;
  font-size: 36px;
  border-radius: 8px;
  cursor: pointer;
  color: #fff;
}
@media (max-width: 1023px) {
  #close-ligtbox {
    right: 0;
    top: -40px;
    width: 24px;
    font-size: 28px;
  }
}
.overlay {
  display: none;
  position: fixed;
  background-color: rgba(0,0,0,.5);
  left: 0;
  top: 0;
  right: 0;
  bottom: 0;
  z-index: 99;
}
.imageblock img, .paragraph .image img {
  cursor: pointer;
}
/*Light box end*/

.ulist {
  margin-left: 10px;
}
.main ol.arabic:first-child .ulist p,
.ulist ul li p {
  margin-left: 0!important;
}

.ulist li::marker {
  font-size: 20px;
  color: #6d7176;
}
.ulist li ul {
  list-style-type: none;
}
.ulist li ul li {
  position: relative;
  padding-left: 24px;
}
.ulist li ul li:before {
  content: '';
  position: absolute;
  left: 0;
  top: 9px;
  width: 8px;
  height: 8px;
  background-color: #E5E7EB;
  border: 1px solid #9CA3AF;
  border-radius: 100%;
}
.right-side-menu ul ul li:not(:last-child) {
  margin-bottom: 5px;
}
.imageblock .title {
  margin-bottom: 24px;
}
</style>
<style>pre.pygments .hll { background-color: #49483e }
pre.pygments { background: #272822; color: #f8f8f2 }
pre.pygments .tok-c { color: #75715e } /* Comment */
pre.pygments .tok-err { color: #960050; background-color: #1e0010 } /* Error */
pre.pygments .tok-k { color: #66d9ef } /* Keyword */
pre.pygments .tok-l { color: #ae81ff } /* Literal */
pre.pygments .tok-n { color: #f8f8f2 } /* Name */
pre.pygments .tok-o { color: #f92672 } /* Operator */
pre.pygments .tok-p { color: #f8f8f2 } /* Punctuation */
pre.pygments .tok-ch { color: #75715e } /* Comment.Hashbang */
pre.pygments .tok-cm { color: #75715e } /* Comment.Multiline */
pre.pygments .tok-cp { color: #75715e } /* Comment.Preproc */
pre.pygments .tok-cpf { color: #75715e } /* Comment.PreprocFile */
pre.pygments .tok-c1 { color: #75715e } /* Comment.Single */
pre.pygments .tok-cs { color: #75715e } /* Comment.Special */
pre.pygments .tok-gd { color: #f92672 } /* Generic.Deleted */
pre.pygments .tok-ge { font-style: italic } /* Generic.Emph */
pre.pygments .tok-gi { color: #a6e22e } /* Generic.Inserted */
pre.pygments .tok-go { color: #66d9ef } /* Generic.Output */
pre.pygments .tok-gp { color: #f92672; font-weight: bold } /* Generic.Prompt */
pre.pygments .tok-gs { font-weight: bold } /* Generic.Strong */
pre.pygments .tok-gu { color: #75715e } /* Generic.Subheading */
pre.pygments .tok-kc { color: #66d9ef } /* Keyword.Constant */
pre.pygments .tok-kd { color: #66d9ef } /* Keyword.Declaration */
pre.pygments .tok-kn { color: #f92672 } /* Keyword.Namespace */
pre.pygments .tok-kp { color: #66d9ef } /* Keyword.Pseudo */
pre.pygments .tok-kr { color: #66d9ef } /* Keyword.Reserved */
pre.pygments .tok-kt { color: #66d9ef } /* Keyword.Type */
pre.pygments .tok-ld { color: #e6db74 } /* Literal.Date */
pre.pygments .tok-m { color: #ae81ff } /* Literal.Number */
pre.pygments .tok-s { color: #e6db74 } /* Literal.String */
pre.pygments .tok-na { color: #a6e22e } /* Name.Attribute */
pre.pygments .tok-nb { color: #f8f8f2 } /* Name.Builtin */
pre.pygments .tok-nc { color: #a6e22e } /* Name.Class */
pre.pygments .tok-no { color: #66d9ef } /* Name.Constant */
pre.pygments .tok-nd { color: #a6e22e } /* Name.Decorator */
pre.pygments .tok-ni { color: #f8f8f2 } /* Name.Entity */
pre.pygments .tok-ne { color: #a6e22e } /* Name.Exception */
pre.pygments .tok-nf { color: #a6e22e } /* Name.Function */
pre.pygments .tok-nl { color: #f8f8f2 } /* Name.Label */
pre.pygments .tok-nn { color: #f8f8f2 } /* Name.Namespace */
pre.pygments .tok-nx { color: #a6e22e } /* Name.Other */
pre.pygments .tok-py { color: #f8f8f2 } /* Name.Property */
pre.pygments .tok-nt { color: #f92672 } /* Name.Tag */
pre.pygments .tok-nv { color: #f8f8f2 } /* Name.Variable */
pre.pygments .tok-ow { color: #f92672 } /* Operator.Word */
pre.pygments .tok-w { color: #f8f8f2 } /* Text.Whitespace */
pre.pygments .tok-mb { color: #ae81ff } /* Literal.Number.Bin */
pre.pygments .tok-mf { color: #ae81ff } /* Literal.Number.Float */
pre.pygments .tok-mh { color: #ae81ff } /* Literal.Number.Hex */
pre.pygments .tok-mi { color: #ae81ff } /* Literal.Number.Integer */
pre.pygments .tok-mo { color: #ae81ff } /* Literal.Number.Oct */
pre.pygments .tok-sa { color: #e6db74 } /* Literal.String.Affix */
pre.pygments .tok-sb { color: #e6db74 } /* Literal.String.Backtick */
pre.pygments .tok-sc { color: #e6db74 } /* Literal.String.Char */
pre.pygments .tok-dl { color: #e6db74 } /* Literal.String.Delimiter */
pre.pygments .tok-sd { color: #e6db74 } /* Literal.String.Doc */
pre.pygments .tok-s2 { color: #e6db74 } /* Literal.String.Double */
pre.pygments .tok-se { color: #ae81ff } /* Literal.String.Escape */
pre.pygments .tok-sh { color: #e6db74 } /* Literal.String.Heredoc */
pre.pygments .tok-si { color: #e6db74 } /* Literal.String.Interpol */
pre.pygments .tok-sx { color: #e6db74 } /* Literal.String.Other */
pre.pygments .tok-sr { color: #e6db74 } /* Literal.String.Regex */
pre.pygments .tok-s1 { color: #e6db74 } /* Literal.String.Single */
pre.pygments .tok-ss { color: #e6db74 } /* Literal.String.Symbol */
pre.pygments .tok-bp { color: #f8f8f2 } /* Name.Builtin.Pseudo */
pre.pygments .tok-fm { color: #a6e22e } /* Name.Function.Magic */
pre.pygments .tok-vc { color: #f8f8f2 } /* Name.Variable.Class */
pre.pygments .tok-vg { color: #f8f8f2 } /* Name.Variable.Global */
pre.pygments .tok-vi { color: #f8f8f2 } /* Name.Variable.Instance */
pre.pygments .tok-vm { color: #f8f8f2 } /* Name.Variable.Magic */
pre.pygments .tok-il { color: #ae81ff } /* Literal.Number.Integer.Long */</style></head><body data-spy="scroll" data-target="#toc" class="book"><header class="header"><div class="header-wrapper"><div class="container-fluid"><div class="row flex-xl-nowrap"><div class="header-logo"><div class="logo"><a href="https://docs.killbill.io"><img src="https://github.com/killbill/killbill-docs/raw/v3/userguide/assets/img/logo.png" style="height:41px" alt="KillBill Docs"></a></div></div><div class="header-search"><div class="search-form-wrapper"><div id="docsearch" style="height: 43px; display: flex; align-items: center; width: 100%;"></div></div></div></div></div></div></header><main class="main"><div class="container-fluid"><div class="row flex-xl-nowrap"><div class="sidebar-wrapper"><aside class="sidebar"><nav class="sidebar-nav"><ul class="nav navbar-nav"><li><div class="icon-title"><div class="left-part"><a class="bd-toc-link main-link">Getting Started</a></div><svg class="chevron" width="11" height="6" viewBox="0 0 11 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.5024 5.70711C10.1119 6.09763 9.47871 6.09763 9.08818 5.70711L5.7953 2.41421L2.50241 5.70711C2.11188 6.09763 1.47872 6.09763 1.0882 5.70711C0.697672 5.31658 0.697672 4.68342 1.0882 4.29289L5.08819 0.292893C5.47871 -0.0976311 6.11188 -0.0976311 6.5024 0.292893L10.5024 4.29289C10.8929 4.68342 10.8929 5.31658 10.5024 5.70711Z" fill="#D1D5DB"/></svg></div><ul class="nav navbar-nav"><li><a class="nav-link" href="/latest/what_is_kill_bill.html">What is Kill Bill?</a></li><li><a class="nav-link" href="/latest/getting_started.html">Getting Started (Installation)</a></li><li><a class="nav-link" href="/latest/quick_start_with_kaui.html">Quick Start with Kaui</a></li><li><a class="nav-link" href="/latest/quick_start_with_kb_api.html">Quick Start with the Kill Bill API</a></li></ul></li><li><div class="icon-title"><div class="left-part"><a class="bd-toc-link main-link">Installation</a></div><svg class="chevron" width="11" height="6" viewBox="0 0 11 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.5024 5.70711C10.1119 6.09763 9.47871 6.09763 9.08818 5.70711L5.7953 2.41421L2.50241 5.70711C2.11188 6.09763 1.47872 6.09763 1.0882 5.70711C0.697672 5.31658 0.697672 4.68342 1.0882 4.29289L5.08819 0.292893C5.47871 -0.0976311 6.11188 -0.0976311 6.5024 0.292893L10.5024 4.29289C10.8929 4.68342 10.8929 5.31658 10.5024 5.70711Z" fill="#D1D5DB"/></svg></div><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a class="nav-link" href="/latest/stripe_plugin.html">Kill Bill + Stripe DIY</a></li><li><a class="nav-link" href="/latest/userguide_deployment.html">Going to Production</a></li><li><a class="nav-link" href="/latest/how-to-upgrade-the-database.html">Database Migrations</a></li><li><a class="nav-link" href="/latest/PostgreSQL.html">PostgreSQL Setup</a></li><li><a class="nav-link" href="https://github.com/killbill/killbill/releases" onclick="getOutboundLink('https://github.com/killbill/killbill/releases'); return false;">Release&nbsp;Notes</a></li></ul></li><li><div class="icon-title"><div class="left-part"><a class="bd-toc-link main-link">AWS</a></div><svg class="chevron" width="11" height="6" viewBox="0 0 11 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.5024 5.70711C10.1119 6.09763 9.47871 6.09763 9.08818 5.70711L5.7953 2.41421L2.50241 5.70711C2.11188 6.09763 1.47872 6.09763 1.0882 5.70711C0.697672 5.31658 0.697672 4.68342 1.0882 4.29289L5.08819 0.292893C5.47871 -0.0976311 6.11188 -0.0976311 6.5024 0.292893L10.5024 4.29289C10.8929 4.68342 10.8929 5.31658 10.5024 5.70711Z" fill="#D1D5DB"/></svg></div><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a class="nav-link" href="/latest/how-to-set-up-a-single-tier-system.html">Single-Tier Setup</a></li><li><a class="nav-link" href="/latest/how-to-set-up-a-multi-tier-system.html">Multi-Tier Setup</a></li><li><a class="nav-link" href="/latest/how-to-set-up-a-cloud-formation-system.html">CloudFormation Setup</a></li><li class="bd-sidenav-active"><a class="nav-link" href="/latest/how-to-maintain-a-single-tier-system.html">Single-Tier Maintenance</a></li><li><a class="nav-link" href="/latest/how-to-maintain-a-multi-tier-system.html">Multi-Tier Maintenance</a></li><li><a class="nav-link" href="/latest/how-to-maintain-a-cloud-formation-system.html">CloudFormation Maintenance</a></li></ul></li><li><div class="icon-title"><div class="left-part"><a class="bd-toc-link main-link">Manuals</a></div><svg class="chevron" width="11" height="6" viewBox="0 0 11 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.5024 5.70711C10.1119 6.09763 9.47871 6.09763 9.08818 5.70711L5.7953 2.41421L2.50241 5.70711C2.11188 6.09763 1.47872 6.09763 1.0882 5.70711C0.697672 5.31658 0.697672 4.68342 1.0882 4.29289L5.08819 0.292893C5.47871 -0.0976311 6.11188 -0.0976311 6.5024 0.292893L10.5024 4.29289C10.8929 4.68342 10.8929 5.31658 10.5024 5.70711Z" fill="#D1D5DB"/></svg></div><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a class="nav-link" href="/latest/userguide_subscription.html">Subscription&nbsp;Billing</a></li><li><a class="nav-link" href="/latest/userguide_payment.html">Payment Processing</a></li><li><a class="nav-link" href="/latest/userguide_kaui.html">Kaui, the Administrative&nbsp;UI</a></li><li><a class="nav-link" href="/latest/email-notification-plugin.html">Email Notification Plugin</a></li><li><a class="nav-link" href="/latest/custom-email-invoice-formatter.html">Custom Email Formatter</a></li><li><a class="nav-link" href="/latest/userguide_analytics.html">Analytics Plugin</a></li><li><a class="nav-link" href="/latest/userguide_configuration.html">Kill Bill&nbsp;Configuration</a></li><li><a class="nav-link" href="/latest/internationalization.html">Kill Bill&nbsp;Internationalization</a></li><li><a class="nav-link" href="/latest/migration_guide.html">Migrating to Kill Bill</a></li></ul></li><li><div class="icon-title"><div class="left-part"><a class="bd-toc-link main-link">Tutorials</a></div><svg class="chevron" width="11" height="6" viewBox="0 0 11 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.5024 5.70711C10.1119 6.09763 9.47871 6.09763 9.08818 5.70711L5.7953 2.41421L2.50241 5.70711C2.11188 6.09763 1.47872 6.09763 1.0882 5.70711C0.697672 5.31658 0.697672 4.68342 1.0882 4.29289L5.08819 0.292893C5.47871 -0.0976311 6.11188 -0.0976311 6.5024 0.292893L10.5024 4.29289C10.8929 4.68342 10.8929 5.31658 10.5024 5.70711Z" fill="#D1D5DB"/></svg></div><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a class="nav-link" href="/latest/plan_alignment.html">Plans Alignments</a></li><li><a class="nav-link" href="/latest/overdue.html">Overdue System</a></li><li><a class="nav-link" href="/latest/consumable_in_arrear.html">In Arrear UsageBilling</a></li><li><a class="nav-link" href="/latest/ha.html">Hierarchical Accounts</a></li><li><a class="nav-link" href="/latest/catalog-examples.html">Catalog Examples</a></li><li><a class="nav-link" href="/latest/invoice_examples.html">Invoice Examples</a></li><li><a class="nav-link" href="/latest/invoice_templates.html">Invoice Templates</a></li></ul></li><li><div class="icon-title"><div class="left-part"><a class="bd-toc-link main-link">Integration</a></div><svg class="chevron" width="11" height="6" viewBox="0 0 11 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.5024 5.70711C10.1119 6.09763 9.47871 6.09763 9.08818 5.70711L5.7953 2.41421L2.50241 5.70711C2.11188 6.09763 1.47872 6.09763 1.0882 5.70711C0.697672 5.31658 0.697672 4.68342 1.0882 4.29289L5.08819 0.292893C5.47871 -0.0976311 6.11188 -0.0976311 6.5024 0.292893L10.5024 4.29289C10.8929 4.68342 10.8929 5.31658 10.5024 5.70711Z" fill="#D1D5DB"/></svg></div><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a class="nav-link" href="http://killbill.github.io/slate" onclick="getOutboundLink('http://killbill.github.io/slate'); return false;">REST API Reference</a></li><li><a class="nav-link" href="/latest/swagger_documentation.html">Swagger UI Documentation</a></li><li><a class="nav-link" href="/latest/postman.html">Postman Integration</a></li><li><a class="nav-link" href="/latest/debugging.html">Debugging</a></li><li><a class="nav-link" href="/latest/push_notifications.html">Push Notifications</a></li><li><a class="nav-link" href="/latest/kill_bill_events.html">Kill Bill Events</a></li></ul></li><li><div class="icon-title"><div class="left-part"><a class="bd-toc-link main-link">Plugin Development</a></div><svg class="chevron" width="11" height="6" viewBox="0 0 11 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.5024 5.70711C10.1119 6.09763 9.47871 6.09763 9.08818 5.70711L5.7953 2.41421L2.50241 5.70711C2.11188 6.09763 1.47872 6.09763 1.0882 5.70711C0.697672 5.31658 0.697672 4.68342 1.0882 4.29289L5.08819 0.292893C5.47871 -0.0976311 6.11188 -0.0976311 6.5024 0.292893L10.5024 4.29289C10.8929 4.68342 10.8929 5.31658 10.5024 5.70711Z" fill="#D1D5DB"/></svg></div><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a class="nav-link" href="/latest/plugin_introduction.html">Plugin Introduction</a></li><li class="bd-sidenav-active"><a class="nav-link" href="/latest/plugin_development.html">Plugin Development</a></li><li class="bd-sidenav-active"><a class="nav-link" href="/latest/plugin_installation.html">Plugin Installation</a></li><li><a class="nav-link" href="/latest/plugin_use_cases.html">Special Plugin Use Cases</a></li><li><a class="nav-link" href="/latest/notification_plugin.html">Notification Plugins</a></li><li><a class="nav-link" href="/latest/payment_plugin.html">Payment Plugins</a></li><li><a class="nav-link" href="/latest/payment_control_plugin.html">Payment Control Plugins</a></li><li><a class="nav-link" href="/latest/invoice_plugin.html">Invoice Plugins</a></li><li><a class="nav-link" href="/latest/catalog_plugin.html">Catalog Plugins</a></li><li><a class="nav-link" href="/latest/entitlement_plugin.html">Entitlement Plugins</a></li></ul></li><li><div class="icon-title"><div class="left-part"><a class="bd-toc-link main-link">Operational Guides</a></div><svg class="chevron" width="11" height="6" viewBox="0 0 11 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.5024 5.70711C10.1119 6.09763 9.47871 6.09763 9.08818 5.70711L5.7953 2.41421L2.50241 5.70711C2.11188 6.09763 1.47872 6.09763 1.0882 5.70711C0.697672 5.31658 0.697672 4.68342 1.0882 4.29289L5.08819 0.292893C5.47871 -0.0976311 6.11188 -0.0976311 6.5024 0.292893L10.5024 4.29289C10.8929 4.68342 10.8929 5.31658 10.5024 5.70711Z" fill="#D1D5DB"/></svg></div><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a class="nav-link" href="/latest/deploy_to_kubernetes.html">Kubernetes (K8s) Deployment</a></li><li class="bd-sidenav-active"><a class="nav-link" href="/latest/user_management.html">Users, Roles, and Permissions</a></li><li><a class="nav-link" href="/latest/plugin_management.html">Plugin Management</a></li><li><a class="nav-link" href="/latest/aws-tools.html">AWS Analytics Tools</a></li></ul></li><li><div class="icon-title"><div class="left-part"><a class="bd-toc-link main-link">Client Libraries</a></div><svg class="chevron" width="11" height="6" viewBox="0 0 11 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.5024 5.70711C10.1119 6.09763 9.47871 6.09763 9.08818 5.70711L5.7953 2.41421L2.50241 5.70711C2.11188 6.09763 1.47872 6.09763 1.0882 5.70711C0.697672 5.31658 0.697672 4.68342 1.0882 4.29289L5.08819 0.292893C5.47871 -0.0976311 6.11188 -0.0976311 6.5024 0.292893L10.5024 4.29289C10.8929 4.68342 10.8929 5.31658 10.5024 5.70711Z" fill="#D1D5DB"/></svg></div><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a class="nav-link" href="/latest/java_client.html">Java</a></li><li><a class="nav-link" href="http://github.com/killbill/killbill-client-ruby" onclick="getOutboundLink('http://github.com/killbill/killbill-client-ruby'); return false;">Ruby</a></li><li><a class="nav-link" href="http://github.com/killbill/killbill-client-php" onclick="getOutboundLink('http://github.com/killbill/killbill-client-php'); return false;">PHP</a></li><li><a class="nav-link" href="http://github.com/killbill/killbill-client-js" onclick="getOutboundLink('http://github.com/killbill/killbill-client-js'); return false;">Node.js</a></li><li><a class="nav-link" href="http://github.com/killbill/killbill-client-python" onclick="getOutboundLink('http://github.com/killbill/killbill-client-python'); return false;">Python</a></li><li><a class="nav-link" href="http://github.com/killbill/kbcli" onclick="getOutboundLink('http://github.com/killbill/kbcli'); return false;">Go</a></li></ul></li><li><div class="icon-title"><div class="left-part"><a class="bd-toc-link main-link">About Kill Bill</a></div><svg class="chevron" width="11" height="6" viewBox="0 0 11 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.5024 5.70711C10.1119 6.09763 9.47871 6.09763 9.08818 5.70711L5.7953 2.41421L2.50241 5.70711C2.11188 6.09763 1.47872 6.09763 1.0882 5.70711C0.697672 5.31658 0.697672 4.68342 1.0882 4.29289L5.08819 0.292893C5.47871 -0.0976311 6.11188 -0.0976311 6.5024 0.292893L10.5024 4.29289C10.8929 4.68342 10.8929 5.31658 10.5024 5.70711Z" fill="#D1D5DB"/></svg></div><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a class="nav-link" href="/latest/demo.html">Demo</a></li><li><a class="nav-link" href="/latest/features.html">Features List</a></li><li><a class="nav-link" href="/latest/faq.html">Technical FAQs</a></li><li><a class="nav-link" href="/latest/Kill-Bill-Glossary.html">Glossary</a></li></ul></li><li><div class="icon-title"><div class="left-part"><a class="bd-toc-link main-link">Internal</a></div><svg class="chevron" width="11" height="6" viewBox="0 0 11 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.5024 5.70711C10.1119 6.09763 9.47871 6.09763 9.08818 5.70711L5.7953 2.41421L2.50241 5.70711C2.11188 6.09763 1.47872 6.09763 1.0882 5.70711C0.697672 5.31658 0.697672 4.68342 1.0882 4.29289L5.08819 0.292893C5.47871 -0.0976311 6.11188 -0.0976311 6.5024 0.292893L10.5024 4.29289C10.8929 4.68342 10.8929 5.31658 10.5024 5.70711Z" fill="#D1D5DB"/></svg></div><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a class="nav-link" href="/latest/internal_design.html">Internal Design</a></li><li><a class="nav-link" href="/latest/entitlement_subsystem.html">Entitlement Subsystem</a></li><li><a class="nav-link" href="/latest/invoice_subsystem.html">Invoice Subsystem</a></li><li><a class="nav-link" href="/latest/development.html">Development Environment</a></li></ul></li><li><div class="icon-title"><div class="left-part"><a class="bd-toc-link main-link">References</a></div><svg class="chevron" width="11" height="6" viewBox="0 0 11 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.5024 5.70711C10.1119 6.09763 9.47871 6.09763 9.08818 5.70711L5.7953 2.41421L2.50241 5.70711C2.11188 6.09763 1.47872 6.09763 1.0882 5.70711C0.697672 5.31658 0.697672 4.68342 1.0882 4.29289L5.08819 0.292893C5.47871 -0.0976311 6.11188 -0.0976311 6.5024 0.292893L10.5024 4.29289C10.8929 4.68342 10.8929 5.31658 10.5024 5.70711Z" fill="#D1D5DB"/></svg></div><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a class="nav-link" href="https://github.com/killbill/killbill-docs/tree/v3/swagger" onclick="getOutboundLink('https://github.com/killbill/killbill-docs/tree/v3/swagger'); return false;">Swagger&nbsp;API Schema</a></li><li><a class="nav-link" href="/latest/catalog.xsd">Catalog XSD Reference</a></li><li><a class="nav-link" href="/latest/overdue.xsd">Overdue XSD Reference</a></li></ul></li></ul><div class="sidebar-toggler"></div></nav><script src="https://code.jquery.com/jquery-3.6.1.min.js"></script><script>
  let $ = jQuery;
  $('.sidebar-nav .icon-title').on('click', function (e) {
    e.preventDefault();
    $('.sidebar-nav .nav.navbar-nav .nav.navbar-nav').slideUp(200);
    $('.sidebar-nav > .navbar-nav > li').removeClass('open');

    if($(this).next().is(':visible')){
      $('.sidebar-nav .nav.navbar-nav .nav.navbar-nav').slideUp(200);
      $('.sidebar-nav > .navbar-nav > li').removeClass('open');
    } else {
      $(this).parent().addClass('open');
      $(this).next().slideDown(200);
    }
  });

  let pageURL = $(location).attr("href");
  $('.nav-link').each(function() {
    if (pageURL.includes($(this).attr('href'))) {
      $(this).parent().addClass('list-item-active');
      $(this).parent().parent().addClass('active-list');
      $(this).parent().parent().prev().addClass('bd-link-active-wrap');
    }
  });
</script><a class="doclink" href="mailto:support@killbill.io">Report a doc problem</a></aside></div><div class="main-wrapper"><article class="content-wrapper"><div class="banner"><div class="bg-image"><svg class="absolute-figure circle1" width="41" height="38" viewBox="0 0 41 38" fill="none" xmlns="http://www.w3.org/2000/svg">
  <ellipse cx="12.5" cy="10.5" rx="28.5" ry="27.5" fill="white" fill-opacity="0.2"/>
</svg>
<svg class="absolute-figure circle2" width="20" height="19" viewBox="0 0 20 19" fill="none" xmlns="http://www.w3.org/2000/svg">
  <ellipse cx="10" cy="9.5" rx="10" ry="9.5" fill="white" fill-opacity="0.2"/>
</svg>
<svg class="absolute-figure circle3" width="97" height="97" viewBox="0 0 97 97" fill="none" xmlns="http://www.w3.org/2000/svg">
  <circle cx="48.5" cy="48.5" r="48.5" fill="white" fill-opacity="0.4"/>
</svg>
<svg class="absolute-figure circle4" width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
  <circle cx="7" cy="7" r="7" fill="white" fill-opacity="0.2"/>
</svg>
<svg class="absolute-figure circle5" width="65" height="23" viewBox="0 0 65 23" fill="none" xmlns="http://www.w3.org/2000/svg">
  <circle cx="32.5" cy="-9.5" r="32.5" fill="white" fill-opacity="0.2"/>
</svg>
<svg class="absolute-figure circle6" width="48" height="31" viewBox="0 0 48 31" fill="none" xmlns="http://www.w3.org/2000/svg">
  <circle cx="24" cy="24" r="24" fill="white" fill-opacity="0.2"/>
</svg>
<svg class="absolute-figure circle7" width="20" height="19" viewBox="0 0 20 19" fill="none" xmlns="http://www.w3.org/2000/svg">
  <ellipse cx="10" cy="9.5" rx="10" ry="9.5" fill="white" fill-opacity="0.2"/>
</svg>
<svg class="absolute-figure circle8" width="20" height="10" viewBox="0 0 20 10" fill="none" xmlns="http://www.w3.org/2000/svg">
  <ellipse cx="10" cy="9.5" rx="10" ry="9.5" fill="white" fill-opacity="0.2"/>
</svg>
<svg class="absolute-figure circle9" width="49" height="48" viewBox="0 0 49 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <circle cx="48.5" cy="48.5" r="48.5" fill="white" fill-opacity="0.2"/>
</svg>
<svg class="absolute-figure abstract-figure" width="703" height="174" viewBox="0 0 703 174" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M25.5 246C-96 87.7673 245.949 67.3215 475.548 64.1799C705.146 61.0384 565.01 -188.501 629.653 -188.741C694.297 -188.982 766.062 221.014 766.062 221.014L297.072 460.733C297.072 460.733 147 404.233 25.5 246Z" fill="white" fill-opacity="0.2"/>
</svg></div><h1>Catalog Examples</h1></div><div id="content"><div id="preamble"><div class="sectionbody"><div class="paragraph"><p>This document provides examples of catalogs and how they affect invoices/subscriptions.</p></div></div></div>
<div class="sect1"><h2 id="_how_to_use_this_document">How to Use This Document</h2><div class="sectionbody"><div class="paragraph"><p>Each section in this document corresponds to a particular catalog component and provides examples of catalogs that demonstrate that catalog component.</p></div>
<div class="paragraph"><p>You can try out the various examples in each section by:</p></div>
<div class="olist arabic"><ol class="arabic"><li><p>Uploading the corresponding catalog (via Kaui or <a href="https://killbill.github.io/slate/#catalog-upload-a-catalog-as-xml">Upload Catalog</a> API call)</p></li><li><p>Creating an account (via Kaui or <a href="https://killbill.github.io/slate/#account-create-an-account">Create Account</a> API call)</p></li><li><p>Creating a subscription as required (via Kaui or <a href="https://killbill.github.io/slate/#subscription-create-a-subscription">Create Subscription</a> API call)</p></li><li><p>Triggering an invoice dry-run (via Kaui or <a href="https://killbill.github.io/slate/#invoice-generate-a-dry-run-invoice">Generate Dry Run</a> API call)</p></li></ol></div></div></div>
<div class="sect1"><h2 id="_prerequisites">Prerequisites</h2><div class="sectionbody"><div class="paragraph"><p>Ensure that you have gone through the <a href="https://docs.killbill.io/latest/userguide_subscription.html#components-catalog"><em>Subscription User Guide</em></a> and are familiar with the various catalog components like products, plans, phases, and so forth.</p></div></div></div>
<div class="sect1"><h2 id="_billing_modes">Billing Modes</h2><div class="sectionbody"><div class="paragraph"><p>A catalog needs to include a <strong>Billing Mode</strong> as explained in the <a href="https://docs.killbill.io/latest/invoice_subsystem.html#_overview"><em>Invoice Subsystem</em></a> document.</p></div>
<div class="paragraph"><p>A quick summary of billing modes:</p></div>
<div class="ulist"><ul><li><p>Can be specified at the <strong>catalog</strong> level or on a <strong>per-plan</strong> basis.</p></li><li><p><strong>IN_ADVANCE</strong> indicates that each recurring subscription is charged at the <em>beginning</em> of the billing period.</p></li><li><p><strong>IN_ARREAR</strong> indicates that each recurring subscription is charged at the <em>end</em> of the billing period.</p></li></ul></div>
<div class="paragraph"><p>This section provides examples of catalogs with different billing modes. For simplicity&#8217;s sake, only catalogs with catalog-level billing modes are demonstrated below. However, the behavior is the same even when a per-plan billing mode is used.</p></div>
<div class="paragraph"><p>Also for the sake of simplicity, all the catalogs demonstrated in this section include a single product (<code>STANDARD</code>) and a single plan (<code>standard-monthly</code>) corresponding to it.</p></div>
<div class="sect2"><h3 id="_in_advance_billing_mode">IN_ADVANCE Billing Mode</h3><div class="paragraph"><p>This example uses the <a href="https://github.com/killbill/killbill-docs/tree/4671dcd9da1cf021e85629ab67e3ffb6fb553bb1/catalogs/in-advance-billing.xml">In Advance Billing</a> catalog. It specifies an <strong>IN_ADVANCE</strong> billing mode. In this case, the <code>standard-monthly</code> plan has a single <code>EVERGREEN</code> phase with a monthly recurring charge of <code>$24.95</code> (plan phases are explained in the next section).</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Action</th><th class="tableblock halign-left valign-top">Result</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a subscription on <code>2021-09-17</code> (current date)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$24.95</code> for  <code>2021-09-17</code> to <code>2021-10-17</code> since <strong>IN_ADVANCE</strong> billing is used.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-10-17</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for  <code>$24.95</code> for <code>2021-10-17</code> to <code>2021-11-17</code></p></td></tr></tbody></table></div>
<div class="sect2"><h3 id="_in_arrear_billing_mode">IN_ARREAR Billing Mode</h3><div class="paragraph"><p>This example uses the <a href="https://github.com/killbill/killbill-docs/tree/4671dcd9da1cf021e85629ab67e3ffb6fb553bb1/catalogs/in-arrear-billing.xml">In Arrear Billing</a> catalog. It specifies an <strong>IN_ARREAR</strong> billing mode. Just like the earlier catalog, the <code>standard-monthly</code> plan has a single <code>EVERGREEN</code> phase with a monthly recurring charge of <code>$24.95</code>.</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Action</th><th class="tableblock halign-left valign-top">Result</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a subscription on <code>2021-09-17</code> (current date)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Because <strong>IN_ARREAR</strong> billing mode is specified, the system does not generate an invoice (yet).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-10-17</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for  <code>$24.95</code> for <code>2021-09-17</code> to <code>2021-10-17</code></p></td></tr></tbody></table></div></div></div>
<div class="sect1"><h2 id="_plan_phases">Plan Phases</h2><div class="sectionbody"><div class="paragraph"><p>Each plan can consist of multiple phases as explained in the <a href="https://docs.killbill.io/latest/userguide_subscription.html#_plans"><em>Subscription Billing</em></a> document.</p></div>
<div class="paragraph"><p>A quick summary of plan phases:</p></div>
<div class="ulist"><ul><li><p>Can be one of the type <code>TRIAL</code>, <code>DISCOUNT</code>, <code>FIXEDTERM</code>, <code>EVERGREEN</code>.</p></li><li><p>Each phase has a <code>Duration</code>, <code>Billing Period</code>, <code>Recurring Price</code>, <code>Fixed Price</code>, and <code>Usage Sections</code>.</p></li></ul></div>
<div class="paragraph"><p>This section provides examples of catalogs that demonstrate the various plan phases.</p></div>
<div class="paragraph"><p>All the catalogs demonstrated in this section use <strong>IN_ADVANCE</strong> billing mode. Also, as before, all the catalogs include a single product (<code>STANDARD</code>) and a single plan (<code>standard-monthly</code>) corresponding to it.</p></div>
<div class="sect2"><h3 id="_no_trial_phase_and_fixed_term_phase">No Trial Phase and Fixed Term Phase</h3><div class="paragraph"><p>This example uses the  <a href="https://github.com/killbill/killbill-docs/tree/4671dcd9da1cf021e85629ab67e3ffb6fb553bb1/catalogs/fixedterm-no-trial.xml">Fixed Term No Trial</a> catalog. In this case, the <code>standard-weekly</code> plan has a single <code>FIXEDTERM</code> phase for a period of <code>6</code> weeks with a weekly recurring charge of <code>$24.95</code>. So, users will be charged <code>$24.95</code> weekly for <code>6</code> weeks, after which the fixed term ends.</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Action</th><th class="tableblock halign-left valign-top">Result</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a subscription on <code>2021-09-10</code> (current date)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$24.95</code> for <code>2021-09-10</code> to <code>2021-09-17</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-09-18</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for  <code>$24.95</code> for <code>2021-09-17</code> to <code>2021-09-24</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-10-15</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for  <code>$24.95</code> for <code>2021-10-15</code> to <code>2021-10-22</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-10-29</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">No invoice generated as the fixed term is over.</p></td></tr></tbody></table></div>
<div class="sect2"><h3 id="_no_trial_phase_and_monthly_evergreen_phase">No Trial Phase and Monthly Evergreen Phase</h3><div class="paragraph"><p>This example uses the  <a href="https://github.com/killbill/killbill-docs/tree/4671dcd9da1cf021e85629ab67e3ffb6fb553bb1/catalogs/monthly-no-trial.xml">Monthly No Trial</a> catalog. In this case, the <code>standard-monthly</code> plan has a single <code>EVERGREEN</code> phase with a monthly recurring charge of <code>$24.95</code>. So, users will be charged <code>$24.95</code> monthly in perpetuity.</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Action</th><th class="tableblock halign-left valign-top">Result</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a subscription on <code>2021-09-10</code> (current date)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$24.95</code> for <code>2021-09-10</code> to <code>2021-10-10</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-10-10</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for  <code>$24.95</code> for <code>2021-10-10</code> to <code>2021-11-10</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2022-05-10</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for  <code>$24.95</code> for <code>2022-05-10</code> to <code>2022-06-10</code></p></td></tr></tbody></table></div>
<div class="sect2"><h3 id="_trial_phase_and_monthly_evergreen_phase">Trial Phase and Monthly Evergreen Phase</h3><div class="paragraph"><p>This example uses the  <a href="https://github.com/killbill/killbill-docs/tree/4671dcd9da1cf021e85629ab67e3ffb6fb553bb1/catalogs/monthly-with-trial.xml">Monthly With Trial</a> catalog. In this case, the <code>standard-monthly</code> plan has a <code>TRIAL</code> phase of <code>10</code> days followed by an <code>EVERGREEN</code> phase with a monthly recurring charge of <code>$24.95</code>. So, users will not be charged for the first <code>10</code> days, after which they will be charged <code>$24.95</code> monthly in perpetuity.</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Action</th><th class="tableblock halign-left valign-top">Result</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a subscription on <code>2021-09-10</code> (current date)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$0</code> due to trial phase</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-09-20</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Trial phase ends so Invoice generated for <code>$24.95</code> for <code>2021-09-20</code> to <code>2021-10-20</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-10-20</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for  <code>$24.95</code> for <code>2021-10-20</code> to <code>2022-11-20</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2022-01-20</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for  <code>$24.95</code> for <code>2022-01-20</code> to <code>2022-02-20</code></p></td></tr></tbody></table></div>
<div class="sect2"><h3 id="_fixed_and_recurring_price_evergreen_phase">Fixed and Recurring Price Evergreen Phase</h3><div class="paragraph"><p>This example uses the  <a href="https://github.com/killbill/killbill-docs/blob/d7f8891546850dcb8767041c556ef04f589746ca/catalogs/fixed-and-recurring-price-evergreen-phase.xml">Fixed and Recurring Price Evergreen Phase</a> catalog. In this case, the <code>standard-monthly</code> plan has a single <code>EVERGREEN</code> phase. It has a <em>fixed price</em> of <code>$50</code> and a <em>recurring charge</em> of <code>$24.95</code>. So, users will be charged <code>$74.95</code> (fixed and recurring price) for the first month. After that, they will be charged a recurring price of <code>$24.95</code> monthly in perpetuity.</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Action</th><th class="tableblock halign-left valign-top">Result</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a subscription on <code>2021-09-13</code> (current date)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$74.95</code> for <code>2021-09-13</code> to <code>2021-10-13</code> (Fixed price as well as recurring price)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-10-13</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$24.95</code> for <code>2021-10-13</code> to <code>2021-11-13</code> (only recurring price)</p></td></tr></tbody></table></div>
<div class="sect2"><h3 id="_discount_phase_and_evergreen_phase">Discount Phase and Evergreen Phase</h3><div class="paragraph"><p>This example uses the  <a href="https://github.com/killbill/killbill-docs/tree/4671dcd9da1cf021e85629ab67e3ffb6fb553bb1/catalogs/discount-and-evergreen.xml">Discount and Evergreen</a> catalog. In this case, the <code>standard-monthly</code> plan has a <code>DISCOUNT</code> phase of <code>3</code> months (with a monthly charge of <code>$4.95</code>) followed by an <code>EVERGREEN</code> phase with a monthly recurring charge of <code>$24.95</code>. So, users will be charged <code>$4.95</code> (discounted price) for the first <code>3</code> months. After that, they will be charged a recurring price of <code>$24.95</code> monthly in perpetuity.</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Action</th><th class="tableblock halign-left valign-top">Result</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a subscription on <code>2021-09-15</code> (current date)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$4.95</code> due to <code>DISCOUNT</code> phase</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-10-15</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for  <code>$4.95</code> for <code>2021-10-15</code> to <code>2021-11-15</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-12-15</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Discount phase ends, invoice generated for  <code>$24.95</code> for <code>2021-12-15</code> to <code>2022-01-15</code></p></td></tr></tbody></table></div></div></div>
<div class="sect1"><h2 id="_catalog_with_multiple_plans">Catalog with Multiple Plans</h2><div class="sectionbody"><div class="paragraph"><p>A catalog can contain multiple products.  Each product can be associated with multiple plans. Each plan can, in turn, have multiple phases (trial, discount, etc.).</p></div>
<div class="paragraph"><p>This section provides examples of catalogs that include multiple products and plans.</p></div>
<div class="sect2"><h3 id="_catalog_with_monthly_plan_and_annual_plan">Catalog with Monthly Plan and Annual Plan</h3><div class="paragraph"><p>This example uses the  <a href="https://github.com/killbill/killbill-docs/tree/4671dcd9da1cf021e85629ab67e3ffb6fb553bb1/catalogs/monthly-and-annual-plan.xml">Monthly and Annual Plan</a> catalog.</p></div>
<div class="paragraph"><p>Just like the catalogs explained above, this catalog has only one product (<code>Standard</code>). However, it has multiple plans that correspond to the <code>Standard</code> product as follows:</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 33.3333%;"><col style="width: 33.3333%;"><col style="width: 33.3334%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Plan Name</th><th class="tableblock halign-left valign-top">Product</th><th class="tableblock halign-left valign-top">Plan Description</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">standard_monthly</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Single <code>EVERGREEN</code> phase with a monthly recurring charge of <code>$24.95</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">standard_annual</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Single <code>EVERGREEN</code> phase with an annual recurring charge of <code>$275</code></p></td></tr></tbody></table>
<div class="paragraph"><p>The following table lists the actions and their results:</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Action</th><th class="tableblock halign-left valign-top">Result</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a subscription for the <code>standard-monthly</code> plan on <code>2021-09-17</code> (current date)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$24.95</code> corresponding to the <code>standard-monthly</code> plan</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-10-17</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$24.95</code> for <code>2021-10-17</code> to <code>2021-11-17</code> corresponding to the <code>standard-monthly</code> plan</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a subscription for the <code>standard-annual</code> plan on <code>2021-09-17</code> (current date)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$275</code> corresponding to the <code>standard-annual</code> plan</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-10-17</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$24.95</code> for <code>2021-10-17</code> to <code>2021-11-17</code> corresponding to the <code>standard-monthly</code> plan</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2022-09-17</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated with two invoice items corresponding to both plans for <code>$299.95</code>.</p></td></tr></tbody></table></div>
<div class="sect2"><h3 id="_catalog_with_add_on_plan">Catalog with Add-on plan</h3><div class="paragraph"><p>This section uses the <a href="https://github.com/killbill/killbill-docs/blob/d7f8891546850dcb8767041c556ef04f589746ca/catalogs/monthly-no-trial-with-addon.xml">Monthly No Trial With Add-on</a> catalog.</p></div>
<div class="paragraph"><p>It has a <code>BASE</code> product and <code>ADD_ON</code> product as follows:</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Product</th><th class="tableblock halign-left valign-top">Category</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Base</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">RemoteControl</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Add_on</p></td></tr></tbody></table>
<div class="paragraph"><p>It has two plans corresponding to both products as follows:</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 33.3333%;"><col style="width: 33.3333%;"><col style="width: 33.3334%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Plan Name</th><th class="tableblock halign-left valign-top">Product</th><th class="tableblock halign-left valign-top">Plan Description</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">standard-monthly</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Single <code>EVERGREEN</code> phase with a monthly recurring charge of <code>$24.95</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">remotecontrol-monthly</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">RemoteControl</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Single <code>EVERGREEN</code> phase with a monthly recurring charge of <code>$17.95</code></p></td></tr></tbody></table>
<div class="paragraph"><p>The following table lists the actions and their results:</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Action</th><th class="tableblock halign-left valign-top">Result</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a subscription corresponding to the <code>standard_monthly</code> plan on <code>2021-09-15</code> (current date)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$24.95</code> corresponding to the <code>standard-monthly</code> plan</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-10-15</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$24.95</code> for <code>2021-10-15</code> to <code>2021-11-15</code> corresponding to the <code>standard-monthly</code> plan</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Add the <code>remotecontrol-monthly</code> add-on to the existing subscription  on <code>2021-09-15</code> (current date)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$17.95</code> corresponding to the <code>remotecontrol-monthly</code> plan</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-10-15</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$42.90</code> for <code>2021-10-15</code> to <code>2021-11-15</code> corresponding to both plans.</p></td></tr></tbody></table></div></div></div>
<div class="sect1"><h2 id="_billing_alignment_rules">Billing Alignment Rules</h2><div class="sectionbody"><div class="paragraph"><p>Another important section in the catalog is the <a href="https://docs.killbill.io/latest/userguide_subscription.html#_billing_alignment_rules">Billing Alignment Rules</a> section.</p></div>
<div class="paragraph"><p>A brief summary of billing alignment rules:</p></div>
<div class="ulist"><ul><li><p>The "Billing Alignment Rules" section specifies whether customers are billed at the account level, subscription level, or subscription bundle level.</p></li><li><p>If the catalog specifies <code>ACCOUNT</code> billing alignment, all the subscriptions belonging to the account are aligned and invoiced with the <em>Bill Cycle Day (BCD)</em> that was specified when the account was created.</p></li><li><p>If the catalog specifies <code>SUBSCRIPTION</code> billing alignment, each subscription is invoiced as per its bill date.</p></li><li><p>If the catalog specifies <code>BUNDLE</code> billing alignment, all the subscriptions within a bundle are aligned and invoiced on the same day.</p></li></ul></div>
<div class="paragraph"><p>This section provides examples of catalogs with different billing alignment rules.</p></div>
<div class="sect2"><h3 id="_account_billing_alignment">Account Billing Alignment</h3><div class="paragraph"><p>When <code>ACCOUNT</code> billing alignment is specified in the catalog, the billing cycle of all the subscriptions are aligned with the <code>BCD</code> of the account. Note that this is the default billing alignment, so even when billing alignment rules are not explicitly specified in a catalog, it defaults to <code>ACCOUNT</code>.</p></div>
<div class="paragraph"><p>This example uses the <a href="https://github.com/killbill/killbill-docs/tree/4671dcd9da1cf021e85629ab67e3ffb6fb553bb1/catalogs/account-billing-alignment.xml">Account Billing Alignment</a> catalog. It specifies <code>ACCOUNT</code> billing alignment.</p></div>
<div class="paragraph"><p>For simplicity&#8217;s sake, this catalog includes a single product (<code>STANDARD</code>) and a single plan (<code>standard-monthly</code>) corresponding to it.</p></div>
<div class="sect3"><h4 id="_case_1_account_with_no_bcd">Case 1: Account with No BCD</h4><div class="paragraph"><p>If no BCD is specified with the account, it defaults to the first bill date of the first subscription.</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Action</th><th class="tableblock halign-left valign-top">Result</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a new account. Leave BCD field empty</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Account created, BCD is blank.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a subscription on <code>2021-09-16</code> (current date)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$24.95</code> for <code>2021-09-16</code> to <code>2021-10-16</code>. BCD set to <code>16</code> (Since subscription is created on 16th)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-10-16</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$24.95</code> for <code>2021-10-16</code> to <code>2021-11-16</code></p></td></tr></tbody></table></div>
<div class="sect3"><h4 id="_case_2_account_with_bcd">Case 2: Account with BCD</h4><div class="paragraph"><p>If a BCD is specified with the account, the subscriptions are invoiced on the specified day. If the start date of a subscription is different from the BCD, the first invoice is prorated. All subsequent invoices are aligned with the BCD.</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Action</th><th class="tableblock halign-left valign-top">Result</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a new account. Specify BCD as <code>25</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Account created with BCD set to <code>25</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a subscription on <code>2021-09-16</code> (current date)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$7.24</code> for <code>2021-09-16</code> to <code>2021-09-25</code> (prorated)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-09-25</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$24.95</code> for <code>2021-09-25</code> to <code>2021-10-25</code></p></td></tr></tbody></table></div>
<div class="sect3"><h4 id="_case_3_account_with_no_bcd_and_multiple_subscriptions_on_different_days">Case 3: Account with No BCD and Multiple Subscriptions on Different Days</h4><div class="paragraph"><p>Even if there are multiple subscriptions associated with an account, all the subscriptions are aligned with the BCD. If the BCD is not explicitly set, it
defaults to the first bill date of the first subscription. All subsequent subscriptions use this BCD.</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Action</th><th class="tableblock halign-left valign-top">Result</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a new account. Leave BCD field empty</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Account created, BCD is blank.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a subscription on <code>2021-09-17</code> (current date)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$24.95</code> for <code>2021-09-17</code> to <code>2021-10-17</code>. BCD set to <code>17</code> (Since subscription is created on 17th)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a subscription, with date of <code>2021-09-25</code> (future date)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">No invoice is generated as a future date is specified</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-09-25</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$18.30</code> for <code>2021-09-25</code> to <code>2021-10-17</code> (Prorated since BCD is 17)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-10-17</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated with two invoice items corresponding to both subscriptions for <code>$49.90</code>.</p></td></tr></tbody></table></div>
<div class="sect3"><h4 id="_case_4_account_with_bcd_multiple_subscriptions_on_different_days">Case 4: Account with BCD, Multiple Subscriptions on Different Days</h4><div class="paragraph"><p>If there is a BCD specified with the account, all subscriptions use this BCD irrespective of the subscription creation day.</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Action</th><th class="tableblock halign-left valign-top">Result</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a new account. Specify BCD as <code>25</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Account created with BCD set to <code>25</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a subscription on <code>2021-09-17</code> (current date)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$6.44</code> for <code>2021-09-17</code> to <code>2021-09-25</code> (Prorated since BCD is 25)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-09-25</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$24.95</code> for <code>2021-09-25</code> to <code>2021-10-25</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a subscription on <code>2021-09-30</code> (future date)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">No invoice is generated as a future date is specified</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-09-25</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$24.95</code> for <code>2021-09-25</code> to <code>2021-10-25</code>  (Second subscription not yet active)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-09-30</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$20.79</code> for <code>2021-09-30</code> to <code>2021-10-25</code> (Prorated since BCD is 25)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-10-25</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated with two invoice items corresponding to both subscriptions for <code>$49.90</code>.</p></td></tr></tbody></table></div></div>
<div class="sect2"><h3 id="_subscription_billing_alignment">Subscription Billing Alignment</h3><div class="paragraph"><p>When <code>SUBSCRIPTION</code> billing alignment is specified in the catalog, each subscription is invoiced separately as per its bill date.</p></div>
<div class="admonitionblock note"><table><tr><td class="icon"><div class="title">Note</div></td><td class="content"><strong>Note:</strong> <code>SUBSCRIPTION</code> billing alignment applies even for subscriptions that are part of the same subscription bundle. So, if a subscription bundle consists of a base plan and an add-on plan, the add-on plan is invoiced as per its own date and is NOT aligned with the base subscription billing date.</td></tr></table></div>
<div class="paragraph"><p>This example uses the <a href="https://github.com/killbill/killbill-docs/tree/4671dcd9da1cf021e85629ab67e3ffb6fb553bb1/catalogs/subscription-billing-alignment.xml">Subscription Billing Alignment</a> catalog. It specifies <code>SUBSCRIPTION</code> billing alignment.</p></div>
<div class="paragraph"><p>It has only one product (<code>Standard</code>). However, it has multiple plans corresponding to the <code>Standard</code> product as follows:</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 33.3333%;"><col style="width: 33.3333%;"><col style="width: 33.3334%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Plan Name</th><th class="tableblock halign-left valign-top">Product</th><th class="tableblock halign-left valign-top">Plan Description</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">standard-monthly</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Single <code>EVERGREEN</code> phase with a monthly recurring charge of <code>$24.95</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">standard-annual</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Single <code>EVERGREEN</code> phase with an annual recurring charge of <code>$275</code></p></td></tr></tbody></table>
<div class="paragraph"><p>The following table lists the actions and their results:</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Action</th><th class="tableblock halign-left valign-top">Result</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a new account. Specify BCD as <code>25</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Account created with BCD set to <code>25</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a subscription for the <code>standard-monthly</code> plan on <code>2021-09-17</code> (current date)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$24.95</code> for <code>2021-09-17</code> to <code>2021-10-17</code> (BCD is ignored, subscription is billed as per its creation date)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-10-17</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$24.95</code> for <code>2021-10-17</code> to <code>2021-11-17</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a subscription for the <code>standard-annual</code> plan with date of <code>2021-09-30</code> (future date)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">No invoice is generated as a future date is specified</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-09-30</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$275</code> for <code>2021-09-30</code> to <code>2022-09-30</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-10-17</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$24.95</code> for <code>2021-10-17</code> to <code>2021-11-17</code> corresponding to <code>standard-monthly</code> plan</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2022-09-30</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$275</code> for <code>2022-09-30</code> to <code>2023-09-30</code> corresponding to <code>standard-annual</code> plan</p></td></tr></tbody></table></div>
<div class="sect2"><h3 id="_bundle_billing_alignment">Bundle Billing Alignment</h3><div class="paragraph"><p>When <code>BUNDLE</code> billing alignment is specified in the catalog, all subscriptions in a bundle are invoiced together. The bill day is derived from the first bill date of the first subscription.</p></div>
<div class="admonitionblock note"><table><tr><td class="icon"><div class="title">Note</div></td><td class="content"><strong>Note:</strong> <code>BUNDLE</code> billing alignment applies only to subscriptions within a single bundle. This type of billing alignment does not affect subscriptions across different bundles. So, when multiple subscriptions are created in different bundles, each subscription is still billed as per its creation date.</td></tr></table></div>
<div class="paragraph"><p>This example uses the  <a href="https://github.com/killbill/killbill-docs/tree/4671dcd9da1cf021e85629ab67e3ffb6fb553bb1/catalogs/bundle-billing-alignment.xml">Bundle Billing Alignment</a> catalog. It specifies <code>BUNDLE</code> billing alignment.</p></div>
<div class="paragraph"><p>It has a <code>BASE</code> and an <code>ADD_ON</code> product as follows:</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Product</th><th class="tableblock halign-left valign-top">Category</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Base</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">RemoteControl</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Add_on</p></td></tr></tbody></table>
<div class="paragraph"><p>It has two plans corresponding to both products as follows:</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 33.3333%;"><col style="width: 33.3333%;"><col style="width: 33.3334%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Plan Name</th><th class="tableblock halign-left valign-top">Product</th><th class="tableblock halign-left valign-top">Plan Description</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">standard-monthly</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Single <code>EVERGREEN</code> phase with a monthly recurring charge of <code>$24.95</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">remotecontrol-monthly</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">RemoteControl</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Single <code>EVERGREEN</code> phase with a monthly recurring charge of <code>$17.95</code></p></td></tr></tbody></table>
<div class="paragraph"><p>The following table lists the actions and their results:</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Action</th><th class="tableblock halign-left valign-top">Result</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a new account. Specify BCD as <code>25</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Account created with BCD set to <code>25</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a subscription for the <code>standard-monthly</code> plan on <code>2021-09-20</code> (current date)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$24.95</code> for <code>2021-09-20</code> to <code>2021-10-20</code> (BCD is ignored, subscription is billed as per its creation date)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-10-20</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$24.95</code> for <code>2021-10-20</code> to <code>2021-11-20</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Add the <code>remotecontrol-monthly</code> add-on to the existing subscription with date of <code>2021-09-30</code> (future date)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">No invoice is generated as a future date is specified</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-09-30</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$11.97</code> for <code>2021-09-30</code> to <code>2021-10-20</code> corresponding to the <code>remotecontrol-monthly</code> plan (Prorated since <code>BUNDLE</code> billing alignment is used)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-10-20</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$42.90</code> for <code>2021-10-20</code> to <code>2021-11-20</code> corresponding to both plans</p></td></tr></tbody></table></div></div></div>
<div class="sect1"><h2 id="_subscription_alignment_rules">Subscription Alignment Rules</h2><div class="sectionbody"><div class="paragraph"><p>The <a href="https://docs.killbill.io/latest/userguide_subscription.html#_subscription_alignment_rules"><em>Subscription Alignment Rules</em></a> section in the catalog can be used to specify rules that are useful for advanced use cases. This section explains some of these rules.</p></div>
<div class="sect2"><h3 id="_plan_creation_addon_phase_alignment">Plan Creation Addon Phase Alignment</h3><div class="paragraph"><p>The <a href="https://docs.killbill.io/latest/userguide_subscription.html#_subscription_alignment_rules">plan creation addon phase alignment</a> rules specify how the phases of an addon subscription <em>align</em> with the phases of the base subscription.</p></div>
<div class="paragraph"><p>A quick summary of plan creation phase alignment rules:</p></div>
<div class="ulist"><ul><li><p>A rule specifies the name of an addon product and how its phases should align with the phases of the base product.</p></li><li><p>There are two possible values for phase alignment, <code>START_OF_BUNDLE</code> and <code>START_OF_SUBSCRIPTION</code>.</p></li><li><p><code>START_OF_BUNDLE</code> causes the phases of the add-on to start on the date when the base plan was first created. This causes the phases of add-on subscription to align with the phases of the base subscription (provided the phases are of the same length)</p></li><li><p><code>START_OF_SUBSCRIPTION</code> causes the phases of the add-on subscription to start with the add-on subscription irrespective of the base subscription.</p></li></ul></div>
<div class="paragraph"><p>This example uses the  <a href="https://github.com/killbill/killbill-docs/blob/d7f8891546850dcb8767041c556ef04f589746ca/catalogs/plan-creation-addon-phase-alignment.xml">Plan Creation Addon Phase Alignment</a> catalog.</p></div>
<div class="paragraph"><p>It has a <code>BASE</code> product and two <code>ADD_ON</code> products as follows:</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Product</th><th class="tableblock halign-left valign-top">Category</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Base</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">RemoteControl</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Add_on</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">OilSlick</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Add_on</p></td></tr></tbody></table>
<div class="paragraph"><p>It has the following plans corresponding to the products:</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 33.3333%;"><col style="width: 33.3333%;"><col style="width: 33.3334%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Plan Name</th><th class="tableblock halign-left valign-top">Product</th><th class="tableblock halign-left valign-top">Plan Description</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">standard-monthly</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><code>TRIAL</code> phase of <code>10</code> days followed by an <code>EVERGREEN</code> phase with a monthly recurring charge of <code>$25</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">remotecontrol-monthly</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">RemoteControl</p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><code>TRIAL</code> phase of <code>10</code> days followed by an <code>EVERGREEN</code> phase with a monthly recurring charge of <code>$15</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">oilslick-monthly</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">OilSlick</p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><code>TRIAL</code> phase of <code>10</code> days followed by an <code>EVERGREEN</code> phase with a monthly recurring charge of <code>$10</code></p></td></tr></tbody></table>
<div class="paragraph"><p>It specifies the following add-on phase alignment rules:</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Predicate</th><th class="tableblock halign-left valign-top">Alignment</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">product=RemoteControl</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">START_OF_SUBSCRIPTION</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">product=OilSlick</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">START_OF_BUNDLE</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">; (Anything else)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">START_OF_BUNDLE</p></td></tr></tbody></table>
<div class="sect3"><h4 id="_rule_1_if_productremotecontrol_alignmentstart_of_subscription">Rule 1: If product=RemoteControl, alignment=START_OF_SUBSCRIPTION</h4><div class="paragraph"><p>This rule specifies that if the <code>RemoteControl</code> add-on is added to a base subscription, its phases should start on the date that the the add-on subscription is added irrespective of the base subscription.</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Action</th><th class="tableblock halign-left valign-top">Result</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a subscription corresponding to the <code>standard-monthly</code> plan on <code>2021-09-23</code> (current date)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$0</code> (since subscription is in trial phase)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-10-03</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$25</code> for <code>2021-10-03</code> to <code>2021-11-03</code> (Trial phase ends)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Add the <code>remotecontrol-monthly</code> add-on to the existing subscription with date <code>2021-09-30</code> (future date)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">No invoice is generated as a future date is specified</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-09-30</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$0</code> corresponding to the <code>remotecontrol-monthly</code> plan (since the subscription is in trial phase)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-10-03</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated with only one invoice item corresponding to  <code>standard-monthly</code> plan. Since <code>RemoteControl</code> uses <code>START_OF_SUBSCRIPTION</code> alignment rule, its phases start on the day the subscription starts (<code>2021-09-30</code>). So, <code>remotecontrol-monthly</code> is still in <code>TRIAL</code> phase and does not have an invoice entry.</p></td></tr></tbody></table></div>
<div class="sect3"><h4 id="_rule_2_if_productoilslick_alignmentstart_of_bundle">Rule 2: If product=OilSlick, alignment=START_OF_BUNDLE</h4><div class="paragraph"><p>This rule specifies that if the <code>OilSlick</code> add-on is added to a base subscription, its phases should start on the date of the base subscription.</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Action</th><th class="tableblock halign-left valign-top">Result</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a subscription corresponding to the <code>standard-monthly</code> plan on <code>2021-09-23</code> (current date)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$0</code> (since subscription is in trial phase)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-10-03</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$25</code> for <code>2021-10-03</code> to <code>2021-11-03</code> (Trial phase ends)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Add the <code>oilslick-monthly</code> add-on to the existing subscription with date <code>2021-09-30</code> (future date)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">No invoice is generated as a future date is specified</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-09-30</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$0</code> corresponding to the <code>oilslick-monthly</code> plan (since subscription is in trial phase)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-10-03</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated with two invoice items corresponding to <code>standard-monthly</code> and <code>oilslick-monthly</code> plans. Since
 <code>OilSlick</code> uses <code>START_OF_BUNDLE</code> alignment rule, its phases start on the day the base subscription starts (<code>2021-09-23</code>). So, <code>TRIAL</code> phase ends on <code>2021-10-03</code> and an invoice item is created.</p></td></tr></tbody></table></div></div>
<div class="sect2"><h3 id="_plan_cancellation_timing">Plan Cancellation Timing</h3><div class="paragraph"><p>The <a href="https://docs.killbill.io/latest/userguide_subscription.html#_plan_cancellation_timing">plan cancellation timing</a> rules specify how the billing policy is affected when a plan is canceled.</p></div>
<div class="paragraph"><p>A quick summary of plan cancellation rules:</p></div>
<div class="ulist"><ul><li><p>A rule specifies one of <code>productCategory</code>, <code>billingPeriod</code>,<code>priceList</code>, <code>phaseType</code> and its cancellation <code>policy</code>.</p></li><li><p>There are two possible values for cancellation policy, <code>END_OF_TERM</code> and <code>IMMEDIATE</code>.</p></li><li><p><code>END_OF_TERM</code> causes the cancellation to be applied at the end of the billing period. This type of cancellation rule avoids generating credits.</p></li><li><p><code>IMMEDIATE</code> causess the cancellation to be applied immediately. This type of cancellation rule results in a credit being generated corresponding to the balance of the subscription that has been paid for but not used.</p></li><li><p>The cancellation policy specified here is the <strong>default</strong> cancellation policy. This is applicable only in the case when an explicit cancellation policy is not specified (via Kaui or API call).</p></li></ul></div>
<div class="admonitionblock note"><table><tr><td class="icon"><div class="title">Note</div></td><td class="content"><strong>Note:</strong>
The cancellation policy specified in this section applies only to <em>billing</em>. The cancellation policy for entitlements can be specified explicitly via Kaui or an API call. It defaults to <em>immediate</em> as explained in the <a href="https://docs.killbill.io/latest/userguide_subscription.html#components-entitlement"><em>Subscription Billing</em></a> document.</td></tr></table></div>
<div class="paragraph"><p>This example uses the  <a href="https://github.com/killbill/killbill-docs/blob/d7f8891546850dcb8767041c556ef04f589746ca/catalogs/plan-cancellation-timing.xml">Plan Cancellation Timing</a> catalog.</p></div>
<div class="paragraph"><p>It has the following products/plans:</p></div>
<div class="sect3"><h4 id="_products">Products</h4><table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Product</th><th class="tableblock halign-left valign-top">Category</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Base</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">RemoteControl</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Add_on</p></td></tr></tbody></table></div>
<div class="sect3"><h4 id="_plans">Plans</h4><table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 33.3333%;"><col style="width: 33.3333%;"><col style="width: 33.3334%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Plan Name</th><th class="tableblock halign-left valign-top">Product</th><th class="tableblock halign-left valign-top">Plan Description</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">standard-monthly</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Single <code>EVERGREEN</code> phase with a monthly recurring charge of <code>$25</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">remotecontrol-monthly</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">RemoteControl</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Single <code>EVERGREEN</code> phase with a monthly recurring charge of <code>$15</code></p></td></tr></tbody></table>
<div class="paragraph"><p>It specifies the following plan cancellation rules:</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Predicate</th><th class="tableblock halign-left valign-top">Cancellation Policy</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">productCategory=BASE</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">END_OF_TERM</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">productCategory=ADD_ON</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">IMMEDIATE</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">; (anything else)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">END_OF_TERM</p></td></tr></tbody></table></div>
<div class="sect3"><h4 id="_rule_1_if_productcategorybase_cancellation_policyend_of_term">Rule 1: If productCategory=BASE, cancellation policy=END_OF_TERM</h4><div class="paragraph"><p>This rule specifies that if the category of a product is <code>BASE</code>  product, cancellation should should occur at the end of the billing period.</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Action</th><th class="tableblock halign-left valign-top">Result</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a subscription for the <code>standard-monthly</code> plan on <code>2021-09-29</code> (current date)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$25</code> for <code>2021-09-29</code> to <code>2021-10-29</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Cancel subscription (specify default policy)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice with credit is NOT generated (Since <code>BASE</code> product category uses <code>END_OF_TERM</code> cancellation policy)</p></td></tr></tbody></table></div>
<div class="sect3"><h4 id="_rule_2_if_productcategoryadd_on_cancellation_policyimmediate">Rule 2: If productCategory=ADD_ON, cancellation policy=IMMEDIATE</h4><div class="paragraph"><p>This rule specifies that if the category of a product is <code>ADD_ON</code>  product, cancellation should should occur immediately.</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Action</th><th class="tableblock halign-left valign-top">Result</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a subscription for the <code>standard-monthly</code> plan on <code>2021-09-29</code> (current date)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$25</code> for <code>2021-09-29</code> to <code>2021-10-29</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Add the <code>remotecontrol-monthly</code> add-on to the existing subscription on <code>2021-09-29</code> (current date)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$15</code> for <code>2021-09-29</code> to <code>2021-10-29</code> corresponding to  <code>remotecontrol-monthly</code> plan</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Cancel add-on subscription (specify default policy)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">An invoice is generated with a credit of <code>$15</code>(Since <code>ADDON</code> product uses <code>IMMEDIATE</code> cancellation policy)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Cancel base subscription (specify default policy)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice with credit is NOT generated  (Since <code>BASE</code> product  uses <code>END_OF_TERM</code> cancellation policy)</p></td></tr></tbody></table></div></div>
<div class="sect2"><h3 id="_plan_change_timing">Plan Change Timing</h3><div class="paragraph"><p>The <a href="https://docs.killbill.io/latest/userguide_subscription.html#_plan_change_timing">plan change timing</a> rules specify how the system should behave when a subscription plan is changed.</p></div>
<div class="paragraph"><p>A quick summary of plan change rules:</p></div>
<div class="ulist"><ul><li><p>A rule specifies one of <code>phaseType</code>,  <code>fromProduct</code>/<code>toProduct</code>, <code>fromProductCategory</code>/ <code>toProductCategory</code>, <code>fromBillingPeriod</code>/ <code>toBillingPeriod</code>, <code>fromPriceList</code>/<code>toPriceList</code> and its change <code>policy</code>.</p></li><li><p>There are three possible values for change policy, <code>END_OF_TERM</code>,  <code>IMMEDIATE</code> and <code>ILLEGAL</code>.</p></li><li><p><code>END_OF_TERM</code> specifies that the plan change should happen at the end of the current billing period.</p></li><li><p><code>IMMEDIATE</code> specifies that the plan change should happen immediately.</p></li><li><p><code>ILLEGAL</code> specifies that the plan change is not allowed.</p></li></ul></div>
<div class="paragraph"><p>This example uses the  <a href="https://github.com/killbill/killbill-docs/blob/d7f8891546850dcb8767041c556ef04f589746ca/catalogs/plan-change-timing.xml">Plan Change Timing</a> catalog.</p></div>
<div class="paragraph"><p>It has the following products/plans:</p></div>
<div class="sect3"><h4 id="_products_2">Products</h4><table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Product</th><th class="tableblock halign-left valign-top">Category</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Base</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Sports</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Base</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Super</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Base</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Premium</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Base</p></td></tr></tbody></table></div>
<div class="sect3"><h4 id="_plans_2">Plans</h4><table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 33.3333%;"><col style="width: 33.3333%;"><col style="width: 33.3334%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Plan Name</th><th class="tableblock halign-left valign-top">Product</th><th class="tableblock halign-left valign-top">Plan Description</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">standard-monthly</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><code>TRIAL</code> phase of <code>30</code> days followed by an <code>EVERGREEN</code> phase with a monthly recurring charge of <code>$100</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">sports-monthly</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Sports</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Single <code>EVERGREEN</code> phase with a monthly recurring charge of <code>$500</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">super-monthly</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Super</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Single <code>EVERGREEN</code> phase with a monthly recurring charge of <code>$1000</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">premium-monthly</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Premium</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Single <code>EVERGREEN</code> phase with a monthly recurring charge of <code>$2000</code></p></td></tr></tbody></table>
<div class="paragraph"><p>It specifies the following plan cancellation rules:</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Predicate</th><th class="tableblock halign-left valign-top">Change Policy</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">phaseType=TRIAL</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">IMMEDIATE</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">fromProduct=Sports and toProduct=Super</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">IMMEDIATE</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">fromProduct=; and toProduct=Super (any fromProduct)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">IMMEDIATE</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">fromProduct=Premium and toProduct=Standard</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">ILLEGAL</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">; (anything else)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">END_OF_TERM</p></td></tr></tbody></table></div>
<div class="sect3"><h4 id="_rule_1_if_phasetypetrial_change_policyimmediate">Rule 1: If phaseType=TRIAL, change policy=IMMEDIATE</h4><div class="paragraph"><p>This rule specifies that if a product is in <code>TRIAL</code> phase, plan change should take effect immediately.</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Action</th><th class="tableblock halign-left valign-top">Result</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a subscription for the <code>standard-monthly</code> plan on <code>2021-09-29</code> (current date)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$0</code> (since subscription is in trial phase)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Change subscription to use the <code>sports-monthly</code> plan (specify default policy)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Plan change takes effect immediately (Invoice generated for <code>$500</code> for <code>2021-09-29</code> to <code>2021-10-29</code> corresponding to the <code>sports-monthly</code> plan)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-10-29</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for  <code>$500</code> for <code>2021-10-29</code> to <code>2021-11-29</code> corresponding to the <code>sports-monthly</code> plan</p></td></tr></tbody></table></div>
<div class="sect3"><h4 id="_rule_2_if_fromproductsports_and_toproductsuper_change_policyimmediate">Rule 2: If fromProduct=Sports and toProduct=Super, change policy=IMMEDIATE</h4><div class="paragraph"><p>This rule specifies that if the plan change involves upgrading a product from <code>Sports</code> to <code>Super</code>, it should take effect immediately.</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Action</th><th class="tableblock halign-left valign-top">Result</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a subscription for the <code>sports-monthly</code> plan on <code>2021-09-29</code> (current date)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$500</code> for <code>2021-09-29</code> to <code>2021-10-29</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Change subscription to use the <code>super-monthly</code> plan (specify default policy)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Plan change takes effect immediately (Since the monthly price for <code>super-monthly</code> is <code>$1000</code>, an invoice is generated for <code>$500</code> for <code>2021-09-29</code> to <code>2021-10-29</code> corresponding to the balance amount)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-10-29</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for  <code>$1000</code> for <code>2021-10-29</code> to <code>2021-11-29</code> corresponding to the <code>super-monthly</code> plan</p></td></tr></tbody></table></div>
<div class="sect3"><h4 id="_rule_3_if_toproductpremium_change_policyimmediate_any_fromproduct_value">Rule 3: If toProduct=Premium, change policy=IMMEDIATE (any fromProduct value)</h4><div class="paragraph"><p>This rule specifies that if the plan change involves upgrading to <code>Premium</code>, it should take effect immediately.</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Action</th><th class="tableblock halign-left valign-top">Result</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a subscription for the <code>sports-monthly</code> plan on <code>2021-09-29</code> (current date)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$500</code> for <code>2021-09-29</code> to <code>2021-10-29</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Change subscription to use the <code>premium-monthly</code> plan (specify default policy)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Plan change takes effect immediately (Since the monthly price for <code>premium-monthly</code> is <code>$2000</code>, an invoice is generated for <code>$1500</code> for <code>2021-09-29</code> to <code>2021-10-29</code> corresponding to the balance amount)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-10-29</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for  <code>$2000</code> for <code>2021-10-29</code> to <code>2021-11-29</code> corresponding to the <code>premium-monthly</code> plan</p></td></tr></tbody></table></div>
<div class="sect3"><h4 id="_rule_4_if_fromproductpremium_and_toproductstandard_change_policyillegal">Rule 4: If fromProduct=Premium and toProduct=Standard, change policy=ILLEGAL</h4><div class="paragraph"><p>This rule specifies that if the plan change involves upgrading from <code>Standard</code> to <code>Premium</code>, it should not be allowed.</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Action</th><th class="tableblock halign-left valign-top">Result</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a subscription for the <code>premium-monthly</code> plan on <code>2021-09-29</code> (current date)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$2000</code> for <code>2021-09-29</code> to <code>2021-10-29</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Change subscription to use the <code>standard-monthly</code> plan (specify default policy)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Plan change not allowed</p></td></tr></tbody></table></div>
<div class="sect3"><h4 id="_rule_5_for_anything_else_change_policyend_of_term">Rule 5: For anything else, change policy=END_OF_TERM</h4><div class="paragraph"><p>This is the default rule. It specifies that any other plan changes should occur at the end of the billing period.</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Action</th><th class="tableblock halign-left valign-top">Result</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a subscription for the <code>sports-monthly</code> plan on <code>2021-09-29</code> (current date)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$500</code> for <code>2021-09-29</code> to <code>2021-10-29</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Change subscription to use the <code>standard-monthly</code> plan (specify default policy)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Plan change takes effect end of term ( Invoice item corresponding to a credit is not generated)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-10-29</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for  <code>$100</code> for <code>2021-10-29</code> to <code>2021-11-29</code> corresponding to the <code>standard-monthly</code> plan</p></td></tr></tbody></table></div></div></div></div>
<div class="sect1"><h2 id="_usage_billing">Usage Billing</h2><div class="sectionbody"><div class="paragraph"><p>Kill Bill supports usage based billing as explained in the <a href="https://docs.killbill.io/latest/userguide_subscription.html#components-catalog-usage"><em>Subscription Billing</em></a> document. A quick summary about usage billing:</p></div>
<div class="ulist"><ul><li><p>Users are billed based on their usage data as defined in the catalog. The <code>Plan</code> section in the catalog can contain one or more usage section(s) in addition to other non usage based sections.</p></li><li><p>Kill Bill supports two types of usage billing: <code>CONSUMABLE</code> and <code>CAPACITY</code></p></li><li><p>In <code>CONSUMABLE</code> billing, users are billed based on the number of units consumed. Two <code>TierBlockPolicy</code> policies are supported: <code>ALL_TIER</code> and <code>TOP_TIER</code>. The <code>ALL_TIER</code> policy charges users across each tier while the <code>TOP_TIER</code> policy charges users at the top tier.</p></li><li><p>In <code>CAPACITY</code> billing users are charged a flat rate based on the units consumed.</p></li></ul></div>
<div class="paragraph"><p>Let us take a look at a few catalog examples.</p></div>
<div class="sect2"><h3 id="_consumable_billing_with_all_tiers_policy">Consumable Billing with ALL_TIERS policy</h3><div class="paragraph"><p>This example uses the <a href="https://github.com/killbill/killbill-docs/blob/5d5d7a2219752da8a0d9456cc5a975161388088c/catalogs/consumable-billing-all-tiers.xml">Consumable Billing All Tiers</a> catalog. It has a <code>water-monthly</code> plan with a <code>MONTHLY</code> recurring charge of <code>$30</code>. In addition, it also has a usage section with <code>usageType=CONSUMABLE</code>, <code>tierBlockPolicy=ALL_TIERS</code> and the following <code>tieredBlock</code> sections:</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 20%;"><col style="width: 20%;"><col style="width: 20%;"><col style="width: 20%;"><col style="width: 20%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Unit</th><th class="tableblock halign-left valign-top">Size</th><th class="tableblock halign-left valign-top">Price</th><th class="tableblock halign-left valign-top">Max</th><th class="tableblock halign-left valign-top">Explanation</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">liter</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">$1.50</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">1000</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Users will be charged at $1.50 per liter for the first 1000 liters</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">liter</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">$2.0</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">-1</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Users will be charged at $2.0 per liter for any units consumed above <code>1000</code></p></td></tr></tbody></table>
<div class="paragraph"><p>The following table lists the actions and their results:</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Action</th><th class="tableblock halign-left valign-top">Result</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a subscription for the <code>water-monthly</code> plan on <code>2021-09-29</code> (current date)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Because <strong>IN_ARREAR</strong> billing mode is specified, the system does not generate an invoice (yet).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://killbill.github.io/slate/#usage-record-usage-for-a-subscription">Record a usage</a> of <code>400</code> with date <code>2021-10-01</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Again, invoice not generated since <strong>IN_ARREAR</strong> billing mode is specified</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-10-29</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for  <code>$630</code> for <code>2021-09-29</code> to <code>2021-10-29</code>. This is calculated as: <code>30 + (400 x 1.5) = 630</code> (Since <code>400</code> units are consumed, user is charged <code>$1.5</code> per liter as per the first tier)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://killbill.github.io/slate/#usage-record-usage-for-a-subscription">Record a usage</a> of <code>1200</code> with date <code>2021-11-01</code>. Trigger invoice dry run with target date <code>2021-11-29</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for  <code>$1930</code> for <code>2021-10-29</code> to <code>2021-11-29</code>. This is calculated as: <code>30 + (1000 x 1.5) + (200 X 2.0) = 1930</code> (Since <code>1200</code> units are consumed, the first <code>1000</code> units are charged at <code>$1.5</code> per liter as per the first tier and the next <code>200</code> units are charged at at <code>$2.0</code> per liter as per the second tier)</p></td></tr></tbody></table>
<div class="paragraph"><p>See <a href="https://docs.killbill.io/latest/consumable_in_arrear.html"><em>Consumable In Arrear Tutorial</em></a> for additional information.</p></div></div>
<div class="sect2"><h3 id="_consumable_billing_with_top_tier_policy">Consumable Billing with TOP_TIER policy</h3><div class="paragraph"><p>This example uses the <a href="https://github.com/killbill/killbill-docs/blob/5d5d7a2219752da8a0d9456cc5a975161388088c/catalogs/consumable-billing-top-tier.xml">Consumable Billing Top Tier</a> catalog. This catalog is exactly the same as the <a href="https://github.com/killbill/killbill-docs/blob/5d5d7a2219752da8a0d9456cc5a975161388088c/catalogs/consumable-billing-all-tiers.xml">Consumable Billing All Tiers</a> catalog explained above. The only difference is that it uses  <code>tierBlockPolicy=TOP_TIER</code>.</p></div>
<div class="paragraph"><p>The following table lists the actions and their results:</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Action</th><th class="tableblock halign-left valign-top">Result</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a subscription for the <code>water-monthly</code> plan on <code>2021-09-29</code> (current date)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Because <strong>IN_ARREAR</strong> billing mode is specified, the system does not generate an invoice (yet).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://killbill.github.io/slate/#usage-record-usage-for-a-subscription">Record a usage</a> of <code>400</code> with date <code>2021-10-01</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Again, invoice not generated since <strong>IN_ARREAR</strong> billing mode is specified</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-10-29</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for  <code>$630</code> for <code>2021-09-29</code> to <code>2021-10-29</code>. This is calculated as: <code>30 + (400 x 1.5) = 630</code> (Since <code>400</code> units are consumed, user is charged <code>$1.5</code> per liter as per the first tier)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://killbill.github.io/slate/#usage-record-usage-for-a-subscription">Record a usage</a> of <code>1200</code> with date <code>2021-11-01</code>. Trigger invoice dry run with target date <code>2021-11-29</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for  <code>$2430</code> for <code>2021-10-29</code> to <code>2021-11-29</code>. This is calculated as: <code>30 + (1200 x 2.0) = 2430</code>  (Since <code>1200</code> units are consumed, user is charged <code>$2.0</code> per liter as per the second tier)</p></td></tr></tbody></table></div>
<div class="sect2"><h3 id="_capacity_billing">Capacity Billing</h3><div class="paragraph"><p>This example uses the <a href="https://github.com/killbill/killbill-docs/blob/5d5d7a2219752da8a0d9456cc5a975161388088c/catalogs/capacity-billing.xml">Capacity Billing</a> catalog.  It has a <code>water-monthly</code> plan with a <code>MONTHLY</code> recurring charge of <code>$30</code>. In addition, it also has a usage section with <code>usageType=CAPACITY</code>, and the following <code>tier</code> sections:</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 33.3333%;"><col style="width: 33.3333%;"><col style="width: 33.3334%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Max Limit</th><th class="tableblock halign-left valign-top">Price</th><th class="tableblock halign-left valign-top">Explanation</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">1000</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">$750.0</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Users will be charged a flat charge of $750 if their units are less than or equal to 1000</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">10000</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">$500.0</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Users will be charged a flat charge of $500 if their units exceed 1000.</p></td></tr></tbody></table>
<div class="paragraph"><p>The following table lists the actions and their results:</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Action</th><th class="tableblock halign-left valign-top">Result</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a subscription for the <code>water-monthly</code> plan on <code>2021-09-29</code> (current date)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Because <strong>IN_ARREAR</strong> billing mode is specified, the system does not generate an invoice (yet).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://killbill.github.io/slate/#usage-record-usage-for-a-subscription">Record a usage</a> of <code>400</code> with date <code>2021-10-01</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Again, invoice not generated since <strong>IN_ARREAR</strong> billing mode is specified</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-10-29</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for  <code>$780</code> for <code>2021-09-29</code> to <code>2021-10-29</code>. This is calculated as: <code>30 + 750 = 780</code> (Since <code>400</code> units are consumed, user is charged <code>$750</code> as per the first tier)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://killbill.github.io/slate/#usage-record-usage-for-a-subscription">Record a usage</a> of <code>1200</code> with date <code>2021-11-01</code> . Trigger invoice dry run with target date <code>2021-11-29</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for  <code>$530</code> for <code>2021-10-29</code> to <code>2021-11-29</code>. This is calculated as: <code>30 + 500 = 530</code> (Since <code>1200</code> units are consumed, user is charged <code>$500</code> as per the second tier)</p></td></tr></tbody></table></div>
<div class="sect2"><h3 id="_multiple_usage_sections">Multiple Usage Sections</h3><div class="paragraph"><p>This example uses the <a href="https://github.com/killbill/killbill-docs/tree/a6339c9dd4bb75da375f4755e45aa5c5c07ebe01/catalogs/consumable-billing-multiple-usage-sections.xml">Consumable Billing Multiple Usage Sections</a> catalog. It has a <code>cell-phone-monthly</code> plan with a <code>MONTHLY</code> recurring charge of <code>$30</code>. In addition, it  has two usage sections: <code>cell-phone-minutes-monthly-usage</code> and <code>mbytes-monthly-usage</code>. The <code>cell-phone-minutes-monthly-usage</code> usage section specifies the <code>ALL_TIERS</code> policy while the <code>mbytes-monthly-usage</code> usage section specifies the <code>TOP_TIER</code> policy.</p></div>
<div class="paragraph"><p>The following table lists the actions and their results:</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Action</th><th class="tableblock halign-left valign-top">Result</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a subscription for the <code>cell-phone-monthly</code> plan on <code>2021-09-29</code> (current date)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Because <strong>IN_ARREAR</strong> billing mode is specified, the system does not generate an invoice (yet).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://killbill.github.io/slate/#usage-record-usage-for-a-subscription">Record a usage</a> of <code>400</code> for the <code>cell-phone-minutes</code> unitType with date <code>2021-10-01</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Again, invoice not generated since <strong>IN_ARREAR</strong> billing mode is specified</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-10-29</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for  <code>$280</code> for <code>2021-09-29</code> to <code>2021-10-29</code>. It has 3 invoice items : <code>cell-phone-monthly-evergreen:$30</code>, <code>mbytes-monthly-usage:$0</code> and <code>cell-phone-minutes-monthly-usage:$250</code> (calculated as: <code>(100 x 1.0) + (300 x 0.5) = 250</code> as per the <code>ALL_TIERS</code> policy).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://killbill.github.io/slate/#usage-record-usage-for-a-subscription">Record a usage</a> of <code>1200</code> for the <code>Mbytes</code> unitType with date <code>2021-11-01</code> . Trigger invoice dry run with target date <code>2021-11-29</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for  <code>$630</code> for <code>2021-10-29</code> to <code>2021-11-29</code>. It has 3 invoice items : <code>cell-phone-monthly-evergreen:$30</code>, <code>cell-phone-minutes-monthly-usage:$0</code> and <code>mbytes-monthly-usage:$630</code> (calculated as: <code>(1200 x 0.5) = 600</code> as per the <code>TOP_TIER</code> policy).</p></td></tr></tbody></table></div>
<div class="sect2"><h3 id="_block_size_greater_than_one">Block Size Greater Than One</h3><div class="paragraph"><p>This example uses the <a href="https://github.com/killbill/killbill-docs/tree/a6339c9dd4bb75da375f4755e45aa5c5c07ebe01/catalogs/consumable-billing-block-size-more-than-one.xml">Consumable Billing Block Size More Than One</a> catalog. It has a <code>cell-phone-monthly</code> plan with a <code>MONTHLY</code> recurring charge of <code>$30</code>. In addition, it also has a usage section with <code>usageType=CONSUMABLE</code>, <code>tierBlockPolicy=ALL_TIERS</code> and the following <code>tieredBlock</code> sections:</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 20%;"><col style="width: 20%;"><col style="width: 20%;"><col style="width: 20%;"><col style="width: 20%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Unit</th><th class="tableblock halign-left valign-top">Size</th><th class="tableblock halign-left valign-top">Price</th><th class="tableblock halign-left valign-top">Max</th><th class="tableblock halign-left valign-top">Explanation</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">cell-phone-minutes</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">$1.00</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">100</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">A block size <code>10</code> is specified. So, users will be charged at $1.0 per 10 minutes. This is applicable for the for the first <code>100</code> blocks</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">cell-phone-minutes</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">$0.5</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">-1</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Users will be charged at $2.0 per block for any blocks consumed above <code>100</code></p></td></tr></tbody></table>
<div class="paragraph"><p>The following table lists the actions and their results:</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Action</th><th class="tableblock halign-left valign-top">Result</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a subscription for the <code>cell-phone-monthly</code> plan on <code>2021-09-29</code> (current date)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Because <strong>IN_ARREAR</strong> billing mode is specified, the system does not generate an invoice (yet).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://killbill.github.io/slate/#usage-record-usage-for-a-subscription">Record a usage</a> of <code>400</code> with date <code>2021-10-01</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Again, invoice not generated since <strong>IN_ARREAR</strong> billing mode is specified</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Trigger invoice dry run with target date <code>2021-10-29</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for  <code>$70</code> for <code>2021-09-29</code> to <code>2021-10-29</code>. This is calculated as: <code>30 + ((400/100) x 1.0) = 70</code> (Since <code>400</code> minutes (<code>40</code> blocks) are recorded, user is charged <code>$1.0</code> per block as per the first tier)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://killbill.github.io/slate/#usage-record-usage-for-a-subscription">Record a usage</a> of <code>110</code> with date <code>2021-11-01</code>. Trigger invoice dry run with target date <code>2021-11-29</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for  <code>$140</code> for <code>2021-10-29</code> to <code>2021-11-29</code>. This is calculated as: <code>30 + ((1000/100) x 1.0) + ((200/100) X 0.5) = 140</code> (Since <code>1200</code> minutes (<code>120</code> blocks) are recorded, the first <code>100</code> blocked are charged at <code>$1.0</code> per block as per the first tier and the next <code>20</code> blocks are charged at at <code>$0.5</code> per block as per the second tier)</p></td></tr></tbody></table></div></div></div>
<div class="sect1"><h2 id="_versioned_catalogs">Versioned Catalogs</h2><div class="sectionbody"><div class="paragraph"><p>Kill Bill allows modifying the catalog over time. You can do this by creating a set of catalogs, one XML file for each version. Note that all the versions of a catalog need to have the same <code>catalogName</code> but different values for <code>effectiveDate</code>. The system will then rank such files based on their <code>effectiveDate</code> to create the various versions.</p></div>
<div class="paragraph"><p>You can do the following using versioned catalogs:</p></div>
<div class="ulist"><ul><li><p>Add new plans</p></li><li><p>Modify the price for an existing plan</p></li><li><p>Delete plans</p></li></ul></div>
<div class="paragraph"><p>Kill Bill uses the following rules to determine the active catalog version:</p></div>
<div class="ulist"><ul><li><p>When there are multiple versions of a catalog, the catalog with an <code>effectiveDate</code> not later than the current date is treated as the active catalog. So any catalog version with a future <code>effectiveDate</code> is not treated as active until that date is reached.</p></li><li><p>If there are multiple catalog versions with effective dates before the current date, the newest one is considered active.</p></li><li><p>If all the catalog versions have effective dates after the current date, the oldest one is considered active.</p></li><li><p>If there are multiple catalog versions, with the same date component but different time components in the <code>effectiveDate</code>, the one with the earliest time component is considered as active.</p></li><li><p>When there is only one catalog version, the <code>effectiveDate</code> does not matter. So, irrespective of whether it is in the past or in the future, the catalog is treated as the active catalog.</p></li></ul></div>
<div class="admonitionblock note"><table><tr><td class="icon"><div class="title">Note</div></td><td class="content"><strong>Note:</strong>
Currently Kill Bill requires the catalog names to be the same across different versions. Changing the name of the catalog results in an exception and momentarily freezes any further uploads even with the original catalog name. To workaround this, tenant specific cache can be cleared as explained <a href="https://killbill.github.io/slate/index.html?shell=#admin-invalidate-a-specific-cache-or-invalidate-all-caches">here</a>.</td></tr></table></div>
<div class="paragraph"><p>The subsequent sections provide some examples of versioned catalogs.</p></div>
<div class="sect2"><h3 id="_add_new_plan">Add New Plan</h3><div class="paragraph"><p>It is possible to add a new plan in a newer version of a catalog. The new plan is available only when the current date surpasses the <code>effectiveDate</code> in the new catalog version.</p></div>
<div class="paragraph"><p>This example uses the following catalogs:</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 33.3333%;"><col style="width: 33.3333%;"><col style="width: 33.3334%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Catalog Name</th><th class="tableblock halign-left valign-top">effectiveDate</th><th class="tableblock halign-left valign-top">Plan Details</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/killbill/killbill-docs/blob/5a61ac1957f9174fd4e291c7b61a17c186194388/catalogs/add-new-plan/add-new-plan-v1.xml">add-new-plan-v1.xml</a></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-01T00:00:00+00:00</p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><code>standard-monthly</code> plan with <code>$30</code> recurring charge</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/killbill/killbill-docs/blob/5a61ac1957f9174fd4e291c7b61a17c186194388/catalogs/add-new-plan/add-new-plan-v2.xml">add-new-plan-v2.xml</a></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">2021-01-15T00:00:00+00:00</p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><code>standard-monthly</code> plan with <code>$30</code> recurring charge, <code>standard-yearly</code> plan with <code>$540</code> recurring charge.</p></td></tr></tbody></table>
<div class="paragraph"><p>The following table lists the actions and their results:</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Action</th><th class="tableblock halign-left valign-top">Result</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Set the date to <code>2021-01-01</code> and upload the catalogs mentioned above</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a subscription to the <code>standard-monthly</code> plan</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice is generated for <code>$30</code> for <code>2021-01-01</code> to <code>2021-02-01</code> corresponding to the <code>standard-monthly</code> plan</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a subscription to the <code>standard-yearly</code> plan</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Subscription creation fails (Since the <code>standard-yearly</code> plan is not yet active)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Move the clock to <code>2021-02-01</code>.</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice is generated for <code>$30</code> for <code>2021-02-01</code> to <code>2021-03-01</code> corresponding to the <code>standard-monthly</code> plan</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a subscription to the <code>standard-yearly</code> plan</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice is generated for <code>$540</code> for <code>2021-02-01</code> to <code>2022-02-01</code> (Since <code>v2</code> is now active, subscription creation is successful)</p></td></tr></tbody></table></div>
<div class="sect2"><h3 id="_modify_plan_price_without_affecting_existing_subscriptions">Modify Plan Price Without Affecting Existing Subscriptions</h3><div class="paragraph"><p>It is possible to change the price of a plan in a newer version of a catalog. In such cases, the price change applies only to new subscriptions (subscriptions created after the catalog with the price change is effective). Older subscriptions continue to be billed as per the original price plan.</p></div>
<div class="paragraph"><p>This example uses the following catalogs:</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 33.3333%;"><col style="width: 33.3333%;"><col style="width: 33.3334%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Catalog Name</th><th class="tableblock halign-left valign-top">effectiveDate</th><th class="tableblock halign-left valign-top">Plan Details</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/killbill/killbill-docs/blob/5a61ac1957f9174fd4e291c7b61a17c186194388/catalogs/modify-plan-price-without-effective-date-for-existing-subscriptions/modify-plan-price-without-effective-date-for-existing-sub-v1.xml">modify-plan-price-without-effective-date-for-existing-sub-v1.xml</a></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-01T00:00:00+00:00</p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><code>standard-monthly</code> plan with <code>$30</code> recurring charge</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/killbill/killbill-docs/blob/5a61ac1957f9174fd4e291c7b61a17c186194388/catalogs/modify-plan-price-without-effective-date-for-existing-subscriptions/modify-plan-price-without-effective-date-for-existing-sub-v2.xml">modify-plan-price-without-effective-date-for-existing-sub-v2.xml</a></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">2021-01-15T00:00:00+00:00</p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><code>standard-monthly</code> plan with <code>$60</code> recurring charge</p></td></tr></tbody></table>
<div class="paragraph"><p>The following table lists the actions and their results:</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Action</th><th class="tableblock halign-left valign-top">Result</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Set the date to <code>2021-01-01</code> and upload the catalogs mentioned above</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a subscription to the <code>standard-monthly</code> plan</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice is generated for <code>$30</code> for <code>2021-01-01</code> to <code>2021-02-01</code> corresponding to the <code>standard-monthly</code> plan</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Move the clock to <code>2021-02-01</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice is generated for <code>$30</code> for <code>2021-02-01</code> to <code>2021-03-01</code> corresponding to the <code>standard-monthly</code> plan (Although v2 is effective, invoice is generated as per the old price since this is an existing subscription)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create another subscription to the <code>standard-monthly</code> plan</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice is generated for <code>$60</code> for <code>2021-02-01</code> to <code>2021-03-01</code> corresponding to the <code>standard-monthly</code> plan (Invoice is generated as per the new price since this is a new subscription)</p></td></tr></tbody></table></div>
<div class="sect2"><h3 id="_modify_plan_price_and_use_new_price_for_existing_subscriptions">Modify Plan Price And Use New Price for Existing Subscriptions</h3><div class="paragraph"><p>As mentioned earlier, when a plan price is changed, it applies only to new subscriptions. If you do need to apply the price change to existing subscriptions, the <code>effectiveDateForExistingSubscriptions</code> attribute needs to be specified corresponding to the plan.</p></div>
<div class="paragraph"><p>This example uses the following catalogs:</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 33.3333%;"><col style="width: 33.3333%;"><col style="width: 33.3334%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Catalog Name</th><th class="tableblock halign-left valign-top">effectiveDate</th><th class="tableblock halign-left valign-top">Plan Details</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/killbill/killbill-docs/blob/5a61ac1957f9174fd4e291c7b61a17c186194388/catalogs/modify-plan-price-with-effective-date-for-existing-subscriptions/modify-plan-price-with-effective-date-existing-sub-v1.xml">modify-plan-price-with-effective-date-existing-sub-v1.xml</a></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-01T00:00:00+00:00</p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><code>standard-monthly</code> plan with <code>$30</code> recurring charge</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/killbill/killbill-docs/blob/5a61ac1957f9174fd4e291c7b61a17c186194388/catalogs/modify-plan-price-with-effective-date-for-existing-subscriptions/modify-plan-price-with-effective-date-existing-sub-v2.xml">modify-plan-price-with-effective-date-existing-sub-v2.xml</a></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">2021-01-15T00:00:00+00:00</p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><code>standard-monthly</code> plan with <code>$60</code> recurring charge. The <code>standard-monthly</code> plan has <code>effectiveDateForExistingSubscriptions=2021-03-01T00:00:00+00:00</code></p></td></tr></tbody></table>
<div class="paragraph"><p>The following table lists the actions and their results:</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Action</th><th class="tableblock halign-left valign-top">Result</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Set the date to <code>2021-01-01</code> and upload both the catalogs mentioned above</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a subscription to the <code>standard-monthly</code> plan</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice is generated for <code>$30</code> for <code>2021-01-01</code> to <code>2021-02-01</code> corresponding to the <code>standard-monthly</code> plan</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Move the clock to <code>2021-02-01</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice is generated for <code>$30</code> for <code>2021-02-01</code> to <code>2021-03-01</code> corresponding to the <code>standard-monthly</code> plan (Although v2 is effective, invoice is generated as per the old price since this is an existing subscription and <code>effectiveDateForExistingSubscriptions</code> is not reached)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Move the clock to  <code>2021-03-01</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice generated for <code>$60</code> for <code>2021-03-01</code> to <code>2021-04-01</code> corresponding to the <code>standard-monthly</code> plan (Invoice is generated as per the new price since <code>effectiveDateForExistingSubscriptions</code> is reached)</p></td></tr></tbody></table></div>
<div class="sect2"><h3 id="_retire_plan">Retire Plan</h3><div class="paragraph"><p>It is possible to delete a plan in a newer version of a catalog. In such cases, no new subscriptions can be created corresponding to the plan. However, existing subscriptions continue to be billed as per the original price plan.</p></div>
<div class="paragraph"><p>This example uses the following catalogs:</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 33.3333%;"><col style="width: 33.3333%;"><col style="width: 33.3334%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Catalog Name</th><th class="tableblock halign-left valign-top">effectiveDate</th><th class="tableblock halign-left valign-top">Plan Details</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/killbill/killbill-docs/blob/5a61ac1957f9174fd4e291c7b61a17c186194388/catalogs/retire-plan/retire-plan-v1.xml">retire-plan-v1.xml</a></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-01T00:00:00+00:00</p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><code>standard-monthly</code> plan with <code>$30</code> recurring charge, <code>standard-weekly</code> plan with <code>$15</code> recurring charge</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/killbill/killbill-docs/blob/5a61ac1957f9174fd4e291c7b61a17c186194388/catalogs/retire-plan/retire-plan-v2.xml">retire-plan-v2.xml</a></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">2021-01-15T00:00:00+00:00</p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><code>standard-weekly</code> plan with <code>$15</code> recurring charge</p></td></tr></tbody></table>
<div class="paragraph"><p>The following table lists the actions and their results:</p></div>
<table class="tableblock frame-all grid-all spread"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Action</th><th class="tableblock halign-left valign-top">Result</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Set the date to <code>2021-01-01</code> and upload the catalogs mentioned above</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create a subscription to the <code>standard-monthly</code> plan</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice is generated for <code>$30</code> for <code>2021-01-01</code> to <code>2021-02-01</code> corresponding to the <code>standard-monthly</code> plan</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Move the clock to <code>2021-02-01</code>.</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Invoice is generated for <code>$30</code> for <code>2021-02-01</code> to <code>2021-03-01</code> corresponding to the <code>standard-monthly</code> plan (Although v2 is effective and <code>standard-monthly</code> is not present in v2, invoice is generated since this is an existing subscription)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Create another subscription to the <code>standard-monthly</code> plan</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Subscription creation fails since v2 is now active and the <code>standard-monthly</code> plan is not present in v2.</p></td></tr></tbody></table></div></div></div>
<div class="sect1"><h2 id="_additional_information">Additional Information</h2><div class="sectionbody"><div class="paragraph"><p><a href="https://docs.killbill.io/latest/userguide_subscription.html#components-catalog"><em>Subscription Billing User Guide</em></a></p></div>
<div class="paragraph"><p><a href="https://docs.killbill.io/latest/invoice_subsystem.html"><em>Invoice Subsystem</em></a></p></div></div></div></div></article></div><div class="bd-links-wrapper"><nav class="bd-links toc right-side-menu" id="toc" data-toggle="toc"></nav></div></div></div></main><script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script><script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script><script src="https://cdn.staticaly.com/gh/afeld/bootstrap-toc/v1.0.0/dist/bootstrap-toc.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script><script src="https://www.googletagmanager.com/gtag/js?id=G-C0HVJ1E78Z"></script><script>
    setTimeout(function(){
      $('.content-wrapper h2, .content-wrapper h3, .content-wrapper h4').append('<a href=""><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>');
      $('.content-wrapper h2, .content-wrapper h3, .content-wrapper h4').each(function(){
        let itemHref = '#' + $(this).attr('id');
        $(this).find('a').attr("href", itemHref);
      })
      $('.content-wrapper table').each(function() {
        $(this).wrap('<div class="table-wrap"></div>')
        $('.table-wrap').each(function() {
          if ($(this).find('table').width() > $(this).width()){
            $(this).css('max-width', '100%');
            $(this).css('overflow-x', 'scroll');
          }
        })
      })
      function copyToClipboard(text) {
        let sampleTextarea = document.createElement("textarea");
        document.body.appendChild(sampleTextarea);
        sampleTextarea.value = text;
        sampleTextarea.select();
        document.execCommand("copy");
        document.body.removeChild(sampleTextarea);
      }
      $('.content-wrapper h2 a, .content-wrapper h3 a, .content-wrapper h4 a').on('click', function(){
        setTimeout(function(){
          copyToClipboard($(location).attr("href"));
        }, 500);
      });
      $('.content-wrapper .note td.icon').append('<img src="https://github.com/killbill/killbill-docs/raw/v3/userguide/assets/img/note-icon.png">');

      $('.content pre').parent('.content').prepend('<div class="copy-icon"><svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8 3a1 1 0 0 1 1-1h2a1 1 0 1 1 0 2H9a1 1 0 0 1-1-1Z" fill="#78AECD"/><path d="M6 3a2 2 0 0 0-2 2v11a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2 3 3 0 0 1-3 3H9a3 3 0 0 1-3-3Z" fill="#78AECD"/></svg></div>');
      $('.copy-icon svg').on('click', function () {
        copyToClipboard($(this).parent().next().find('code').text());
      });
    }, 1000);

    $('.main').append('<div class="lightbox-modal"> <div id="close-ligtbox">✕</div> <div class="img"><img src="" alt=""></div></div><div class="overlay"></div>');
    $('.main img').on('click', function () {
      let path = $(this).attr('src');
      $('.lightbox-modal img').attr('src', path);
      $('.lightbox-modal, .overlay').show();
    });
    $('#close-ligtbox, .overlay').on('click',function () {
      $('.lightbox-modal, .overlay').hide();
    });

$('.sidebar-toggler').on('click', function () {
  $(this).toggleClass('active');
  $('main.main').toggleClass('sidebar-hide');
});

$('.content-wrapper a').filter(function() {
  return this.hostname && this.hostname !== location.hostname;
}).each(function() {
  $(this).attr({
    target: '_blank',
    title: 'Visit ' + this.href + ' (click to open in a new window)'
  });
});

  </script><script>docsearch({apiKey: '3ef227e7fd5e2e1a3fffd880484934bf', container: '#docsearch', appId: 'S2ISXITURI', indexName: 'killbill'});</script><script>window.dataLayer = window.dataLayer || [];
function gtag(){window.dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-C0HVJ1E78Z');</script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create','UA-32705710-3','auto');
  ga('send','pageview');
  var getOutboundLink = function(url) {
    ga('send', {
      hitType: 'event',
      eventCategory: 'outbound',
      eventAction: 'click',
      eventLabel: url,
      hitCallback: function(){document.location = url;}
    });
  }</script></body></html>