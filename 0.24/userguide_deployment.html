<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]--><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="Asciidoctor 2.0.20"><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.staticaly.com/gh/afeld/bootstrap-toc/v1.0.0/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3"><link rel="preconnect" href="https://S2ISXITURI-dsn.algolia.net"><style type="text/css"></style><title>Kill Bill deployment guide</title><style>/*Default CSS*/

/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */

@import "https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap";

*,
*::before,
*::after {
  -webkit-box-sizing: border-box;
  box-sizing: border-box;
}

ul,
ol {
  padding: 0;
  list-style-type: none;
}

body,
h1,
h2,
h3,
h4,
p,
ul[class],
ol[class],
li,
figure,
figcaption,
blockquote,
dl,
dd {
  margin: 0;
}

body {
  min-height: 100vh;
  scroll-behavior: smooth;
  text-rendering: optimizeSpeed;
  font-family: 'Inter', sans-serif;
  font-size: 16px;
  line-height: 150%;
  color: #374151;
  max-width: 100%;
  overflow-x: hidden;
}

ul[class],
ol[class] {
  list-style: none;
}

img {
  max-width: 100%;
  display: block;
}

img[align=center] {
  margin: 0 auto;
}

button {
  cursor: pointer;
}

input,
button,
textarea,
select {
  font: inherit;
}
a {
  color: #167BB7;
}
h1,
h3,
h4 {
  font-weight: 400;
}
h2,
h3,
h4 {
  color: #1F2937;
}
h1 {
  font-size: 40px;
  line-height: 120%;
  letter-spacing: -0.025em;
  color: #FFFFFF;
}
h2 {
  font-weight: 600;
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
  font-weight: 500;
}

.header {
  padding: 16px 0;
  background: #FFFFFF;
  box-shadow: 0 1px 3px rgba(0, 0, 0, .1), 0 1px 2px rgba(0, 0, 0, .06);
}
@media (min-width: 768px) {
  .header-logo {
    width: 320px;
  }
}
.header-wrapper .logo {
  max-width: 215px;
  margin: auto;
  width: 80%;
}
.header-wrapper .logo img {
  object-fit: contain;
}
@media (max-width: 767px) {
  .header-wrapper .logo a {
    display: flex;
    justify-content: center;
  }
}
.header-search {
  flex-grow: 1;
  padding-right: 16px;
}
@media (min-width: 768px) {
  .header-search {
    /*flex-grow: 1;*/
    /*max-width: calc(100% - 590px);*/
    /*padding-right: 53px;*/
    /*padding-left: 45px;*/
  }
}
@media (min-width: 1200px) {
  .header-search {
    max-width: calc(100% - 590px);
    padding-right: 53px;
    padding-left: 45px;
  }
}

.header-wrapper .search-form-wrapper {
  flex-grow: 1;
}
.header-wrapper .search-form {
  position: relative;
}
.header-wrapper .search-form .algolia-autocomplete {
  width: 100%;
}
.header-wrapper .search-form input[type="search"] {
  width: 100%;
  padding: 9px 9px 9px 40px;
  border: 1px solid #D1D5DB;
  border-radius: 6px;
  box-shadow: 0 1px 2px rgba(0, 0, 0, .05);
}
.header-wrapper .search-form .ds-dropdown-menu {
  max-width: none;
  width: 100%;
}
.header-wrapper .search-form .search-form-icon {
  position: absolute;
  left: 13px;
  top: 9px;
  z-index: 1;
  width: 20px;
  height: 20px;
  pointer-events: none;
}
.content-wrapper {
  padding: 24px 20px;
}
@media (min-width: 1024px) {
  .content-wrapper {
    padding-right: 54px;
    padding-left: 54px;
  }
}

.content-wrapper .banner {
  position: relative;
  display: flex;
  align-items: center;
  min-height: 174px;
  margin-bottom: 24px;
  padding: 0 40px;
  background-color: #167BB7;
  border-radius: 8px;
}
.content-wrapper .banner .bg-image {
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
  pointer-events: none;
}

.main {
  position: relative;
  line-height: 1.5;
}

.main p {
  margin-bottom: 12px;
}

.main .sidebar {
  width: calc(100% + 15px);
  flex-shrink: 0;
  margin-right: 40px;
  position: sticky;
  top: 0;
  margin-left: -15px;
  padding: 24px 16px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, .1), 0 1px 2px rgba(0, 0, 0, .06);
}

.main .sidebar .icon-title {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding-top: 8px;
  padding-bottom: 8px;
  cursor: pointer;
}

.main .sidebar .icon-title .left-part{
  display: flex;
  align-items: center;
  order: 2;
  flex-grow: 1;
}

.main .sidebar .icon-title .chevron,
.main .sidebar .icon-title.bd-link-active-wrap .chevron.rotated {
  transform: rotate(180deg);
}

.main .sidebar .icon-title.bd-link-active-wrap .bd-toc-link {
  color: #167BB7;
}

.main .sidebar .open .icon-title .chevron,
.main .sidebar .icon-title.bd-link-active-wrap .chevron{
  transform: rotate(0);
  transition-duration: .25s;
  transform-origin: center;
}

.main .sidebar .bd-link-active-wrap  .chevron path {
  fill: #D1D5DB;
}

.main .sidebar .bd-link-active-wrap svg path {
  fill: #167BB7;
}

.main .sidebar .icon-title svg {
  width: 16px;
  order: 1;
}
.main .sidebar-nav {
  height: 100vh;
}
.main .sidebar-nav,
.main .right-side-menu {
  overflow-y: scroll;
  padding: 0 24px;
}

.main .right-side-menu {
  direction: rtl;
  padding: 24px 0 0 24px;
}

.main .right-side-menu .navbar-nav {
  direction: ltr;
}

.main .sidebar-nav::-webkit-scrollbar,
.main .right-side-menu::-webkit-scrollbar
{
  width: 8px;
}

.main .sidebar-nav::-webkit-scrollbar-track,
.main .right-side-menu::-webkit-scrollbar-track
{
  background-color: transparent;
}

.main .sidebar-nav::-webkit-scrollbar-thumb,
.main .right-side-menu::-webkit-scrollbar-thumb
{
  background-color: #F3F4F6;
  width: 6px;
  border-radius: 32px;
}

.main .sidebar-nav a.nav-link {
  transition-duration: .25s;
  transition-property: color;
}
.main .sidebar-nav a.nav-link:hover {
  color: #167BB7;
}
.main .sidebar-nav a {
  color: #6B7280;
}

.main .sidebar-nav a.bd-toc-link {
  padding-left: 12px;
  font-weight: 500;
  font-size: 14px;
  display: block;
  color: #6B7280;
  transition-duration: .25s;
  transition-property: color;
}
.main .sidebar-nav li:hover a.bd-toc-link,
.main .sidebar-nav li.active a.bd-toc-link,
.main .sidebar-nav .open a.bd-toc-link {
  color: #374151;
}
@media (min-width: 768px) {
  .main .sidebar:after {
    content: '';
    position: absolute;
    top: 30px;
    right: -12px;
    width: 13px;
    height: 24px;
    border-radius: 4px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1), 0 1px 2px rgba(0, 0, 0, 0.06);
  }
}
.sidebar-toggler {
  display: none;
}
@media (min-width: 768px) {
  .sidebar-toggler {
    display: block;
    position: absolute;
    top: 30px;
    right: -12px;
    width: 24px;
    height: 24px;
    border-radius: 4px;
    cursor: pointer;
    background-color: #F3F4F6;
    transition-duration: .25s;
    z-index: 2;
  }
  .sidebar-toggler:hover {
    background-color: #efefef;
  }
  .sidebar-toggler:after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 8px;
    height: 12px;
    transform: translate(-50%, -50%) rotate(0deg);
    background-image: url("data:image/svg+xml,%3Csvg width='8' height='12' viewBox='0 0 8 12' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M6.33337 10.6666L1.66671 5.99998L6.33337 1.33331' stroke='%23167BB7' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E%0A");
    background-size: contain;
    background-repeat: no-repeat;
    transition-duration: .25s;
  }
  .sidebar-toggler.active:after {
    transform: translate(-50%, -50%) rotate(180deg);
  }
}


pre.pygments .tok-o {
  color: #167BB7;
}

.main p code {
  color: inherit;
  font-size: inherit;
}

.main table,.main table td,.main table th {
  border: 1px solid #dedede;
  padding: 10px;
}

.main .note table,.main .note table td,.main .note table th {
  border: none;
}

.main .note .icon {
  width: 60px;
}

.main .note .icon .fa.icon-note {
  display: none;
}

.main .note .content {
  font-weight: normal;
  color: #374151;
}

.main table td.icon svg{
  width: 30px;
  height: auto;
}

.main table td.icon .title {
  display: none;
}

.main table {
  width: 100%;
  border-collapse: collapse;
  margin-bottom: 15px;
}

.main table .title {
  text-transform: uppercase;
  font-weight: 600;
  padding: 0 5px;
}

pre.pygments .tok-o {
  color: #167BB7!important;
}

.main .sidebar-nav > ul li ul {
  display: none;
  padding-left: 16px;
  padding-bottom: 8px;
  font-size: 14px;
  border-bottom: 1px solid #F3F4F6;
}

.main .sidebar-nav > ul li ul.active-list {
  display: block;
}

.main .sidebar-nav > ul li ul li a{
  display: block;
  position: relative;
  padding-left: 16px;
  font-size: 14px;
}

.main .sidebar-nav .list-item-active a {
  color: #167BB7;
}

.main .sidebar-nav > .navbar-nav  > li {
  margin-bottom: 8px;
}

.main .right-side-menu {
  position: sticky;
  top: 16px;
  height: calc(100vh - 40px);
  margin-top: 24px;
}

.main .right-side-menu > .navbar-nav {
  position: relative;
}

.sidebar-wrapper {
  margin-left: 0;
  transition-duration: .25s;
  flex-shrink: 0;
  width: calc(100% - 16px);
}
.main-wrapper {
  flex-grow: 1;
}
.bd-links-wrapper {
  flex-shrink: 0;
}
.right-side-menu ul ul {
  padding-left: 16px;
}
@media (min-width: 768px) {
  .sidebar-wrapper {
    width: 310px;
  }
  .sidebar-hide .sidebar-wrapper {
    margin-left: -280px;
  }
  .main-wrapper {
    width: calc(100% - 520px);
  }
}
@media (min-width: 1200px) {
  .main-wrapper {
    width: calc(100% - 590px);
  }
  .bd-links-wrapper {
    width: 268px;
  }
}


.main .right-side-menu > .navbar-nav:before {
  content: "In this document";
  display: block;
  margin-bottom: 8px;
  font-weight: 500;
  font-size: 14px;
  line-height: 16px;
  text-transform: uppercase;
  color: #1F2937;
}

.main .right-side-menu > ul > li > a {
  font-size: 14px;
  font-weight: 300;
  margin-bottom: 7px;
  padding: 4px 0;
}

.main .right-side-menu .nav-link {
  border: none!important;
  color: #6B7280!important;
}

.main .right-side-menu .nav-link.active{
  padding-left: 0;
  color: #167BB7!important;
  font-weight: 500;
}

.main .right-side-menu .navbar-nav {
  display: block;
}
.main nav[data-toggle=toc] .nav > li > a {
  padding-left: 0;
  transition-property: color;
  transition-duration: .25s;
}
.main nav[data-toggle=toc] .nav > li > a:focus,
.main nav[data-toggle=toc] .nav > li > a:hover {
  color: #167BB7!important;
}
.main nav[data-toggle=toc] .nav .nav > li > a:focus,
.main nav[data-toggle=toc] .nav .nav > li > a:hover,
.main nav[data-toggle=toc] .nav .nav > li > .active,
.main nav[data-toggle=toc] .nav .nav > li > .active:focus,
.main nav[data-toggle=toc] .nav .nav > li > .active:hover {
  padding-left: 0;
}
.main nav[data-toggle=toc] .nav-link.active:hover {
  padding-left: 0;
}

.main img {
  box-shadow: none;
  border-radius: 0;
  margin-bottom: 24px;
  margin-top: 10px;
  display: inline;
}

.main .note img {
  box-shadow: none;
  border-radius: 0;
  min-width: 40px;
  width: 40px;
  margin-bottom: 10px;
}

.main .imageblock img {
  height: auto;
}
.main p span.image {
  display: inline-flex;
  flex-direction: column;
  align-items: center;
  height: 16px;
  width: 20px;
  margin-left: 4px;
  margin-right: 4px;
}
.main p span.image img {
  height: 100%;
  width: 100%;
  margin-bottom: 0;
  margin-top: 0;
  box-shadow: none;
  object-fit: cover;
}

.main .listingblock, .literalblock > .content pre {
  padding: 8px 14px;
  background: #50576A;
  border-radius: 4px;
  margin-bottom: 24px;
  font-size: 14px;
  font-weight: 400;
  color: #CECECE;
}

pre.pygments {
  background: #50576A!important;
  margin-bottom: 0;
}

.main .listingblock  .tok-nt {
  color: #29A9C9;
}

.main .listingblock .tok-s {
  color: #E44C3A;
}

.main .listingblock  .tok-p {
  color: #F5FBFF;
}

.main ol {
  counter-reset: my-awesome-counter;
  list-style: none;
  color: #167BB7;
  margin-left: 20px;
  margin-bottom: 16px;
}

.main ol > li {
  position: relative;
  counter-increment: my-awesome-counter;
  font-weight: 600;
}

.main ol.arabic > li::before {
  content: counter(my-awesome-counter);
  position: absolute;
  top: -1px;
  left: -20px;
  display: flex;
  justify-content: center;
  align-items: center;
  width: 24px;
  height: 24px;
  border-radius: 50%;
  background-color: #E5E7EB;
  color: #6B7280;
  font-weight: 400;
  font-size: inherit;
}
.main ol > li::before {
}

.main ol.arabic:first-child p {
  color: #374151;
  margin-left: 10px;
  font-weight: 400;
}

.main .content-wrapper ul{
  color: #374151;
  list-style: disc;
  margin-left: 20px;
}

.main .content-wrapper ul > li ul {
  margin-left: 0;
  list-style-type: none;
}

.main .content-wrapper ul.nav-tabs{
  list-style: none;
}
.main ol ol {
  margin-left: 30px;
}
.main ol.loweralpha[type=a] > li {
  list-style-type: lower-alpha;
}
.main ol.lowerroman[type=i] > li {
  list-style-type: lower-roman;
}
.main ol li::marker {
  color: #6B7280;
}

.main h2, .main h3 {
  margin-bottom: 16px;
  padding-top: 24px;
}

.main h4 {
  margin-bottom: 16px;
  padding-top: 16px;
}

.content-wrapper h2 a, .content-wrapper h3 a, .content-wrapper h4 a {
  display: none;
  margin-left: 5px;
}

.content-wrapper h4 a svg {
  height: 14px;
  width: auto;
}

.content-wrapper h2:hover a, .content-wrapper h3:hover a, .content-wrapper h4:hover a {
  display: inline;
}

.breadcrumbs-wrapper {
  margin-bottom: 24px;
}
.breadcrumbs-list {
  display: flex;
  align-items: center;
}
.breadcrumbs-list li {
  display: flex;
  align-items: center;
}
.breadcrumbs-list li:not(:last-of-type):after {
  content: '/';
  margin-left: 6px;
  margin-right: 6px;
}
.breadcrumbs-list a {
  display: flex;
  align-items: center;
  letter-spacing: -0.025em;
  color: #374151;
}
.breadcrumbs-list a svg {
  width: 24px;
  height: 24px;
  margin-right: 4px;
}

.note table code {
  color: #374151;
}

.banner .absolute-figure {
  position: absolute;
}

.banner .absolute-figure.abstract-figure {
  right: 0;
}

.banner .absolute-figure.circle2 {
  right: 30%;
  top: 10%;
}

.banner .absolute-figure.circle3 {
  right: 15%;
  top: 10%;
}

.banner .absolute-figure.circle4 {
  left: 5%;
  top: 10%;
}

.banner .absolute-figure.circle5 {
  left: 30%;
}

.banner .absolute-figure.circle6 {
  left: 6%;
  bottom: 0;
}

.banner .absolute-figure.circle7 {
  left: 35%;
  bottom: 15%;
}

.banner .absolute-figure.circle8 {
  left: 55%;
  bottom: 0;
}

.banner .absolute-figure.circle9 {
  bottom: 0;
  right: 0;
}

.doclink {
  position: fixed;
  bottom: 0;
  padding: 0 15px 10px;
  background-color: #FBFDFF;
  z-index: 1000;
  font-size: 12px;
}

.btn-primary, .btn-primary:hover {
  background-color: #167BB7;
  border-color: #167BB7;
}

.card {
  height: 100%;
}
.card-wrapper .card-text {
  min-height: 80px;
  margin-bottom: 16px;
}

.card-wrapper .card-body {
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  padding: 1rem 0.25rem;
}

pre.pygments .tok-c1 {
  color: #29A9C9!important;
}

@media screen and (max-width: 1520px) {
  .card-wrapper .card-text {
    min-height: 110px;
  }
}

.DocSearch.DocSearch-Button {
    margin-left: 0;
    width: 100%;
    height: 38px;
    padding: 0 15px;
    background-color: transparent;
    border: 1px solid #D1D5DB;
    box-shadow: 0 1px 2px rgba(0, 0, 0, .05);
    border-radius: 6px;
    font-weight: 400;
    font-size: 14px;
    line-height: 20px;
    color: #6B7280;
}
.search-form-wrapper .DocSearch-Button-Keys {
  display: none;
}
.DocSearch-Hit-content-wrapper {
  overflow-x: inherit !important;
}
.search-form-wrapper .DocSearch-Button .DocSearch-Search-Icon {
  color: #9CA3AF;
  width: 16px;
  height: 16px;
}
.search-form-wrapper .DocSearch-Button-Placeholder {
  padding-left: 10px;
}
.oneline_with_image img {
    display: inline-block;
    height: 30px;
    margin: 0 10px;
}

.warning table td, .warning table,
.important table td, .important table {
  border: none;
}
.copy-icon {
  display: flex;
  align-items: center;
  justify-content: flex-end;
  height: 40px;
  margin: -8px -14px 8px;
  padding: 0 16px;
  background-color: #3C4356;
  border-top-left-radius: 4px;
  border-top-right-radius: 4px;
}
.copy-icon svg {
  cursor: pointer;
}
.icon-tip {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 502 502' xml:space='preserve'%3E%3Cpath d='M230.523 78.722c-35.583-.342-69.221 13.48-94.756 38.802-25.528 25.316-39.587 58.839-39.587 94.396 0 34.708 13.278 67.567 37.387 92.524 24 24.844 37.216 57.409 37.216 91.697v70.281c0 5.523 4.477 10 10 10h12.756C197.871 491.185 211.53 502 227.676 502s29.805-10.815 34.138-25.578h16.166c5.523 0 10-4.477 10-10v-70.275c0-34.627 12.99-66.961 36.576-91.044 24.522-25.04 38.027-58.133 38.027-93.185 0-35.38-13.723-68.697-38.64-93.812-24.902-25.1-58.079-39.086-93.42-39.384zM227.676 482c-4.787 0-9.076-2.17-11.936-5.578h23.872c-2.86 3.408-7.149 5.578-11.936 5.578zm40.304-25.578h-77.197v-37.125h77.197v37.125zm42.287-165.313c-27.269 27.844-42.287 65.148-42.287 105.039v3.15h-77.197v-3.156c0-39.5-15.211-77-42.832-105.593-20.488-21.208-31.771-49.133-31.771-78.629 0-30.183 11.958-58.663 33.67-80.194 21.72-21.538 50.338-33.226 80.505-33.005 61.882.521 112.228 51.301 112.228 113.197 0 29.789-11.477 57.912-32.316 79.191zM229.381 55.584c5.523 0 10-4.477 10-10V10c0-5.523-4.477-10-10-10s-10 4.477-10 10v35.584c0 5.523 4.477 10 10 10zM85.246 29.896a9.988 9.988 0 0 0 8.099 4.123 9.96 9.96 0 0 0 5.87-1.91c4.468-3.247 5.458-9.5 2.212-13.968l-7.108-9.783C91.073 3.89 84.82 2.9 80.351 6.146c-4.468 3.247-5.458 9.5-2.212 13.968l7.107 9.782zM124.729 84.239a9.988 9.988 0 0 0 8.099 4.123 9.96 9.96 0 0 0 5.87-1.91c4.468-3.246 5.458-9.5 2.212-13.968l-19.113-26.308c-3.246-4.468-9.499-5.459-13.968-2.212-4.468 3.246-5.458 9.5-2.212 13.968l19.112 26.307zM37.031 160.15l33.843 10.996a10.01 10.01 0 0 0 3.092.492c4.215 0 8.136-2.687 9.509-6.913 1.707-5.253-1.168-10.894-6.42-12.601l-33.843-10.996c-5.251-1.705-10.894 1.168-12.601 6.42-1.707 5.254 1.167 10.895 6.42 12.602zM84.808 260.51c-1.707-5.253-7.346-8.126-12.601-6.42l-33.843 10.996c-5.252 1.707-8.127 7.348-6.42 12.601 1.373 4.226 5.293 6.913 9.509 6.913a10.01 10.01 0 0 0 3.092-.492l33.843-10.996c5.252-1.708 8.126-7.349 6.42-12.602zM102.626 391.668c-4.467-3.246-10.721-2.255-13.968 2.212l-8.903 12.253c-3.246 4.468-2.256 10.722 2.212 13.968a9.952 9.952 0 0 0 5.87 1.91 9.99 9.99 0 0 0 8.099-4.123l8.903-12.253c3.246-4.467 2.256-10.72-2.213-13.967z'/%3E%3Cpath d='M134.544 347.736c-4.468-3.246-10.722-2.255-13.968 2.212l-8.845 12.175c-3.246 4.468-2.255 10.722 2.212 13.968a9.952 9.952 0 0 0 5.87 1.91 9.99 9.99 0 0 0 8.099-4.123l8.845-12.175c3.246-4.467 2.255-10.721-2.213-13.967zM338.347 336.895c-3.246-4.468-9.499-5.459-13.968-2.212-4.468 3.247-5.458 9.5-2.212 13.968l20.916 28.789a9.988 9.988 0 0 0 8.099 4.123 9.96 9.96 0 0 0 5.87-1.91c4.468-3.247 5.458-9.5 2.212-13.968l-20.917-28.79zM426.045 260.984l-33.843-10.997c-5.252-1.705-10.894 1.168-12.601 6.42-1.707 5.252 1.168 10.894 6.42 12.601l33.843 10.997a10.01 10.01 0 0 0 3.092.492c4.215 0 8.136-2.687 9.509-6.913 1.707-5.251-1.167-10.893-6.42-12.6zM471.39 130.367c-1.706-5.252-7.347-8.127-12.601-6.42l-14.678 4.769c-5.252 1.707-8.127 7.348-6.42 12.601 1.373 4.226 5.293 6.913 9.509 6.913a10.01 10.01 0 0 0 3.092-.492l14.678-4.769c5.252-1.708 8.126-7.349 6.42-12.602zM387.777 167.536a10.01 10.01 0 0 0 3.092-.492l25.994-8.446c5.252-1.707 8.127-7.348 6.42-12.601-1.707-5.252-7.347-8.127-12.601-6.42l-25.994 8.446c-5.252 1.707-8.127 7.348-6.42 12.601 1.374 4.225 5.294 6.912 9.509 6.912zM320.89 83.916a9.952 9.952 0 0 0 5.87 1.91 9.99 9.99 0 0 0 8.099-4.123l20.916-28.789c3.246-4.468 2.255-10.722-2.212-13.968-4.469-3.246-10.722-2.255-13.968 2.212l-20.916 28.789c-3.248 4.469-2.257 10.722 2.211 13.969zM288.349 135.549c-11.289-8.76-24.609-14.981-38.521-17.992-5.395-1.169-10.721 2.26-11.889 7.659-1.168 5.398 2.261 10.721 7.659 11.889 11.007 2.382 21.55 7.308 30.491 14.245a9.954 9.954 0 0 0 6.124 2.1 9.981 9.981 0 0 0 7.907-3.87c3.385-4.363 2.592-10.645-1.771-14.031zM202.914 119.066c-41.096 11.729-69.797 49.799-69.797 92.579 0 5.523 4.477 10 10 10s10-4.477 10-10c0-33.895 22.735-64.056 55.287-73.346 5.311-1.516 8.387-7.05 6.872-12.361-1.518-5.31-7.052-8.388-12.362-6.872z'/%3E%3C/svg%3E");
  width: 42px;
  height: 42px;
  background-repeat: no-repeat;
  background-position: center;
}
.main table td.icon {
  text-align: center;
}
.icon-warning {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='554.2' height='554.199' xml:space='preserve' fill='%23E44C3A'%3E%3Cpath d='M538.5 386.199 356.5 70.8a91.803 91.803 0 0 0-79.501-45.9c-32.8 0-63.1 17.5-79.5 45.9L12.3 391.6a91.793 91.793 0 0 0 0 91.8c16.4 28.4 46.7 45.9 79.5 45.9H462.4c50.7 0 91.8-41.101 91.8-91.8 0-19-5.8-36.7-15.7-51.301zm-222.2 30.7c0 21.7-16.7 38.3-39.2 38.3s-39.2-16.6-39.2-38.3V416c0-21.601 16.7-38.301 39.2-38.301S316.3 394.3 316.3 416v.899zm.9-258.199-19.4 169.4c-1.3 12.2-9.4 19.8-20.7 19.8s-19.4-7.7-20.7-19.8L237 158.6c-1.3-13.1 5.801-23 18-23h44.1c12.2.1 19.4 10 18.1 23.1z'/%3E%3C/svg%3E%0A");
  width: 40px;
  height: 39px;
  background-size: 100%;
}
.icon-important {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100'%3E%3Cg transform='scale(.521)'%3E%3Ccircle cx='96' cy='96' r='74' fill='%23E44C3A'/%3E%3Cpath d='M86 48h20l-4 72H90z' fill='%23fff'/%3E%3Ccircle cx='96' cy='140' r='10' fill='%23fff'/%3E%3C/g%3E%3C/svg%3E");
  width: 40px;
  height: 40px;
  background-size: 100%;
}
.main .admonitionblock.tip table,
.main .admonitionblock.tip table td {
  border: none;
}
/*Light box start*/

.lightbox-modal {
  display: none;
  position: fixed;
  top: 50%;
  left: 50%;
  background-color: #ebebeb;
  padding: 20px;
  transform: translate(-50%, -50%);
  z-index: 100;
  border-radius: 8px;
  max-width: 95vw;
  width: 100%;
  height: 90vh;
}
.lightbox-modal .img {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 100%;
  height: 100%;
}
.lightbox-modal .img img {
  width: 100%;
  height: 100%;
  object-fit: contain;
  margin: 0;
}
@media (max-width: 1023px) {
  .lightbox-modal {
    height: auto;
    max-width: 95vw;
  }
}
#close-ligtbox {
  position: absolute;
  right: -35px;
  top: -35px;
  display: block;
  width: 30px;
  font-size: 36px;
  border-radius: 8px;
  cursor: pointer;
  color: #fff;
}
@media (max-width: 1023px) {
  #close-ligtbox {
    right: 0;
    top: -40px;
    width: 24px;
    font-size: 28px;
  }
}
.overlay {
  display: none;
  position: fixed;
  background-color: rgba(0,0,0,.5);
  left: 0;
  top: 0;
  right: 0;
  bottom: 0;
  z-index: 99;
}
.imageblock img, .paragraph .image img {
  cursor: pointer;
}
/*Light box end*/

.ulist {
  margin-left: 10px;
}
.main ol.arabic:first-child .ulist p,
.ulist ul li p {
  margin-left: 0!important;
}

.ulist li::marker {
  font-size: 20px;
  color: #6d7176;
}
.ulist li ul {
  list-style-type: none;
}
.ulist li ul li {
  position: relative;
  padding-left: 24px;
}
.ulist li ul li:before {
  content: '';
  position: absolute;
  left: 0;
  top: 9px;
  width: 8px;
  height: 8px;
  background-color: #E5E7EB;
  border: 1px solid #9CA3AF;
  border-radius: 100%;
}
.right-side-menu ul ul li:not(:last-child) {
  margin-bottom: 5px;
}
.imageblock .title {
  margin-bottom: 24px;
}
</style>
<style>pre.pygments .hll { background-color: #49483e }
pre.pygments { background: #272822; color: #f8f8f2 }
pre.pygments .tok-c { color: #75715e } /* Comment */
pre.pygments .tok-err { color: #960050; background-color: #1e0010 } /* Error */
pre.pygments .tok-k { color: #66d9ef } /* Keyword */
pre.pygments .tok-l { color: #ae81ff } /* Literal */
pre.pygments .tok-n { color: #f8f8f2 } /* Name */
pre.pygments .tok-o { color: #f92672 } /* Operator */
pre.pygments .tok-p { color: #f8f8f2 } /* Punctuation */
pre.pygments .tok-ch { color: #75715e } /* Comment.Hashbang */
pre.pygments .tok-cm { color: #75715e } /* Comment.Multiline */
pre.pygments .tok-cp { color: #75715e } /* Comment.Preproc */
pre.pygments .tok-cpf { color: #75715e } /* Comment.PreprocFile */
pre.pygments .tok-c1 { color: #75715e } /* Comment.Single */
pre.pygments .tok-cs { color: #75715e } /* Comment.Special */
pre.pygments .tok-gd { color: #f92672 } /* Generic.Deleted */
pre.pygments .tok-ge { font-style: italic } /* Generic.Emph */
pre.pygments .tok-gi { color: #a6e22e } /* Generic.Inserted */
pre.pygments .tok-go { color: #66d9ef } /* Generic.Output */
pre.pygments .tok-gp { color: #f92672; font-weight: bold } /* Generic.Prompt */
pre.pygments .tok-gs { font-weight: bold } /* Generic.Strong */
pre.pygments .tok-gu { color: #75715e } /* Generic.Subheading */
pre.pygments .tok-kc { color: #66d9ef } /* Keyword.Constant */
pre.pygments .tok-kd { color: #66d9ef } /* Keyword.Declaration */
pre.pygments .tok-kn { color: #f92672 } /* Keyword.Namespace */
pre.pygments .tok-kp { color: #66d9ef } /* Keyword.Pseudo */
pre.pygments .tok-kr { color: #66d9ef } /* Keyword.Reserved */
pre.pygments .tok-kt { color: #66d9ef } /* Keyword.Type */
pre.pygments .tok-ld { color: #e6db74 } /* Literal.Date */
pre.pygments .tok-m { color: #ae81ff } /* Literal.Number */
pre.pygments .tok-s { color: #e6db74 } /* Literal.String */
pre.pygments .tok-na { color: #a6e22e } /* Name.Attribute */
pre.pygments .tok-nb { color: #f8f8f2 } /* Name.Builtin */
pre.pygments .tok-nc { color: #a6e22e } /* Name.Class */
pre.pygments .tok-no { color: #66d9ef } /* Name.Constant */
pre.pygments .tok-nd { color: #a6e22e } /* Name.Decorator */
pre.pygments .tok-ni { color: #f8f8f2 } /* Name.Entity */
pre.pygments .tok-ne { color: #a6e22e } /* Name.Exception */
pre.pygments .tok-nf { color: #a6e22e } /* Name.Function */
pre.pygments .tok-nl { color: #f8f8f2 } /* Name.Label */
pre.pygments .tok-nn { color: #f8f8f2 } /* Name.Namespace */
pre.pygments .tok-nx { color: #a6e22e } /* Name.Other */
pre.pygments .tok-py { color: #f8f8f2 } /* Name.Property */
pre.pygments .tok-nt { color: #f92672 } /* Name.Tag */
pre.pygments .tok-nv { color: #f8f8f2 } /* Name.Variable */
pre.pygments .tok-ow { color: #f92672 } /* Operator.Word */
pre.pygments .tok-w { color: #f8f8f2 } /* Text.Whitespace */
pre.pygments .tok-mb { color: #ae81ff } /* Literal.Number.Bin */
pre.pygments .tok-mf { color: #ae81ff } /* Literal.Number.Float */
pre.pygments .tok-mh { color: #ae81ff } /* Literal.Number.Hex */
pre.pygments .tok-mi { color: #ae81ff } /* Literal.Number.Integer */
pre.pygments .tok-mo { color: #ae81ff } /* Literal.Number.Oct */
pre.pygments .tok-sa { color: #e6db74 } /* Literal.String.Affix */
pre.pygments .tok-sb { color: #e6db74 } /* Literal.String.Backtick */
pre.pygments .tok-sc { color: #e6db74 } /* Literal.String.Char */
pre.pygments .tok-dl { color: #e6db74 } /* Literal.String.Delimiter */
pre.pygments .tok-sd { color: #e6db74 } /* Literal.String.Doc */
pre.pygments .tok-s2 { color: #e6db74 } /* Literal.String.Double */
pre.pygments .tok-se { color: #ae81ff } /* Literal.String.Escape */
pre.pygments .tok-sh { color: #e6db74 } /* Literal.String.Heredoc */
pre.pygments .tok-si { color: #e6db74 } /* Literal.String.Interpol */
pre.pygments .tok-sx { color: #e6db74 } /* Literal.String.Other */
pre.pygments .tok-sr { color: #e6db74 } /* Literal.String.Regex */
pre.pygments .tok-s1 { color: #e6db74 } /* Literal.String.Single */
pre.pygments .tok-ss { color: #e6db74 } /* Literal.String.Symbol */
pre.pygments .tok-bp { color: #f8f8f2 } /* Name.Builtin.Pseudo */
pre.pygments .tok-fm { color: #a6e22e } /* Name.Function.Magic */
pre.pygments .tok-vc { color: #f8f8f2 } /* Name.Variable.Class */
pre.pygments .tok-vg { color: #f8f8f2 } /* Name.Variable.Global */
pre.pygments .tok-vi { color: #f8f8f2 } /* Name.Variable.Instance */
pre.pygments .tok-vm { color: #f8f8f2 } /* Name.Variable.Magic */
pre.pygments .tok-il { color: #ae81ff } /* Literal.Number.Integer.Long */</style></head><body data-spy="scroll" data-target="#toc" class="book"><header class="header"><div class="header-wrapper"><div class="container-fluid"><div class="row flex-xl-nowrap"><div class="header-logo"><div class="logo"><a href="https://docs.killbill.io"><img src="https://github.com/killbill/killbill-docs/raw/v3/userguide/assets/img/logo.png" style="height:41px" alt="KillBill Docs"></a></div></div><div class="header-search"><div class="search-form-wrapper"><div id="docsearch" style="height: 43px; display: flex; align-items: center; width: 100%;"></div></div></div></div></div></div></header><main class="main"><div class="container-fluid"><div class="row flex-xl-nowrap"><div class="sidebar-wrapper"><aside class="sidebar"><nav class="sidebar-nav"><ul class="nav navbar-nav"><li><div class="icon-title"><div class="left-part"><a class="bd-toc-link main-link">Getting Started</a></div><svg class="chevron" width="11" height="6" viewBox="0 0 11 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.5024 5.70711C10.1119 6.09763 9.47871 6.09763 9.08818 5.70711L5.7953 2.41421L2.50241 5.70711C2.11188 6.09763 1.47872 6.09763 1.0882 5.70711C0.697672 5.31658 0.697672 4.68342 1.0882 4.29289L5.08819 0.292893C5.47871 -0.0976311 6.11188 -0.0976311 6.5024 0.292893L10.5024 4.29289C10.8929 4.68342 10.8929 5.31658 10.5024 5.70711Z" fill="#D1D5DB"/></svg></div><ul class="nav navbar-nav"><li><a class="nav-link" href="/latest/what_is_kill_bill.html">What is Kill Bill?</a></li><li><a class="nav-link" href="/latest/getting_started.html">Getting Started (Installation)</a></li><li><a class="nav-link" href="/latest/quick_start_with_kaui.html">Quick Start with Kaui</a></li><li><a class="nav-link" href="/latest/quick_start_with_kb_api.html">Quick Start with the Kill Bill API</a></li></ul></li><li><div class="icon-title"><div class="left-part"><a class="bd-toc-link main-link">Installation</a></div><svg class="chevron" width="11" height="6" viewBox="0 0 11 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.5024 5.70711C10.1119 6.09763 9.47871 6.09763 9.08818 5.70711L5.7953 2.41421L2.50241 5.70711C2.11188 6.09763 1.47872 6.09763 1.0882 5.70711C0.697672 5.31658 0.697672 4.68342 1.0882 4.29289L5.08819 0.292893C5.47871 -0.0976311 6.11188 -0.0976311 6.5024 0.292893L10.5024 4.29289C10.8929 4.68342 10.8929 5.31658 10.5024 5.70711Z" fill="#D1D5DB"/></svg></div><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a class="nav-link" href="/latest/stripe_plugin.html">Kill Bill + Stripe DIY</a></li><li><a class="nav-link" href="/latest/userguide_deployment.html">Going to Production</a></li><li><a class="nav-link" href="/latest/how-to-upgrade-the-database.html">Database Migrations</a></li><li><a class="nav-link" href="/latest/PostgreSQL.html">PostgreSQL Setup</a></li><li><a class="nav-link" href="https://github.com/killbill/killbill/releases" onclick="getOutboundLink('https://github.com/killbill/killbill/releases'); return false;">Release&nbsp;Notes</a></li></ul></li><li><div class="icon-title"><div class="left-part"><a class="bd-toc-link main-link">AWS</a></div><svg class="chevron" width="11" height="6" viewBox="0 0 11 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.5024 5.70711C10.1119 6.09763 9.47871 6.09763 9.08818 5.70711L5.7953 2.41421L2.50241 5.70711C2.11188 6.09763 1.47872 6.09763 1.0882 5.70711C0.697672 5.31658 0.697672 4.68342 1.0882 4.29289L5.08819 0.292893C5.47871 -0.0976311 6.11188 -0.0976311 6.5024 0.292893L10.5024 4.29289C10.8929 4.68342 10.8929 5.31658 10.5024 5.70711Z" fill="#D1D5DB"/></svg></div><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a class="nav-link" href="/latest/how-to-set-up-a-single-tier-system.html">Single-Tier Setup</a></li><li><a class="nav-link" href="/latest/how-to-set-up-a-multi-tier-system.html">Multi-Tier Setup</a></li><li><a class="nav-link" href="/latest/how-to-set-up-a-cloud-formation-system.html">CloudFormation Setup</a></li><li class="bd-sidenav-active"><a class="nav-link" href="/latest/how-to-maintain-a-single-tier-system.html">Single-Tier Maintenance</a></li><li><a class="nav-link" href="/latest/how-to-maintain-a-multi-tier-system.html">Multi-Tier Maintenance</a></li><li><a class="nav-link" href="/latest/how-to-maintain-a-cloud-formation-system.html">CloudFormation Maintenance</a></li></ul></li><li><div class="icon-title"><div class="left-part"><a class="bd-toc-link main-link">Manuals</a></div><svg class="chevron" width="11" height="6" viewBox="0 0 11 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.5024 5.70711C10.1119 6.09763 9.47871 6.09763 9.08818 5.70711L5.7953 2.41421L2.50241 5.70711C2.11188 6.09763 1.47872 6.09763 1.0882 5.70711C0.697672 5.31658 0.697672 4.68342 1.0882 4.29289L5.08819 0.292893C5.47871 -0.0976311 6.11188 -0.0976311 6.5024 0.292893L10.5024 4.29289C10.8929 4.68342 10.8929 5.31658 10.5024 5.70711Z" fill="#D1D5DB"/></svg></div><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a class="nav-link" href="/latest/userguide_subscription.html">Subscription&nbsp;Billing</a></li><li><a class="nav-link" href="/latest/userguide_payment.html">Payment Processing</a></li><li><a class="nav-link" href="/latest/userguide_kaui.html">Kaui, the Administrative&nbsp;UI</a></li><li><a class="nav-link" href="/latest/email-notification-plugin.html">Email Notification Plugin</a></li><li><a class="nav-link" href="/latest/custom-email-invoice-formatter.html">Custom Email Formatter</a></li><li><a class="nav-link" href="/latest/userguide_analytics.html">Analytics Plugin</a></li><li><a class="nav-link" href="/latest/userguide_configuration.html">Kill Bill&nbsp;Configuration</a></li><li><a class="nav-link" href="/latest/internationalization.html">Kill Bill&nbsp;Internationalization</a></li><li><a class="nav-link" href="/latest/migration_guide.html">Migrating to Kill Bill</a></li></ul></li><li><div class="icon-title"><div class="left-part"><a class="bd-toc-link main-link">Tutorials</a></div><svg class="chevron" width="11" height="6" viewBox="0 0 11 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.5024 5.70711C10.1119 6.09763 9.47871 6.09763 9.08818 5.70711L5.7953 2.41421L2.50241 5.70711C2.11188 6.09763 1.47872 6.09763 1.0882 5.70711C0.697672 5.31658 0.697672 4.68342 1.0882 4.29289L5.08819 0.292893C5.47871 -0.0976311 6.11188 -0.0976311 6.5024 0.292893L10.5024 4.29289C10.8929 4.68342 10.8929 5.31658 10.5024 5.70711Z" fill="#D1D5DB"/></svg></div><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a class="nav-link" href="/latest/plan_alignment.html">Plans Alignments</a></li><li><a class="nav-link" href="/latest/overdue.html">Overdue System</a></li><li><a class="nav-link" href="/latest/consumable_in_arrear.html">In Arrear UsageBilling</a></li><li><a class="nav-link" href="/latest/ha.html">Hierarchical Accounts</a></li><li><a class="nav-link" href="/latest/catalog-examples.html">Catalog Examples</a></li><li><a class="nav-link" href="/latest/invoice_examples.html">Invoice Examples</a></li><li><a class="nav-link" href="/latest/invoice_templates.html">Invoice Templates</a></li></ul></li><li><div class="icon-title"><div class="left-part"><a class="bd-toc-link main-link">Integration</a></div><svg class="chevron" width="11" height="6" viewBox="0 0 11 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.5024 5.70711C10.1119 6.09763 9.47871 6.09763 9.08818 5.70711L5.7953 2.41421L2.50241 5.70711C2.11188 6.09763 1.47872 6.09763 1.0882 5.70711C0.697672 5.31658 0.697672 4.68342 1.0882 4.29289L5.08819 0.292893C5.47871 -0.0976311 6.11188 -0.0976311 6.5024 0.292893L10.5024 4.29289C10.8929 4.68342 10.8929 5.31658 10.5024 5.70711Z" fill="#D1D5DB"/></svg></div><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a class="nav-link" href="http://killbill.github.io/slate" onclick="getOutboundLink('http://killbill.github.io/slate'); return false;">REST API Reference</a></li><li><a class="nav-link" href="/latest/swagger_documentation.html">Swagger UI Documentation</a></li><li><a class="nav-link" href="/latest/postman.html">Postman Integration</a></li><li><a class="nav-link" href="/latest/debugging.html">Debugging</a></li><li><a class="nav-link" href="/latest/push_notifications.html">Push Notifications</a></li><li><a class="nav-link" href="/latest/kill_bill_events.html">Kill Bill Events</a></li></ul></li><li><div class="icon-title"><div class="left-part"><a class="bd-toc-link main-link">Plugin Development</a></div><svg class="chevron" width="11" height="6" viewBox="0 0 11 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.5024 5.70711C10.1119 6.09763 9.47871 6.09763 9.08818 5.70711L5.7953 2.41421L2.50241 5.70711C2.11188 6.09763 1.47872 6.09763 1.0882 5.70711C0.697672 5.31658 0.697672 4.68342 1.0882 4.29289L5.08819 0.292893C5.47871 -0.0976311 6.11188 -0.0976311 6.5024 0.292893L10.5024 4.29289C10.8929 4.68342 10.8929 5.31658 10.5024 5.70711Z" fill="#D1D5DB"/></svg></div><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a class="nav-link" href="/latest/plugin_introduction.html">Plugin Introduction</a></li><li class="bd-sidenav-active"><a class="nav-link" href="/latest/plugin_development.html">Plugin Development</a></li><li class="bd-sidenav-active"><a class="nav-link" href="/latest/plugin_installation.html">Plugin Installation</a></li><li><a class="nav-link" href="/latest/plugin_use_cases.html">Special Plugin Use Cases</a></li><li><a class="nav-link" href="/latest/notification_plugin.html">Notification Plugins</a></li><li><a class="nav-link" href="/latest/payment_plugin.html">Payment Plugins</a></li><li><a class="nav-link" href="/latest/payment_control_plugin.html">Payment Control Plugins</a></li><li><a class="nav-link" href="/latest/usage_plugin.html">Usage Plugins</a></li><li><a class="nav-link" href="/latest/invoice_plugin.html">Invoice Plugins</a></li><li><a class="nav-link" href="/latest/catalog_plugin.html">Catalog Plugins</a></li><li><a class="nav-link" href="/latest/entitlement_plugin.html">Entitlement Plugins</a></li></ul></li><li><div class="icon-title"><div class="left-part"><a class="bd-toc-link main-link">Operational Guides</a></div><svg class="chevron" width="11" height="6" viewBox="0 0 11 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.5024 5.70711C10.1119 6.09763 9.47871 6.09763 9.08818 5.70711L5.7953 2.41421L2.50241 5.70711C2.11188 6.09763 1.47872 6.09763 1.0882 5.70711C0.697672 5.31658 0.697672 4.68342 1.0882 4.29289L5.08819 0.292893C5.47871 -0.0976311 6.11188 -0.0976311 6.5024 0.292893L10.5024 4.29289C10.8929 4.68342 10.8929 5.31658 10.5024 5.70711Z" fill="#D1D5DB"/></svg></div><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a class="nav-link" href="/latest/deploy_to_kubernetes.html">Kubernetes (K8s) Deployment</a></li><li class="bd-sidenav-active"><a class="nav-link" href="/latest/user_management.html">Users, Roles, and Permissions</a></li><li><a class="nav-link" href="/latest/plugin_management.html">Plugin Management</a></li><li><a class="nav-link" href="/latest/aws-tools.html">AWS Analytics Tools</a></li></ul></li><li><div class="icon-title"><div class="left-part"><a class="bd-toc-link main-link">Client Libraries</a></div><svg class="chevron" width="11" height="6" viewBox="0 0 11 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.5024 5.70711C10.1119 6.09763 9.47871 6.09763 9.08818 5.70711L5.7953 2.41421L2.50241 5.70711C2.11188 6.09763 1.47872 6.09763 1.0882 5.70711C0.697672 5.31658 0.697672 4.68342 1.0882 4.29289L5.08819 0.292893C5.47871 -0.0976311 6.11188 -0.0976311 6.5024 0.292893L10.5024 4.29289C10.8929 4.68342 10.8929 5.31658 10.5024 5.70711Z" fill="#D1D5DB"/></svg></div><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a class="nav-link" href="/latest/java_client.html">Java</a></li><li><a class="nav-link" href="http://github.com/killbill/killbill-client-ruby" onclick="getOutboundLink('http://github.com/killbill/killbill-client-ruby'); return false;">Ruby</a></li><li><a class="nav-link" href="http://github.com/killbill/killbill-client-php" onclick="getOutboundLink('http://github.com/killbill/killbill-client-php'); return false;">PHP</a></li><li><a class="nav-link" href="http://github.com/killbill/killbill-client-js" onclick="getOutboundLink('http://github.com/killbill/killbill-client-js'); return false;">Node.js</a></li><li><a class="nav-link" href="http://github.com/killbill/killbill-client-python" onclick="getOutboundLink('http://github.com/killbill/killbill-client-python'); return false;">Python</a></li><li><a class="nav-link" href="http://github.com/killbill/kbcli" onclick="getOutboundLink('http://github.com/killbill/kbcli'); return false;">Go</a></li></ul></li><li><div class="icon-title"><div class="left-part"><a class="bd-toc-link main-link">About Kill Bill</a></div><svg class="chevron" width="11" height="6" viewBox="0 0 11 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.5024 5.70711C10.1119 6.09763 9.47871 6.09763 9.08818 5.70711L5.7953 2.41421L2.50241 5.70711C2.11188 6.09763 1.47872 6.09763 1.0882 5.70711C0.697672 5.31658 0.697672 4.68342 1.0882 4.29289L5.08819 0.292893C5.47871 -0.0976311 6.11188 -0.0976311 6.5024 0.292893L10.5024 4.29289C10.8929 4.68342 10.8929 5.31658 10.5024 5.70711Z" fill="#D1D5DB"/></svg></div><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a class="nav-link" href="/latest/demo.html">Demo</a></li><li><a class="nav-link" href="/latest/features.html">Features List</a></li><li><a class="nav-link" href="/latest/faq.html">Technical FAQs</a></li><li><a class="nav-link" href="/latest/Kill-Bill-Glossary.html">Glossary</a></li></ul></li><li><div class="icon-title"><div class="left-part"><a class="bd-toc-link main-link">Internal</a></div><svg class="chevron" width="11" height="6" viewBox="0 0 11 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.5024 5.70711C10.1119 6.09763 9.47871 6.09763 9.08818 5.70711L5.7953 2.41421L2.50241 5.70711C2.11188 6.09763 1.47872 6.09763 1.0882 5.70711C0.697672 5.31658 0.697672 4.68342 1.0882 4.29289L5.08819 0.292893C5.47871 -0.0976311 6.11188 -0.0976311 6.5024 0.292893L10.5024 4.29289C10.8929 4.68342 10.8929 5.31658 10.5024 5.70711Z" fill="#D1D5DB"/></svg></div><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a class="nav-link" href="/latest/internal_design.html">Internal Design</a></li><li><a class="nav-link" href="/latest/entitlement_subsystem.html">Entitlement Subsystem</a></li><li><a class="nav-link" href="/latest/invoice_subsystem.html">Invoice Subsystem</a></li><li><a class="nav-link" href="/latest/development.html">Development Environment</a></li></ul></li><li><div class="icon-title"><div class="left-part"><a class="bd-toc-link main-link">References</a></div><svg class="chevron" width="11" height="6" viewBox="0 0 11 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.5024 5.70711C10.1119 6.09763 9.47871 6.09763 9.08818 5.70711L5.7953 2.41421L2.50241 5.70711C2.11188 6.09763 1.47872 6.09763 1.0882 5.70711C0.697672 5.31658 0.697672 4.68342 1.0882 4.29289L5.08819 0.292893C5.47871 -0.0976311 6.11188 -0.0976311 6.5024 0.292893L10.5024 4.29289C10.8929 4.68342 10.8929 5.31658 10.5024 5.70711Z" fill="#D1D5DB"/></svg></div><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a class="nav-link" href="https://github.com/killbill/killbill-docs/tree/v3/swagger" onclick="getOutboundLink('https://github.com/killbill/killbill-docs/tree/v3/swagger'); return false;">Swagger&nbsp;API Schema</a></li><li><a class="nav-link" href="/latest/catalog.xsd">Catalog XSD Reference</a></li><li><a class="nav-link" href="/latest/overdue.xsd">Overdue XSD Reference</a></li></ul></li></ul><div class="sidebar-toggler"></div></nav><script src="https://code.jquery.com/jquery-3.6.1.min.js"></script><script>
  let $ = jQuery;
  $('.sidebar-nav .icon-title').on('click', function (e) {
    e.preventDefault();
    $('.sidebar-nav .nav.navbar-nav .nav.navbar-nav').slideUp(200);
    $('.sidebar-nav > .navbar-nav > li').removeClass('open');

    if($(this).next().is(':visible')){
      $('.sidebar-nav .nav.navbar-nav .nav.navbar-nav').slideUp(200);
      $('.sidebar-nav > .navbar-nav > li').removeClass('open');
    } else {
      $(this).parent().addClass('open');
      $(this).next().slideDown(200);
    }
  });

  let pageURL = $(location).attr("href");
  $('.nav-link').each(function() {
    if (pageURL.includes($(this).attr('href'))) {
      $(this).parent().addClass('list-item-active');
      $(this).parent().parent().addClass('active-list');
      $(this).parent().parent().prev().addClass('bd-link-active-wrap');
    }
  });
</script><a class="doclink" href="mailto:support@killbill.io">Report a doc problem</a></aside></div><div class="main-wrapper"><article class="content-wrapper"><div class="banner"><div class="bg-image"><svg class="absolute-figure circle1" width="41" height="38" viewBox="0 0 41 38" fill="none" xmlns="http://www.w3.org/2000/svg">
  <ellipse cx="12.5" cy="10.5" rx="28.5" ry="27.5" fill="white" fill-opacity="0.2"/>
</svg>
<svg class="absolute-figure circle2" width="20" height="19" viewBox="0 0 20 19" fill="none" xmlns="http://www.w3.org/2000/svg">
  <ellipse cx="10" cy="9.5" rx="10" ry="9.5" fill="white" fill-opacity="0.2"/>
</svg>
<svg class="absolute-figure circle3" width="97" height="97" viewBox="0 0 97 97" fill="none" xmlns="http://www.w3.org/2000/svg">
  <circle cx="48.5" cy="48.5" r="48.5" fill="white" fill-opacity="0.4"/>
</svg>
<svg class="absolute-figure circle4" width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
  <circle cx="7" cy="7" r="7" fill="white" fill-opacity="0.2"/>
</svg>
<svg class="absolute-figure circle5" width="65" height="23" viewBox="0 0 65 23" fill="none" xmlns="http://www.w3.org/2000/svg">
  <circle cx="32.5" cy="-9.5" r="32.5" fill="white" fill-opacity="0.2"/>
</svg>
<svg class="absolute-figure circle6" width="48" height="31" viewBox="0 0 48 31" fill="none" xmlns="http://www.w3.org/2000/svg">
  <circle cx="24" cy="24" r="24" fill="white" fill-opacity="0.2"/>
</svg>
<svg class="absolute-figure circle7" width="20" height="19" viewBox="0 0 20 19" fill="none" xmlns="http://www.w3.org/2000/svg">
  <ellipse cx="10" cy="9.5" rx="10" ry="9.5" fill="white" fill-opacity="0.2"/>
</svg>
<svg class="absolute-figure circle8" width="20" height="10" viewBox="0 0 20 10" fill="none" xmlns="http://www.w3.org/2000/svg">
  <ellipse cx="10" cy="9.5" rx="10" ry="9.5" fill="white" fill-opacity="0.2"/>
</svg>
<svg class="absolute-figure circle9" width="49" height="48" viewBox="0 0 49 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <circle cx="48.5" cy="48.5" r="48.5" fill="white" fill-opacity="0.2"/>
</svg>
<svg class="absolute-figure abstract-figure" width="703" height="174" viewBox="0 0 703 174" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M25.5 246C-96 87.7673 245.949 67.3215 475.548 64.1799C705.146 61.0384 565.01 -188.501 629.653 -188.741C694.297 -188.982 766.062 221.014 766.062 221.014L297.072 460.733C297.072 460.733 147 404.233 25.5 246Z" fill="white" fill-opacity="0.2"/>
</svg></div><h1>Kill Bill deployment guide</h1></div><div id="content"><div id="preamble"><div class="sectionbody"><div class="paragraph"><p>This deployment guide lists the best practices to consider once you are ready to move to production.</p></div></div></div>
<div class="sect1"><h2 id="_overview">Overview</h2><div class="sectionbody"><div class="sect2"><h3 id="_best_practices">Best practices</h3><div class="paragraph"><p>Kill Bill is fundamentally a backend system, so the following considerations should apply:</p></div>
<div class="ulist"><ul><li><p>Don&#8217;t make the system visible to the outside world, instead you should have a front end system, or a reverse proxy in front of it (e.g. if you need to handle gateway notifications like PayPal IPN/Internal Payment Notification).</p></li><li><p>Always deploy at least 2 instances (for reliability purposes) in front of a load balancer.</p></li><li><p>Setup your database with a master and a slave instances, and configure it to take regular snapshots.</p></li><li><p>Aggregate your logs across instances (for example using <a href="http://logstash.net/">LogStash</a> or <a href="https://www.graylog.org/">GrayLog2</a>).</p></li><li><p>Look at the all the existing Kill Bill JMX metrics (using VisualVM, jconsole, &#8230;&#8203;) and set some alerts (for instance by using the following <a href="https://github.com/killbill/nagios-jmx-plugin">script</a>).</p></li><li><p>Configure your system properly, especially when it comes to the settings of the bus and notification queue.</p></li></ul></div></div>
<div class="sect2"><h3 id="_pre_and_post_deployment_checklist">Pre- and Post-deployment checklist</h3><div class="ulist"><ul><li><p>Test, test, test: we work hard to make the core of the platform solid. But your deployment, with your own combination of plugins and configuration (catalog, overdue, etc.) is unique. Write business-level regression tests that you can run before each upgrade.</p></li><li><p>Timezone of your servers and databases has to be UTC and ensure NTP is properly configured to avoid any drift between instances.</p></li><li><p>Consider encrypting sensitive configuration properties, like database passwords, with Jasypt. See <a class="bare" href="http://www.jasypt.org/cli.html">http://www.jasypt.org/cli.html</a> for details on how to generate encrypted values. Example configuration:</p></li></ul></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="properties"><span></span><span class="tok-na">-Dorg.killbill.server.enableJasypt</span><span class="tok-o">=</span><span class="tok-s">true</span>
<span class="tok-na">-Djasypt.encryptor.password</span><span class="tok-o">=</span><span class="tok-s">myTopSecretPassword</span>
<span class="tok-na">-Djasypt.encryptor.algorithm</span><span class="tok-o">=</span><span class="tok-s">PBeWithshA1andDeSede</span>
<span class="tok-na">-Dorg.killbill.billing.osgi.dao.password</span><span class="tok-o">=</span><span class="tok-s">ENC(+PeDGcp3DTonUpB3lPuoegack9kb0hJi)</span></code></pre></div></div>
<div class="ulist"><ul><li><p>Make sure the servers have enough entropy: <code>/proc/sys/kernel/random/entropy_avail</code> should be &gt; 3k (otherwise install <code>haveged</code> / <code>rng-tools</code>). Kill Bill should also be started with <code>-Djava.security.egd=file:/dev/./urandom</code>.</p></li><li><p>Adjust <code>org.killbill.security.shiroNbHashIterations</code> as needed. This setting configures the number of iterations run to hash API secrets and user passwords. The default value is high for security reasons, but can be adjusted down if required (e.g. for Docker <code>-e KILLBILL_SECURITY_SHIRO_NB_HASH_ITERATIONS=1</code>) as this can have a significant performance impact. Note that changing the value requires re-hashing manually all tenants secrets and user passwords.</p></li><li><p>Make sure your database and queues configuration are adequate: the <code>bus_events</code> table should almost always be empty and the <code>notifications</code> table should never have any <code>AVAILABLE</code> entry with an effective date in the past. Otherwise, in both cases, the system will be late (invoices not generated, etc.). These two metrics should always be monitored in production (potentially a paging event).</p></li><li><p>Verify the integration with your payment gateway(s): very few payment transactions (if any) should be in an <code>UNKNOWN</code> state. Make sure to fix these manually via the Payment Admin API, if the plugin is unable to do it automatically.</p></li><li><p>Have a monitoring system in place (we recommend <a href="https://github.com/killbill/killbill-cloud/tree/master/docker/compose">Elasticseach, Logstash, Kibana, InfluxDB and Grafana</a>, which can be easily setup for Kill Bill) and watch your logs constantly: any <code>WARN</code> or <code>ERROR</code> entry should be reviewed, as well as stacktraces.</p></li><li><p>Monitor metrics at <code>/1.0/metrics</code> and integrate the healthcheck at <code>/1.0/healthcheck</code> with your load balancer.</p></li><li><p>Join our <a href="https://groups.google.com/forum/#!forum/killbilling-users">mailing-list</a> to get notified of new releases or ask questions. Due to the high traffic, we&#8217;re not always available for help right away: if you need peace of mind for your production deployment, consider becoming a <a href="https://github.com/sponsors/pierre">GitHub Sponsor</a> to get priority support via alternative channels.</p></li></ul></div></div></div></div>
<div class="sect1"><h2 id="_deployment_options">Deployment options</h2><div class="sectionbody"><div class="paragraph"><p>When deploying Kill Bill, the following pieces will need to be deployed in addition to your OS, VM or container (Docker, &#8230;&#8203;):</p></div>
<div class="ulist"><ul><li><p>A <a href="https://en.wikipedia.org/wiki/Web_container">Web container</a> (Jetty, Tomcat, &#8230;&#8203;)</p></li><li><p>The killbill <a href="https://en.wikipedia.org/wiki/WAR_(file_format)">web application</a></p></li><li><p>The plugins</p></li><li><p>The configuration files and system properties</p></li><li><p>The database along with the various schemas (see our <a href="https://docs.killbill.io/latest/database_migrations.html">database migrations guide</a>)</p></li></ul></div>
<div class="paragraph"><p>Because a lot of pieces need to be in place, and because a lot can go wrong, users are <strong>strongly</strong> encouraged to use either our pre-built <a href="https://docs.killbill.io/latest/aws.html">AMIs</a> on AWS or our pre-built <a href="https://registry.hub.docker.com/u/killbill/killbill">Docker images</a>.</p></div>
<div class="paragraph"><p>If these options aren&#8217;t possible in your environment, default to a manual Tomcat installation.</p></div>
<div class="paragraph"><p>Our <a href="https://docs.killbill.io/latest/getting_started.html">Getting Started</a> guide has step by step instructions for all of these options.</p></div>
<div class="paragraph"><p>Finally, experienced users can also opt for our <a href="https://github.com/killbill/killbill-cloud/tree/master">Ansible playbooks</a> (Ansible is an open-source IT Automation tool), to install and configure <a href="https://tomcat.apache.org/">Apache Tomcat</a>, <a href="https://github.com/killbill/killbill-cloud/tree/master/kpm">KPM</a> and Kill Bill individually.</p></div>
<div class="paragraph"><p>Note that all these deployment options rely on <a href="https://github.com/killbill/killbill-cloud/tree/master/kpm">KPM</a>, the Kill Bill Package Manager. KPM can fetch existing (signed) artifacts for the main killbill war and for each of the plugins, and deploy them at the right place. Using KPM directly gives you the most flexibility without having to re-invent the wheel, but significantly increases the deployment complexity. To be used by our most advanced users only.</p></div>
<div class="sect2"><h3 id="_docker">Docker</h3><div class="paragraph"><p>Documentation to configure our images is available <a href="https://github.com/killbill/killbill-cloud/blob/master/docker/README.adoc">here</a>.</p></div>
<div class="paragraph"><p>You can perform container configuration by bind mounting a custom <code>killbill.properties</code> (for configuration) and/or a custom <code>kpm.yml</code> (to specify plugins to install) file: <code>-v /path/to/killbill.properties:/var/lib/killbill/killbill.properties -v /path/to/kpm.yml:/var/lib/killbill/kpm.yml</code>. Note that on MacOS, <code>/path/to</code> must be under <code>/Users</code>.</p></div></div></div></div>
<div class="sect1"><h2 id="_database_engine">Database engine</h2><div class="sectionbody"><div class="paragraph"><p>The Kill Bill core team is typically using <code>mysql</code> for most of the production deployments and for its testing, but we also run regression tests against both MariaDB 10 and PostgreSQL 12, and users have successfully deployed Kill Bill with Oracle MySQL, Percona, Aurora, etc.</p></div>
<div class="paragraph"><p>We have kept our DDL schema (and the queries we run) as simple as possible so it is easy to adapt it for other RDBMS.</p></div>
<div class="sect2"><h3 id="_kill_bill">Kill Bill</h3><div class="paragraph"><p>You can find the Kill Bill DDL <a href="https://docs.killbill.io/latest/ddl.sql">here</a>. For PostgreSQL users, you will need to also add the following <a href="https://github.com/killbill/killbill/blob/master/util/src/main/resources/org/killbill/billing/util/ddl-postgresql.sql">schema extension</a>, <strong>before installing the main DDL</strong>.</p></div></div>
<div class="sect2"><h3 id="_kaui">Kaui</h3><div class="paragraph"><p>You can find the Kaui DDL <a href="https://github.com/killbill/killbill-admin-ui/blob/master/db/ddl.sql">here</a>&#8201;&#8212;&#8201;based on the version you are running, you can adjust the corresponding URL.</p></div></div>
<div class="sect2"><h3 id="_failover">Failover</h3><div class="paragraph"><p>We&#8217;ve tested various failover scenarios (Aurora RDS, master/slave MariaDB Docker setup and master/slave Percona Server on real hardware) and could confirm that Kill Bill is behaving as expected, i.e. queries in-flight will fail during a failover, but reconnection is automatic.</p></div>
<div class="paragraph"><p>Specifically for Aurora though, we did notice that:</p></div>
<div class="ulist"><ul><li><p>Reconnection is r/o by default after the failover. <code>jdbc:mysql:aurora:</code> must be specified in the JDBC url for the reconnection to be r/w.</p></li><li><p>Triggering a failover in the RDS UI leads to a pretty short Kill Bill downtime (few secs). Terminating the master though ("delete instance") takes a bit longer (few minutes)&#8201;&#8212;&#8201;this could be mitigated with more aggressive timeouts in the JDBC pool.</p></li></ul></div></div></div></div>
<div class="sect1"><h2 id="_bus_and_notification_queues">Bus and Notification queues</h2><div class="sectionbody"><div class="sect2"><h3 id="_bus_events">Bus events</h3><div class="paragraph"><p>The notifications across Kill Bill core services rely on a proprietary <a href="https://killbill.io/blog/persistent-bus-in-kill-bill/">bus event</a>. There are actually 2 buses, the <strong>main</strong> bus which is used by core services and an <strong>external</strong> bus which is used by plugins. The main reason for having 2 buses is that the main bus is critical for internal operations to work, and so we want to prevent plugin code that could interact with 3rd party systems to block on long operations and impact the rest of the system.</p></div>
<div class="paragraph"><p>There are 2 sets of two tables to manage those bus events:</p></div>
<div class="ulist"><ul><li><p>For the <strong>main</strong> bus, a <code>bus_events</code> and a <code>bus_events_history</code> table.</p></li><li><p>For the <strong>external</strong> bus, a <code>bus_ext_events</code> and a <code>bus_ext_events_history</code> table.</p></li></ul></div>
<div class="paragraph"><p>Events are moved from the <code>bus_events</code> to the <code>bus_events_history</code> as they are processed. That allows to keep a history of what happened in the system and avoid having the <code>bus_events</code> table grow too much. The <code>bus_events_history</code> is only there for debugging and is never used by the system.</p></div>
<div class="sect3"><h4 id="_bus_event_modes">Bus Event Modes</h4><div class="paragraph"><p>The bus event can be run in multiple modes (<code>instanceName</code> below is either <code>main</code> or <code>external</code>):</p></div>
<div class="ulist"><ul><li><p><strong>POLLING</strong>: the bus will poll the database for new available entries and dispatch them across the nodes.</p></li><li><p><strong>STICKY_POLLING</strong>: the bus will poll the database for new available entries and dispatch them to the same node that created the entry.</p></li><li><p><strong>STICKY_EVENTS</strong> (default mode): in that mode, the bus now behaves as a blocking queue where entries are dispatched as soon as they have been committed to disk. This is a much more efficient mechanism both in terms of latency (because entries are picked up right away) and throughput (because there is no time for entries to accumulate).</p></li></ul></div>
<div class="paragraph"><p>In a cloud environment, where nodes are more prone to appear and disappear, the following choices are available:</p></div>
<div class="ulist"><ul><li><p>Use the <strong>POLLING mode</strong></p></li><li><p>Use the <strong>STICKY_EVENTS</strong> (or <strong>STICKY_POLLING</strong>) mode. In that scenario, you need to be cautious of Kill Bill instances restarting on a different node:</p></li><li><p>Each instance can be started with a specific system property <code>org.killbill.queue.creator.name=&lt;MY_VIRTUAL_INSTANCE_NAME&gt;</code>, which overrides the <code>creating_owner</code> value string associated with each entry which defaults to the hostname of the machine. When using that property, an instance that restarts on a different node but with the same property will continue processing the same entries.</p></li><li><p>Or, alternatively if failovers don&#8217;t occur too often, run a query to update rows associated with the instance that failed over so they get picked by an other node. Note that events are never lost because they are persistent, but in that case, they may linger until updated. The query to update the rows is the following (only showed for bus_events table, but similar query needs to happen for bus_events_history):</p></li></ul></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="sql"><span></span><span class="tok-k">update</span> <span class="tok-n">bus_events</span> <span class="tok-k">set</span> <span class="tok-n">creating_owner</span><span class="tok-o">=</span><span class="tok-s1">&#39;MY_NEW_NODE_HOSTNAME&#39;</span><span class="tok-p">,</span> <span class="tok-n">processing_available_date</span><span class="tok-o">=</span><span class="tok-k">NULL</span><span class="tok-p">,</span> <span class="tok-n">processing_state</span> <span class="tok-o">=</span> <span class="tok-s1">&#39;AVAILABLE&#39;</span><span class="tok-p">,</span> <span class="tok-n">processing_owner</span><span class="tok-o">=</span><span class="tok-k">NULL</span> <span class="tok-k">where</span> <span class="tok-n">creating_owner</span><span class="tok-o">=</span><span class="tok-s1">&#39;MY_INSTANCE_NAME_THAT_FAILED&#39;</span><span class="tok-p">;</span></code></pre></div></div></div></div>
<div class="sect2"><h3 id="_future_notifications">Future Notifications</h3><div class="sect3"><h4 id="_overview_2">Overview</h4><div class="paragraph"><p>In addition to the bus events, which are dispatched immediately, Kill Bill also manages future notifications. The mechanism is very similar to the <strong>POLLING</strong> we described earlier, but the main difference is that those notifications are dispatched when the <code>effective_date</code> of the notification has been reached. There is no <strong>STICKY_EVENTS</strong> mode for the future notifications.</p></div>
<div class="paragraph"><p>The future notifications also rely on two tables: the <code>notifications</code> and <code>notifications_history</code>, and the mechanism to move processed entries is similar to what we described for the bus event.</p></div></div></div></div></div>
<div class="sect1"><h2 id="_logging_and_data_governance">Logging and Data Governance</h2><div class="sectionbody"><div class="paragraph"><p>If you are using Tomcat, <code>CATALINA_BASE/logs/catalina.out</code> does not rotate. Make sure to make your main appender <code>ch.qos.logback.core.rolling.RollingFileAppender</code> instead of the default <code>ch.qos.logback.core.ConsoleAppender</code> (<code>STDOUT</code>/<code>STDERR</code> is redirected to <code>CATALINA_BASE/logs/catalina.out</code>).</p></div>
<div class="paragraph"><p>Make sure also to install the <a href="https://github.com/killbill/killbill-platform/tree/master/osgi-bundles/bundles/logger">Kill Bill Log bundle</a> in your <code>platform</code> directory (<code>/var/tmp/bundles/platform</code> by default), otherwise OSGI logs (including from JRuby plugins) will end up in <code>STDOUT</code>/<code>STDERR</code> (hence in <code>CATALINA_BASE/logs/catalina.out</code>). It is included in the <a href="https://github.com/killbill/killbill-platform/tree/master/osgi-bundles/defaultbundles">defaultbundles package</a>.</p></div>
<div class="sect2"><h3 id="_pii_and_gdpr">PII and GDPR</h3><div class="paragraph"><p>We recommend not storing any Personally Identifiable Information (PII) in Kill bill, such as names, email addresses, etc. to limit your compliance burden. Kill Bill accounts have an external key property, which can be set to an id in an external system (e.g. CRM). Have your custom code and plugins fetch this information on-demand instead of storing it inside Kill Bill.</p></div></div>
<div class="sect2"><h3 id="_mask_pans">Mask PANs</h3><div class="paragraph"><p>Use the converter class <code>org.killbill.billing.server.log.obfuscators.ObfuscatorConverter</code>.</p></div>
<div class="paragraph"><p>If you are passing PANs via plugin properties, make sure to disable query parameters logging in Tomcat. Use the following <code>org.apache.catalina.valves.AccessLogValve</code> pattern: <code>%h %l %u %t &quot;%m %U&quot; %s %b %D</code>.</p></div></div>
<div class="sect2"><h3 id="_redirect_plugin_logs_to_a_different_file">Redirect plugin logs to a different file</h3><div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="xml"><span></span><span class="tok-nt">&lt;configuration</span> <span class="tok-na">debug=</span><span class="tok-s">&quot;true&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;appender</span> <span class="tok-na">name=</span><span class="tok-s">&quot;MAIN&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;</span><span class="tok-nt">&gt;</span>
        <span class="tok-nt">&lt;filter</span> <span class="tok-na">class=</span><span class="tok-s">&quot;ch.qos.logback.core.filter.EvaluatorFilter&quot;</span><span class="tok-nt">&gt;</span>
            <span class="tok-nt">&lt;evaluator</span> <span class="tok-na">name=</span><span class="tok-s">&quot;loggingTaskEval&quot;</span><span class="tok-nt">&gt;</span>
                <span class="tok-nt">&lt;expression&gt;</span>
                <span class="tok-cp">&lt;![CDATA[</span>
<span class="tok-cp">                    message!=null &amp;&amp;</span>
<span class="tok-cp">                    message.contains(&quot;[cybersource-plugin]&quot;)</span>
<span class="tok-cp">                ]]&gt;</span>
                <span class="tok-nt">&lt;/expression&gt;</span>
            <span class="tok-nt">&lt;/evaluator&gt;</span>
            <span class="tok-nt">&lt;OnMatch&gt;</span>DENY<span class="tok-nt">&lt;/OnMatch&gt;</span>
        <span class="tok-nt">&lt;/filter&gt;</span>
        <span class="tok-nt">&lt;file&gt;</span>${LOGS_DIR:-./logs}/killbill.out<span class="tok-nt">&lt;/file&gt;</span>
        <span class="tok-nt">&lt;rollingPolicy</span> <span class="tok-na">class=</span><span class="tok-s">&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;</span><span class="tok-nt">&gt;</span>
            <span class="tok-nt">&lt;fileNamePattern&gt;</span>${LOGS_DIR:-./logs}/killbill-%d{yyyy-MM-dd}.%i.out.gz<span class="tok-nt">&lt;/fileNamePattern&gt;</span>
            <span class="tok-nt">&lt;maxHistory&gt;</span>3<span class="tok-nt">&lt;/maxHistory&gt;</span>
            <span class="tok-nt">&lt;cleanHistoryOnStart&gt;</span>true<span class="tok-nt">&lt;/cleanHistoryOnStart&gt;</span>
            <span class="tok-nt">&lt;timeBasedFileNamingAndTriggeringPolicy</span> <span class="tok-na">class=</span><span class="tok-s">&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP&quot;</span><span class="tok-nt">&gt;</span>
                <span class="tok-nt">&lt;maxFileSize&gt;</span>100MB<span class="tok-nt">&lt;/maxFileSize&gt;</span>
            <span class="tok-nt">&lt;/timeBasedFileNamingAndTriggeringPolicy&gt;</span>
        <span class="tok-nt">&lt;/rollingPolicy&gt;</span>
        <span class="tok-nt">&lt;encoder&gt;</span>
            <span class="tok-nt">&lt;pattern&gt;</span>%date [%thread] %-5level %logger{36} - %msg%n<span class="tok-nt">&lt;/pattern&gt;</span>
        <span class="tok-nt">&lt;/encoder&gt;</span>
    <span class="tok-nt">&lt;/appender&gt;</span>

    <span class="tok-nt">&lt;appender</span> <span class="tok-na">name=</span><span class="tok-s">&quot;CYBERSOURCE&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;</span><span class="tok-nt">&gt;</span>
        <span class="tok-nt">&lt;filter</span> <span class="tok-na">class=</span><span class="tok-s">&quot;ch.qos.logback.core.filter.EvaluatorFilter&quot;</span><span class="tok-nt">&gt;</span>
            <span class="tok-nt">&lt;evaluator</span> <span class="tok-na">name=</span><span class="tok-s">&quot;loggingTaskEval&quot;</span><span class="tok-nt">&gt;</span>
                <span class="tok-nt">&lt;expression&gt;</span>
                <span class="tok-cp">&lt;![CDATA[</span>
<span class="tok-cp">                    message!=null &amp;&amp;</span>
<span class="tok-cp">                    message.contains(&quot;[cybersource-plugin]&quot;)</span>
<span class="tok-cp">                ]]&gt;</span>
                <span class="tok-nt">&lt;/expression&gt;</span>
            <span class="tok-nt">&lt;/evaluator&gt;</span>
            <span class="tok-nt">&lt;OnMismatch&gt;</span>DENY<span class="tok-nt">&lt;/OnMismatch&gt;</span>
        <span class="tok-nt">&lt;/filter&gt;</span>
        <span class="tok-nt">&lt;file&gt;</span>${LOGS_DIR:-./logs}/cybersource.out<span class="tok-nt">&lt;/file&gt;</span>
        <span class="tok-nt">&lt;rollingPolicy</span> <span class="tok-na">class=</span><span class="tok-s">&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;</span><span class="tok-nt">&gt;</span>
            <span class="tok-nt">&lt;fileNamePattern&gt;</span>${LOGS_DIR:-./logs}/cybersource-%d{yyyy-MM-dd}.%i.out.gz<span class="tok-nt">&lt;/fileNamePattern&gt;</span>
            <span class="tok-nt">&lt;maxHistory&gt;</span>3<span class="tok-nt">&lt;/maxHistory&gt;</span>
            <span class="tok-nt">&lt;cleanHistoryOnStart&gt;</span>true<span class="tok-nt">&lt;/cleanHistoryOnStart&gt;</span>
            <span class="tok-nt">&lt;timeBasedFileNamingAndTriggeringPolicy</span> <span class="tok-na">class=</span><span class="tok-s">&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP&quot;</span><span class="tok-nt">&gt;</span>
                <span class="tok-nt">&lt;maxFileSize&gt;</span>100MB<span class="tok-nt">&lt;/maxFileSize&gt;</span>
            <span class="tok-nt">&lt;/timeBasedFileNamingAndTriggeringPolicy&gt;</span>
        <span class="tok-nt">&lt;/rollingPolicy&gt;</span>
        <span class="tok-nt">&lt;encoder&gt;</span>
            <span class="tok-nt">&lt;pattern&gt;</span>%date [%thread] %msg%n<span class="tok-nt">&lt;/pattern&gt;</span>
        <span class="tok-nt">&lt;/encoder&gt;</span>
    <span class="tok-nt">&lt;/appender&gt;</span>

    <span class="tok-nt">&lt;root</span> <span class="tok-na">level=</span><span class="tok-s">&quot;INFO&quot;</span><span class="tok-nt">&gt;</span>
       <span class="tok-nt">&lt;appender-ref</span> <span class="tok-na">ref=</span><span class="tok-s">&quot;MAIN&quot;</span> <span class="tok-nt">/&gt;</span>
       <span class="tok-nt">&lt;appender-ref</span> <span class="tok-na">ref=</span><span class="tok-s">&quot;CYBERSOURCE&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;/root&gt;</span>
<span class="tok-nt">&lt;/configuration&gt;</span></code></pre></div></div></div>
<div class="sect2"><h3 id="_handling_plugin_logs">Handling plugin logs</h3><div class="paragraph"><p>In order for plugin logs to be handled by the main logger, make sure to:</p></div>
<div class="ulist"><ul><li><p>Install <code>killbill-platform-osgi-bundles-logger</code> under <code>/var/tmp/bundles/platform</code> (also provided in the default plugins package)</p></li><li><p>Add <code>org.osgi.service.log</code> to <code>Import-Package</code> in your <code>MANIFEST.MF</code></p></li><li><p>Add the following dependencies in compile scope in your plugin:</p></li></ul></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="xml"><span></span><span class="tok-nt">&lt;dependency&gt;</span>
    <span class="tok-nt">&lt;groupId&gt;</span>org.kill-bill.billing<span class="tok-nt">&lt;/groupId&gt;</span>
    <span class="tok-nt">&lt;artifactId&gt;</span>killbill-platform-osgi-bundles-lib-killbill<span class="tok-nt">&lt;/artifactId&gt;</span>
<span class="tok-nt">&lt;/dependency&gt;</span>
<span class="tok-nt">&lt;dependency&gt;</span>
    <span class="tok-nt">&lt;groupId&gt;</span>org.kill-bill.billing<span class="tok-nt">&lt;/groupId&gt;</span>
    <span class="tok-nt">&lt;artifactId&gt;</span>killbill-platform-osgi-bundles-lib-slf4j-osgi<span class="tok-nt">&lt;/artifactId&gt;</span>
<span class="tok-nt">&lt;/dependency&gt;</span></code></pre></div></div></div></div></div>
<div class="sect1"><h2 id="_reverse_proxy">Reverse Proxy</h2><div class="sectionbody"><div class="paragraph"><p>We recommend setting up NGINX to forward external notifications to Kill Bill.</p></div>
<div class="paragraph"><p>Here&#8217;s a working example for Adyen:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="nginx"><span></span><span class="tok-k">server</span> <span class="tok-p">{</span>
  <span class="tok-kn">listen</span>       <span class="tok-mi">443</span><span class="tok-p">;</span>
  <span class="tok-kn">server_name</span>  <span class="tok-s">killbill-public.acme.com</span><span class="tok-p">;</span>

  <span class="tok-kn">location</span> <span class="tok-s">/notifications/killbill-adyen</span> <span class="tok-p">{</span>
      <span class="tok-kn">proxy_set_header</span> <span class="tok-s">X-Real-IP</span> <span class="tok-nv">$remote_addr</span><span class="tok-p">;</span>
      <span class="tok-kn">proxy_set_header</span> <span class="tok-s">X-Forwarded-For</span> <span class="tok-nv">$proxy_add_x_forwarded_for</span><span class="tok-p">;</span>
      <span class="tok-kn">proxy_set_header</span> <span class="tok-s">X-Forwarded-Proto</span> <span class="tok-nv">$scheme</span><span class="tok-p">;</span>

      <span class="tok-kn">proxy_set_header</span> <span class="tok-s">Authorization</span> <span class="tok-s">&quot;Basic</span> <span class="tok-s">YWRtaW46cGFzc3dvcmQ=&quot;</span><span class="tok-p">;</span>
      <span class="tok-kn">proxy_set_header</span> <span class="tok-s">X-Killbill-ApiKey</span> <span class="tok-s">bob</span><span class="tok-p">;</span>
      <span class="tok-kn">proxy_set_header</span> <span class="tok-s">X-Killbill-ApiSecret</span> <span class="tok-s">lazar</span><span class="tok-p">;</span>
      <span class="tok-kn">proxy_set_header</span> <span class="tok-s">X-Killbill-CreatedBy</span> <span class="tok-s">Adyen</span><span class="tok-p">;</span>
      <span class="tok-kn">proxy_pass</span> <span class="tok-s">http://killbill-internal.acme.com:8080/1.0/kb/paymentGateways/notification/killbill-adyen</span><span class="tok-p">;</span>

      <span class="tok-kn">proxy_hide_header</span> <span class="tok-s">Set-Cookie</span><span class="tok-p">;</span>
      <span class="tok-kn">proxy_hide_header</span> <span class="tok-s">Access-Control-Allow-Origin</span><span class="tok-p">;</span>
      <span class="tok-kn">proxy_hide_header</span> <span class="tok-s">Access-Control-Allow-Methods</span><span class="tok-p">;</span>
      <span class="tok-kn">proxy_hide_header</span> <span class="tok-s">Access-Control-Allow-Headers</span><span class="tok-p">;</span>
      <span class="tok-kn">proxy_hide_header</span> <span class="tok-s">Access-Control-Expose-Headers</span><span class="tok-p">;</span>
      <span class="tok-kn">proxy_hide_header</span> <span class="tok-s">Access-Control-Allow-Credentials</span><span class="tok-p">;</span>
  <span class="tok-p">}</span>
<span class="tok-p">}</span></code></pre></div></div></div></div>
<div class="sect1"><h2 id="_service_discovery_with_eureka">Service Discovery with Eureka</h2><div class="sectionbody"><div class="paragraph"><p>For easier integration into a microservice architecture, Kill Bill supports client-side service discovery via a <a href="https://github.com/Netflix/eureka/wiki/Eureka-at-a-glance">Eureka registry</a>. A module (disabled by default) is provided that allows Kill Bill to register with a Eureka server.</p></div>
<div class="paragraph"><p>To register as a Eureka client, first add the following dependency to your profile:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="xml"><span></span><span class="tok-nt">&lt;dependency&gt;</span>
    <span class="tok-nt">&lt;groupId&gt;</span>org.kill-bill.billing<span class="tok-nt">&lt;/groupId&gt;</span>
    <span class="tok-nt">&lt;artifactId&gt;</span>killbill-platform-service-registry<span class="tok-nt">&lt;/artifactId&gt;</span>
<span class="tok-nt">&lt;/dependency&gt;</span></code></pre></div></div>
<div class="paragraph"><p>Next, add the Eureka Guice module to the module list in your server module (i.e. KillbillServerModule.java)</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="java"><span></span> <span class="tok-n">install</span><span class="tok-p">(</span><span class="tok-k">new</span> <span class="tok-n">EurekaModule</span><span class="tok-p">(</span><span class="tok-n">configSource</span><span class="tok-p">));</span></code></pre></div></div>
<div class="paragraph"><p>Finally, add the Eureka client config properties to <code>killbill.properties</code>. For example, assuming a Eureka server is running on port 8761 and Kill Bill is on port 8080:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="properties"><span></span><span class="tok-na">eureka.serviceUrl.default</span><span class="tok-o">=</span><span class="tok-s">http://localhost:8761/eureka</span>

<span class="tok-na">eureka.registration.enabled</span><span class="tok-o">=</span><span class="tok-s">true</span>
<span class="tok-na">eureka.name</span><span class="tok-o">=</span><span class="tok-s">killbill</span>
<span class="tok-na">eureka.port</span><span class="tok-o">=</span><span class="tok-s">8080</span>
<span class="tok-na">eureka.port.enabled</span><span class="tok-o">=</span><span class="tok-s">true</span>
<span class="tok-na">eureka.securePort.enabled</span><span class="tok-o">=</span><span class="tok-s">false</span>

<span class="tok-na">eureka.statusPageUrlPath</span><span class="tok-o">=</span><span class="tok-s">/1.0/metrics</span>
<span class="tok-na">eureka.healthCheckUrlPath</span><span class="tok-o">=</span><span class="tok-s">/1.0/healthCheck</span>

<span class="tok-na">eureka.decoderName</span><span class="tok-o">=</span><span class="tok-s">JacksonJson</span>
<span class="tok-na">eureka.preferSameZone</span><span class="tok-o">=</span><span class="tok-s">true</span>
<span class="tok-na">eureka.shouldUseDns</span><span class="tok-o">=</span><span class="tok-s">false</span></code></pre></div></div></div></div>
<div class="sect1"><h2 id="_enabling_https">Enabling HTTPS</h2><div class="sectionbody"><div class="paragraph"><p>You first need to import your SSL certificate (see <a href="https://tomcat.apache.org/tomcat-8.5-doc/ssl-howto.html">docs</a>). For testing, you can just create a self-signed certificate. For example, on Ubuntu or our Docker images:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="bash"><span></span>sudo apt-get update
sudo apt-get install ssl-cert
sudo usermod -a -G ssl-cert tomcat</code></pre></div></div>
<div class="paragraph"><p>Then, update Tomcat’s configuration (<code>/var/lib/tomcat/conf/server.xml</code> in our Docker images):</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="xml"><span></span><span class="tok-nt">&lt;Connector</span> <span class="tok-na">executor=</span><span class="tok-s">&quot;tomcatThreadPool&quot;</span>
           <span class="tok-na">port=</span><span class="tok-s">&quot;8443&quot;</span>
           <span class="tok-na">connectionTimeout=</span><span class="tok-s">&quot;20000&quot;</span>
           <span class="tok-na">acceptorThreadCount=</span><span class="tok-s">&quot;2&quot;</span>
           <span class="tok-na">SSLEnabled=</span><span class="tok-s">&quot;true&quot;</span>
           <span class="tok-na">SSLCertificateFile=</span><span class="tok-s">&quot;/etc/ssl/certs/ssl-cert-snakeoil.pem&quot;</span>
           <span class="tok-na">SSLCertificateKeyFile=</span><span class="tok-s">&quot;/etc/ssl/private/ssl-cert-snakeoil.key&quot;</span>
           <span class="tok-na">scheme=</span><span class="tok-s">&quot;https&quot;</span>
           <span class="tok-na">secure=</span><span class="tok-s">&quot;true&quot;</span> <span class="tok-nt">/&gt;</span></code></pre></div></div>
<div class="paragraph"><p>Finally, make sure port 8443 is open (and exported from the Docker containers).</p></div></div></div>
<div class="sect1"><h2 id="_ssl_termination_and_x_forwarded_headers_support">SSL termination and X-Forwarded headers support</h2><div class="sectionbody"><div class="paragraph"><p>When <code>org.killbill.jaxrs.location.full.url=true</code> (default), Kill Bill will build location headers using a full URL. In a typical load balancer scenario, which receives traffic on port 8443 and forwards it to port 8080 on the Kill Bill instances (i.e. SSL terminated at the load balancer), you probably want the headers to return something like <a class="bare" href="https://killbill-vip.mycompany.net:8443">https://killbill-vip.mycompany.net:8443</a> instead of <a class="bare" href="http://10.1.2.3:8080">http://10.1.2.3:8080</a>.</p></div>
<div class="paragraph"><p>To do so, <code>RemoteIpValve</code> should be enabled in your Tomcat configuration (done by default in our Docker images, see <code>/var/lib/tomcat/conf/server.xml</code>). This will make Kill Bill build the right location headers using <code>X-Forwarded-For</code>, <code>X-Forwarded-Proto</code> and <code>X-Forwarded-Port</code> sent by your load balancer or reverse proxy.</p></div>
<div class="paragraph"><p>Notes:</p></div>
<div class="ulist"><ul><li><p>You might also need to configure Tomcat&#8217;s <code>internalProxies</code> and <code>trustedProxies</code> attributes (see the <a href="https://tomcat.apache.org/tomcat-7.0-doc/config/valve.html#Proxies_Support">docs</a>).</p></li><li><p>You might also need to set <code>org.killbill.jaxrs.location.host</code> in your <code>killbill.properties</code> file (e.g. <code>org.killbill.jaxrs.location.host=killbill-vip.mycompany.net</code>).</p></li><li><p>You might also want to set <code>requestAttributesEnabled="true"</code> to <code>org.apache.catalina.valves.AccessLogValve</code>, to log the IP address from the <code>X-Forwarded-For</code> header in the access logs.</p></li></ul></div></div></div>
<div class="sect1"><h2 id="_nagios_integration">Nagios integration</h2><div class="sectionbody"><div class="paragraph"><p>To integrate JMX beans with Nagios, download the plugin from <a class="bare" href="https://github.com/killbill/nagios-jmx-plugin">https://github.com/killbill/nagios-jmx-plugin</a>:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="bash"><span></span><span class="tok-c1"># Whether the persistent bus is turned on (warns if off)</span>
./check_jmx_ng -v -U service:jmx:rmi:///jndi/rmi://127.0.0.1:8989/jmxrmi -O org.killbill.bus.api:name<span class="tok-o">=</span>PersistentBus -A NotificationProcessingSuspended -w <span class="tok-nb">false</span>
<span class="tok-c1"># Whether the notification queue is turned on (warns if off)</span>
./check_jmx_ng -v -U service:jmx:rmi:///jndi/rmi://127.0.0.1:8989/jmxrmi -O org.killbill.notificationq.api:name<span class="tok-o">=</span>NotificationQueueService -A NotificationProcessingSuspended -w <span class="tok-nb">false</span>
<span class="tok-c1"># Generic Kill Bill healthcheck, checks the overall state of the application (warns if unhealthy)</span>
./check_jmx_ng -v -U service:jmx:rmi:///jndi/rmi://127.0.0.1:8989/jmxrmi -O org.killbill.billing.server.healthchecks:name<span class="tok-o">=</span>KillbillHealthcheck -A Healthy -w <span class="tok-nb">true</span>
<span class="tok-c1"># Monitors the size of the notification queue. Warning and Critical alerts often mean an overload of the system</span>
./check_jmx_ng -v -U service:jmx:rmi:///jndi/rmi://127.0.0.1:8989/jmxrmi -O metrics:name<span class="tok-o">=</span>org.killbill.notificationq.NotificationQueueDispatcher.pending-notifications -A Value -w <span class="tok-m">50</span> -c <span class="tok-m">100</span></code></pre></div></div>
<div class="paragraph"><p>Other interesting metrics (use of the <code>-P</code> flag to get Nagios performance data):</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="bash"><span></span>./check_jmx_ng -v -U service:jmx:rmi:///jndi/rmi://127.0.0.1:8989/jmxrmi -P -O <span class="tok-s1">&#39;java.lang:type=ClassLoading&#39;</span> -A LoadedClassCount
./check_jmx_ng -v -U service:jmx:rmi:///jndi/rmi://127.0.0.1:8989/jmxrmi -P -O <span class="tok-s1">&#39;java.lang:type=Compilation&#39;</span> -A TotalCompilationTime
./check_jmx_ng -v -U service:jmx:rmi:///jndi/rmi://127.0.0.1:8989/jmxrmi -P -O <span class="tok-s1">&#39;java.lang:type=OperatingSystem&#39;</span> -A SystemCpuLoad
./check_jmx_ng -v -U service:jmx:rmi:///jndi/rmi://127.0.0.1:8989/jmxrmi -P -O <span class="tok-s1">&#39;java.lang:type=Runtime&#39;</span> -A Uptime
./check_jmx_ng -v -U service:jmx:rmi:///jndi/rmi://127.0.0.1:8989/jmxrmi -P -O <span class="tok-s1">&#39;java.lang:type=Threading&#39;</span> -A ThreadCount
./check_jmx_ng -v -U service:jmx:rmi:///jndi/rmi://127.0.0.1:8989/jmxrmi -P -O <span class="tok-s1">&#39;java.nio:type=BufferPool,name=direct&#39;</span> -A MemoryUsed
./check_jmx_ng -v -U service:jmx:rmi:///jndi/rmi://127.0.0.1:8989/jmxrmi -P -O <span class="tok-s1">&#39;java.nio:type=BufferPool,name=mapped&#39;</span> -A MemoryUsed
./check_jmx_ng -v -U service:jmx:rmi:///jndi/rmi://127.0.0.1:8989/jmxrmi -P -O <span class="tok-s1">&#39;metrics:name=org.killbill.bus.dao.PersistentBusSqlDao.getReadyEntries&#39;</span> -A 95thPercentile</code></pre></div></div></div></div></div></article></div><div class="bd-links-wrapper"><nav class="bd-links toc right-side-menu" id="toc" data-toggle="toc"></nav></div></div></div></main><script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script><script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script><script src="https://cdn.staticaly.com/gh/afeld/bootstrap-toc/v1.0.0/dist/bootstrap-toc.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script><script src="https://www.googletagmanager.com/gtag/js?id=G-C0HVJ1E78Z"></script><script>
    setTimeout(function(){
      $('.content-wrapper h2, .content-wrapper h3, .content-wrapper h4').append('<a href=""><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>');
      $('.content-wrapper h2, .content-wrapper h3, .content-wrapper h4').each(function(){
        let itemHref = '#' + $(this).attr('id');
        $(this).find('a').attr("href", itemHref);
      })
      $('.content-wrapper table').each(function() {
        $(this).wrap('<div class="table-wrap"></div>')
        $('.table-wrap').each(function() {
          if ($(this).find('table').width() > $(this).width()){
            $(this).css('max-width', '100%');
            $(this).css('overflow-x', 'scroll');
          }
        })
      })
      function copyToClipboard(text) {
        let sampleTextarea = document.createElement("textarea");
        document.body.appendChild(sampleTextarea);
        sampleTextarea.value = text;
        sampleTextarea.select();
        document.execCommand("copy");
        document.body.removeChild(sampleTextarea);
      }
      $('.content-wrapper h2 a, .content-wrapper h3 a, .content-wrapper h4 a').on('click', function(){
        setTimeout(function(){
          copyToClipboard($(location).attr("href"));
        }, 500);
      });
      $('.content-wrapper .note td.icon').append('<img src="https://github.com/killbill/killbill-docs/raw/v3/userguide/assets/img/note-icon.png">');

      $('.content pre').parent('.content').prepend('<div class="copy-icon"><svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8 3a1 1 0 0 1 1-1h2a1 1 0 1 1 0 2H9a1 1 0 0 1-1-1Z" fill="#78AECD"/><path d="M6 3a2 2 0 0 0-2 2v11a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2 3 3 0 0 1-3 3H9a3 3 0 0 1-3-3Z" fill="#78AECD"/></svg></div>');
      $('.copy-icon svg').on('click', function () {
        copyToClipboard($(this).parent().next().find('code').text());
      });
    }, 1000);

    $('.main').append('<div class="lightbox-modal"> <div id="close-ligtbox">✕</div> <div class="img"><img src="" alt=""></div></div><div class="overlay"></div>');
    $('.main img').on('click', function () {
      let path = $(this).attr('src');
      $('.lightbox-modal img').attr('src', path);
      $('.lightbox-modal, .overlay').show();
    });
    $('#close-ligtbox, .overlay').on('click',function () {
      $('.lightbox-modal, .overlay').hide();
    });

$('.sidebar-toggler').on('click', function () {
  $(this).toggleClass('active');
  $('main.main').toggleClass('sidebar-hide');
});

$('.content-wrapper a').filter(function() {
  return this.hostname && this.hostname !== location.hostname;
}).each(function() {
  $(this).attr({
    target: '_blank',
    title: 'Visit ' + this.href + ' (click to open in a new window)'
  });
});

  </script><script>docsearch({apiKey: '3ef227e7fd5e2e1a3fffd880484934bf', container: '#docsearch', appId: 'S2ISXITURI', indexName: 'killbill'});</script><script>window.dataLayer = window.dataLayer || [];
function gtag(){window.dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-C0HVJ1E78Z');</script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create','UA-32705710-3','auto');
  ga('send','pageview');
  var getOutboundLink = function(url) {
    ga('send', {
      hitType: 'event',
      eventCategory: 'outbound',
      eventAction: 'click',
      eventLabel: url,
      hitCallback: function(){document.location = url;}
    });
  }</script></body></html>