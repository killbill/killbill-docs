<!DOCTYPE html><html lang="en"><head><title>How to Maintain a Single-Tier System</title><style>pre.pygments .hll { background-color: #ffffcc }
pre.pygments { background: #f8f8f8; }
pre.pygments .tok-c { color: #3D7B7B; font-style: italic } /* Comment */
pre.pygments .tok-err { border: 1px solid #FF0000 } /* Error */
pre.pygments .tok-k { color: #008000; font-weight: bold } /* Keyword */
pre.pygments .tok-o { color: #666666 } /* Operator */
pre.pygments .tok-ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
pre.pygments .tok-cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
pre.pygments .tok-cp { color: #9C6500 } /* Comment.Preproc */
pre.pygments .tok-cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
pre.pygments .tok-c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
pre.pygments .tok-cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
pre.pygments .tok-gd { color: #A00000 } /* Generic.Deleted */
pre.pygments .tok-ge { font-style: italic } /* Generic.Emph */
pre.pygments .tok-gr { color: #E40000 } /* Generic.Error */
pre.pygments .tok-gh { color: #000080; font-weight: bold } /* Generic.Heading */
pre.pygments .tok-gi { color: #008400 } /* Generic.Inserted */
pre.pygments .tok-go { color: #717171 } /* Generic.Output */
pre.pygments .tok-gp { color: #000080; font-weight: bold } /* Generic.Prompt */
pre.pygments .tok-gs { font-weight: bold } /* Generic.Strong */
pre.pygments .tok-gu { color: #800080; font-weight: bold } /* Generic.Subheading */
pre.pygments .tok-gt { color: #0044DD } /* Generic.Traceback */
pre.pygments .tok-kc { color: #008000; font-weight: bold } /* Keyword.Constant */
pre.pygments .tok-kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
pre.pygments .tok-kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
pre.pygments .tok-kp { color: #008000 } /* Keyword.Pseudo */
pre.pygments .tok-kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
pre.pygments .tok-kt { color: #B00040 } /* Keyword.Type */
pre.pygments .tok-m { color: #666666 } /* Literal.Number */
pre.pygments .tok-s { color: #BA2121 } /* Literal.String */
pre.pygments .tok-na { color: #687822 } /* Name.Attribute */
pre.pygments .tok-nb { color: #008000 } /* Name.Builtin */
pre.pygments .tok-nc { color: #0000FF; font-weight: bold } /* Name.Class */
pre.pygments .tok-no { color: #880000 } /* Name.Constant */
pre.pygments .tok-nd { color: #AA22FF } /* Name.Decorator */
pre.pygments .tok-ni { color: #717171; font-weight: bold } /* Name.Entity */
pre.pygments .tok-ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
pre.pygments .tok-nf { color: #0000FF } /* Name.Function */
pre.pygments .tok-nl { color: #767600 } /* Name.Label */
pre.pygments .tok-nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
pre.pygments .tok-nt { color: #008000; font-weight: bold } /* Name.Tag */
pre.pygments .tok-nv { color: #19177C } /* Name.Variable */
pre.pygments .tok-ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
pre.pygments .tok-w { color: #bbbbbb } /* Text.Whitespace */
pre.pygments .tok-mb { color: #666666 } /* Literal.Number.Bin */
pre.pygments .tok-mf { color: #666666 } /* Literal.Number.Float */
pre.pygments .tok-mh { color: #666666 } /* Literal.Number.Hex */
pre.pygments .tok-mi { color: #666666 } /* Literal.Number.Integer */
pre.pygments .tok-mo { color: #666666 } /* Literal.Number.Oct */
pre.pygments .tok-sa { color: #BA2121 } /* Literal.String.Affix */
pre.pygments .tok-sb { color: #BA2121 } /* Literal.String.Backtick */
pre.pygments .tok-sc { color: #BA2121 } /* Literal.String.Char */
pre.pygments .tok-dl { color: #BA2121 } /* Literal.String.Delimiter */
pre.pygments .tok-sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
pre.pygments .tok-s2 { color: #BA2121 } /* Literal.String.Double */
pre.pygments .tok-se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
pre.pygments .tok-sh { color: #BA2121 } /* Literal.String.Heredoc */
pre.pygments .tok-si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
pre.pygments .tok-sx { color: #008000 } /* Literal.String.Other */
pre.pygments .tok-sr { color: #A45A77 } /* Literal.String.Regex */
pre.pygments .tok-s1 { color: #BA2121 } /* Literal.String.Single */
pre.pygments .tok-ss { color: #19177C } /* Literal.String.Symbol */
pre.pygments .tok-bp { color: #008000 } /* Name.Builtin.Pseudo */
pre.pygments .tok-fm { color: #0000FF } /* Name.Function.Magic */
pre.pygments .tok-vc { color: #19177C } /* Name.Variable.Class */
pre.pygments .tok-vg { color: #19177C } /* Name.Variable.Global */
pre.pygments .tok-vi { color: #19177C } /* Name.Variable.Instance */
pre.pygments .tok-vm { color: #19177C } /* Name.Variable.Magic */
pre.pygments .tok-il { color: #666666 } /* Literal.Number.Integer.Long */</style><link rel="icon" type="image/x-icon" href="/stylesheets/images/favicon.ico"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3"><link rel="preconnect" href="https://S2ISXITURI-dsn.algolia.net"><link rel="stylesheet" href='stylesheets/bootstrap.min.css'><link rel="stylesheet" href='stylesheets/bootstrap-toc.min.css'><link rel="stylesheet" href="stylesheets/kb.css"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="description" content="How to Maintain a Single-Tier System"></head><body data-spy="scroll" data-target="#myScrollspy" data-offset="100"><div class="loader-wrapper"><div id="loading"></div></div><header class="header sticky" id="header"><div class="header-wrapper"><div class="container-fluid"><div class="row flex-xl-nowrap justify-content-evenly"><div class="header-logo"><div class="logo"><a href="/"><img src="/stylesheets/images/logo/light-logo.svg" style="height:38px" alt="Kill Bill Docs" id="logo" height="38" width="146"></a></div><div class="switch"><input type="checkbox" aria-label="Search" name="theme-toggle" id="theme-toggle"><span class="slider round"></span></div></div><div class="nav-toggler sidebar-toggler"><svg class="hamburger" xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M20.75 7C20.75 7.41421 20.4142 7.75 20 7.75L4 7.75C3.58579 7.75 3.25 7.41421 3.25 7C3.25 6.58579 3.58579 6.25 4 6.25L20 6.25C20.4142 6.25 20.75 6.58579 20.75 7Z" fill=""/><path fill-rule="evenodd" clip-rule="evenodd" d="M20.75 12C20.75 12.4142 20.4142 12.75 20 12.75L4 12.75C3.58579 12.75 3.25 12.4142 3.25 12C3.25 11.5858 3.58579 11.25 4 11.25L20 11.25C20.4142 11.25 20.75 11.5858 20.75 12Z" fill=""/><path fill-rule="evenodd" clip-rule="evenodd" d="M20.75 17C20.75 17.4142 20.4142 17.75 20 17.75L4 17.75C3.58579 17.75 3.25 17.4142 3.25 17C3.25 16.5858 3.58579 16.25 4 16.25L20 16.25C20.4142 16.25 20.75 16.5858 20.75 17Z" fill=""/></svg></div><div class="header-search"><div class="search-form-wrapper"><div id="docsearch" style="height: 43px; display: flex; align-items: center; width: 100%;"></div></div></div></div></div></div></header><main class="main sidebar-show"><div class="container-fluid"><div class="row flex-xl-nowrap"><div class="sidebar-wrapper"><aside class="sidebar"><div class="sidebar__control"><svg width="8" height="12" viewBox="0 0 8 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.33316 10.6665L1.6665 5.99992L6.33316 1.33325" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></div><nav class="sidebar-nav"><ul class="nav navbar-nav"><li><div class="icon-title"><a class="bd-toc-link main-link" role="button">Getting Started</a><svg class="chevron" width="11" height="6" viewBox="0 0 11 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.5024 5.70711C10.1119 6.09763 9.47871 6.09763 9.08818 5.70711L5.7953 2.41421L2.50241 5.70711C2.11188 6.09763 1.47872 6.09763 1.0882 5.70711C0.697672 5.31658 0.697672 4.68342 1.0882 4.29289L5.08819 0.292893C5.47871 -0.0976311 6.11188 -0.0976311 6.5024 0.292893L10.5024 4.29289C10.8929 4.68342 10.8929 5.31658 10.5024 5.70711Z" fill="#D1D5DB"/></svg></div><ul class="nav navbar-nav"><li><a class="nav-link" href="/latest/what_is_kill_bill.html">What is Kill Bill?</a></li><li><a class="nav-link" href="/latest/getting_started.html">Getting Started (Installation)</a></li><li><a class="nav-link" href="/latest/quick_start_with_kaui.html">Quick Start with Kaui</a></li><li><a class="nav-link" href="/latest/quick_start_with_kb_api.html">Quick Start with the Kill Bill API</a></li></ul></li><li><div class="icon-title"><a class="bd-toc-link main-link" role="button">Installation</a><svg class="chevron" width="11" height="6" viewBox="0 0 11 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.5024 5.70711C10.1119 6.09763 9.47871 6.09763 9.08818 5.70711L5.7953 2.41421L2.50241 5.70711C2.11188 6.09763 1.47872 6.09763 1.0882 5.70711C0.697672 5.31658 0.697672 4.68342 1.0882 4.29289L5.08819 0.292893C5.47871 -0.0976311 6.11188 -0.0976311 6.5024 0.292893L10.5024 4.29289C10.8929 4.68342 10.8929 5.31658 10.5024 5.70711Z" fill="#D1D5DB"/></svg></div><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a class="nav-link" href="/latest/stripe_plugin.html">Kill Bill + Stripe DIY</a></li><li><a class="nav-link" href="/latest/userguide_deployment.html">Going to Production</a></li><li><a class="nav-link" href="/latest/how-to-upgrade-the-database.html">Database Migrations</a></li><li><a class="nav-link" href="/latest/PostgreSQL.html">PostgreSQL Setup</a></li><li><a class="nav-link" href="https://github.com/killbill/killbill/releases" onclick="getOutboundLink('https://github.com/killbill/killbill/releases'); return false;">Release&nbsp;Notes</a></li></ul></li><li><div class="icon-title"><a class="bd-toc-link main-link" role="button">AWS</a><svg class="chevron" width="11" height="6" viewBox="0 0 11 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.5024 5.70711C10.1119 6.09763 9.47871 6.09763 9.08818 5.70711L5.7953 2.41421L2.50241 5.70711C2.11188 6.09763 1.47872 6.09763 1.0882 5.70711C0.697672 5.31658 0.697672 4.68342 1.0882 4.29289L5.08819 0.292893C5.47871 -0.0976311 6.11188 -0.0976311 6.5024 0.292893L10.5024 4.29289C10.8929 4.68342 10.8929 5.31658 10.5024 5.70711Z" fill="#D1D5DB"/></svg></div><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a class="nav-link" href="/latest/aws.html">AWS Introduction</a></li><li><a class="nav-link" href="/latest/how-to-set-up-a-single-tier-system.html">Single-Tier Setup</a></li><li><a class="nav-link" href="/latest/how-to-set-up-a-multi-tier-system.html">Multi-Tier Setup</a></li><li><a class="nav-link" href="/latest/how-to-set-up-a-cloud-formation-system.html">CloudFormation Setup</a></li><li><a class="nav-link" href="/latest/aws-container.html">AWS Container Setup</a></li><li><a class="nav-link" href="/latest/how-to-maintain-a-single-tier-system.html">Single-Tier Maintenance</a></li><li><a class="nav-link" href="/latest/how-to-maintain-a-multi-tier-system.html">Multi-Tier Maintenance</a></li><li><a class="nav-link" href="/latest/how-to-maintain-a-cloud-formation-system.html">CloudFormation Maintenance</a></li><li><a class="nav-link" href="/latest/explanation-https-and-certificates.html">HTTPS and Certificates</a></li><li><a class="nav-link" href="/latest/how-to-add-a-certificate-using-ACM.html">How to add a certificate using ACM</a></li><li><a class="nav-link" href="/latest/using-ses-with-aws.html">Using SES with AWS</a></li><li><a class="nav-link" href="/latest/aws-tools.html">AWS Observability Tools</a></li><li><a class="nav-link" href="/latest/metrics-datadog.html">Managing Metrics with Datadog</a></li><li><a class="nav-link" href="/latest/metrics-newrelic.html">Managing Metrics with New Relic</a></li><li><a class="nav-link" href="/latest/metrics-cloudwatch.html">Managing Metrics with Cloudwatch</a></li><li><a class="nav-link" href="/latest/errors-rollbar.html">Error Tracking with Rollbar</a></li><li><a class="nav-link" href="/latest/errors-sentry.html">Error Tracking with Sentry</a></li></ul></li><li><div class="icon-title"><a class="bd-toc-link main-link" role="button">Manuals</a><svg class="chevron" width="11" height="6" viewBox="0 0 11 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.5024 5.70711C10.1119 6.09763 9.47871 6.09763 9.08818 5.70711L5.7953 2.41421L2.50241 5.70711C2.11188 6.09763 1.47872 6.09763 1.0882 5.70711C0.697672 5.31658 0.697672 4.68342 1.0882 4.29289L5.08819 0.292893C5.47871 -0.0976311 6.11188 -0.0976311 6.5024 0.292893L10.5024 4.29289C10.8929 4.68342 10.8929 5.31658 10.5024 5.70711Z" fill="#D1D5DB"/></svg></div><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a class="nav-link" href="/latest/userguide_subscription.html">Subscription&nbsp;Billing</a></li><li><a class="nav-link" href="/latest/userguide_payment.html">Payment Processing</a></li><li><a class="nav-link" href="/latest/userguide_kaui.html">Kaui, the Administrative&nbsp;UI</a></li><li><a class="nav-link" href="/latest/email-notification-plugin.html">Email Notification Plugin</a></li><li><a class="nav-link" href="/latest/custom-email-invoice-formatter.html">Custom Email Formatter</a></li><li><a class="nav-link" href="/latest/userguide_analytics.html">Analytics Plugin</a></li><li><a class="nav-link" href="/latest/userguide_configuration.html">Kill Bill&nbsp;Configuration</a></li><li><a class="nav-link" href="/latest/internationalization.html">Kill Bill&nbsp;Internationalization</a></li><li><a class="nav-link" href="/latest/migration_guide.html">Migrating to Kill Bill</a></li></ul></li><li><div class="icon-title"><a class="bd-toc-link main-link" role="button">Tutorials</a><svg class="chevron" width="11" height="6" viewBox="0 0 11 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.5024 5.70711C10.1119 6.09763 9.47871 6.09763 9.08818 5.70711L5.7953 2.41421L2.50241 5.70711C2.11188 6.09763 1.47872 6.09763 1.0882 5.70711C0.697672 5.31658 0.697672 4.68342 1.0882 4.29289L5.08819 0.292893C5.47871 -0.0976311 6.11188 -0.0976311 6.5024 0.292893L10.5024 4.29289C10.8929 4.68342 10.8929 5.31658 10.5024 5.70711Z" fill="#D1D5DB"/></svg></div><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a class="nav-link" href="/latest/plan_alignment.html">Plans Alignments</a></li><li><a class="nav-link" href="/latest/overdue.html">Overdue System</a></li><li><a class="nav-link" href="/latest/consumable_in_arrear.html">In Arrear UsageBilling</a></li><li><a class="nav-link" href="/latest/ha.html">Hierarchical Accounts</a></li><li><a class="nav-link" href="/latest/catalog-examples.html">Catalog Examples</a></li><li><a class="nav-link" href="/latest/invoice_examples.html">Invoice Examples</a></li><li><a class="nav-link" href="/latest/invoice_templates.html">Invoice Templates</a></li></ul></li><li><div class="icon-title"><a class="bd-toc-link main-link" role="button">Integration</a><svg class="chevron" width="11" height="6" viewBox="0 0 11 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.5024 5.70711C10.1119 6.09763 9.47871 6.09763 9.08818 5.70711L5.7953 2.41421L2.50241 5.70711C2.11188 6.09763 1.47872 6.09763 1.0882 5.70711C0.697672 5.31658 0.697672 4.68342 1.0882 4.29289L5.08819 0.292893C5.47871 -0.0976311 6.11188 -0.0976311 6.5024 0.292893L10.5024 4.29289C10.8929 4.68342 10.8929 5.31658 10.5024 5.70711Z" fill="#D1D5DB"/></svg></div><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a class="nav-link" href="http://killbill.github.io/slate" onclick="getOutboundLink('http://killbill.github.io/slate'); return false;">REST API Reference</a></li><li><a class="nav-link" href="/latest/swagger_documentation.html">Swagger UI Documentation</a></li><li><a class="nav-link" href="/latest/postman.html">Postman Integration</a></li><li><a class="nav-link" href="/latest/debugging.html">Debugging</a></li><li><a class="nav-link" href="/latest/push_notifications.html">Push Notifications</a></li><li><a class="nav-link" href="/latest/kill_bill_events.html">Kill Bill Events</a></li><li><a class="nav-link" href="/latest/events-to-aws-sqs.html">Kill Bill Events to AWS SQS</a></li><li><a class="nav-link" href="/latest/how-to-use-kpm-diagnostic.html">KPM Diagnostic Usage</a></li></ul></li><li><div class="icon-title"><a class="bd-toc-link main-link" role="button">Plugin Development</a><svg class="chevron" width="11" height="6" viewBox="0 0 11 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.5024 5.70711C10.1119 6.09763 9.47871 6.09763 9.08818 5.70711L5.7953 2.41421L2.50241 5.70711C2.11188 6.09763 1.47872 6.09763 1.0882 5.70711C0.697672 5.31658 0.697672 4.68342 1.0882 4.29289L5.08819 0.292893C5.47871 -0.0976311 6.11188 -0.0976311 6.5024 0.292893L10.5024 4.29289C10.8929 4.68342 10.8929 5.31658 10.5024 5.70711Z" fill="#D1D5DB"/></svg></div><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a class="nav-link" href="/latest/plugin_introduction.html">Plugin Introduction</a></li><li class="bd-sidenav-active"><a class="nav-link" href="/latest/plugin_development.html">Plugin Development</a></li><li class="bd-sidenav-active"><a class="nav-link" href="/latest/plugin_installation.html">Plugin Installation</a></li><li><a class="nav-link" href="/latest/plugin_use_cases.html">Special Plugin Use Cases</a></li><li><a class="nav-link" href="/latest/notification_plugin.html">Notification Plugins</a></li><li><a class="nav-link" href="/latest/payment_plugin.html">Payment Plugins</a></li><li><a class="nav-link" href="/latest/payment_control_plugin.html">Payment Control Plugins</a></li><li><a class="nav-link" href="/latest/usage_plugin.html">Usage Plugins</a></li><li><a class="nav-link" href="/latest/invoice_plugin.html">Invoice Plugins</a></li><li><a class="nav-link" href="/latest/catalog_plugin.html">Catalog Plugins</a></li><li><a class="nav-link" href="/latest/entitlement_plugin.html">Entitlement Plugins</a></li></ul></li><li><div class="icon-title"><a class="bd-toc-link main-link" role="button">Operational Guides</a><svg class="chevron" width="11" height="6" viewBox="0 0 11 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.5024 5.70711C10.1119 6.09763 9.47871 6.09763 9.08818 5.70711L5.7953 2.41421L2.50241 5.70711C2.11188 6.09763 1.47872 6.09763 1.0882 5.70711C0.697672 5.31658 0.697672 4.68342 1.0882 4.29289L5.08819 0.292893C5.47871 -0.0976311 6.11188 -0.0976311 6.5024 0.292893L10.5024 4.29289C10.8929 4.68342 10.8929 5.31658 10.5024 5.70711Z" fill="#D1D5DB"/></svg></div><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a class="nav-link" href="/latest/deploy_to_kubernetes.html">Kubernetes (K8s) Deployment</a></li><li class="bd-sidenav-active"><a class="nav-link" href="/latest/user_management.html">Users, Roles, and Permissions</a></li><li><a class="nav-link" href="/latest/plugin_management.html">Plugin Management</a></li></ul></li><li><div class="icon-title"><a class="bd-toc-link main-link" role="button">Client Libraries</a><svg class="chevron" width="11" height="6" viewBox="0 0 11 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.5024 5.70711C10.1119 6.09763 9.47871 6.09763 9.08818 5.70711L5.7953 2.41421L2.50241 5.70711C2.11188 6.09763 1.47872 6.09763 1.0882 5.70711C0.697672 5.31658 0.697672 4.68342 1.0882 4.29289L5.08819 0.292893C5.47871 -0.0976311 6.11188 -0.0976311 6.5024 0.292893L10.5024 4.29289C10.8929 4.68342 10.8929 5.31658 10.5024 5.70711Z" fill="#D1D5DB"/></svg></div><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a class="nav-link" href="/latest/java_client.html">Java</a></li><li><a class="nav-link" href="http://github.com/killbill/killbill-client-ruby" onclick="getOutboundLink('http://github.com/killbill/killbill-client-ruby'); return false;">Ruby</a></li><li><a class="nav-link" href="http://github.com/killbill/killbill-client-php" onclick="getOutboundLink('http://github.com/killbill/killbill-client-php'); return false;">PHP</a></li><li><a class="nav-link" href="http://github.com/killbill/killbill-client-js" onclick="getOutboundLink('http://github.com/killbill/killbill-client-js'); return false;">Node.js</a></li><li><a class="nav-link" href="http://github.com/killbill/killbill-client-python" onclick="getOutboundLink('http://github.com/killbill/killbill-client-python'); return false;">Python</a></li><li><a class="nav-link" href="http://github.com/killbill/kbcli" onclick="getOutboundLink('http://github.com/killbill/kbcli'); return false;">KillBill Go </a></li></ul></li><li><div class="icon-title"><a class="bd-toc-link main-link" role="button">About Kill Bill</a><svg class="chevron" width="11" height="6" viewBox="0 0 11 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.5024 5.70711C10.1119 6.09763 9.47871 6.09763 9.08818 5.70711L5.7953 2.41421L2.50241 5.70711C2.11188 6.09763 1.47872 6.09763 1.0882 5.70711C0.697672 5.31658 0.697672 4.68342 1.0882 4.29289L5.08819 0.292893C5.47871 -0.0976311 6.11188 -0.0976311 6.5024 0.292893L10.5024 4.29289C10.8929 4.68342 10.8929 5.31658 10.5024 5.70711Z" fill="#D1D5DB"/></svg></div><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a class="nav-link" href="/latest/demo.html">Demo</a></li><li><a class="nav-link" href="/latest/features.html">Features List</a></li><li><a class="nav-link" href="/latest/faq.html">Technical FAQs</a></li><li><a class="nav-link" href="/latest/Kill-Bill-Glossary.html">Glossary</a></li></ul></li><li><div class="icon-title"><a class="bd-toc-link main-link" role="button">Internal</a><svg class="chevron" width="11" height="6" viewBox="0 0 11 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.5024 5.70711C10.1119 6.09763 9.47871 6.09763 9.08818 5.70711L5.7953 2.41421L2.50241 5.70711C2.11188 6.09763 1.47872 6.09763 1.0882 5.70711C0.697672 5.31658 0.697672 4.68342 1.0882 4.29289L5.08819 0.292893C5.47871 -0.0976311 6.11188 -0.0976311 6.5024 0.292893L10.5024 4.29289C10.8929 4.68342 10.8929 5.31658 10.5024 5.70711Z" fill="#D1D5DB"/></svg></div><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a class="nav-link" href="/latest/internal_design.html">Internal Design</a></li><li><a class="nav-link" href="/latest/entitlement_subsystem.html">Entitlement Subsystem</a></li><li><a class="nav-link" href="/latest/invoice_subsystem.html">Invoice Subsystem</a></li><li><a class="nav-link" href="/latest/development.html">Development Environment</a></li></ul></li><li><div class="icon-title"><a class="bd-toc-link main-link" role="button">References</a><svg class="chevron" width="11" height="6" viewBox="0 0 11 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.5024 5.70711C10.1119 6.09763 9.47871 6.09763 9.08818 5.70711L5.7953 2.41421L2.50241 5.70711C2.11188 6.09763 1.47872 6.09763 1.0882 5.70711C0.697672 5.31658 0.697672 4.68342 1.0882 4.29289L5.08819 0.292893C5.47871 -0.0976311 6.11188 -0.0976311 6.5024 0.292893L10.5024 4.29289C10.8929 4.68342 10.8929 5.31658 10.5024 5.70711Z" fill="#D1D5DB"/></svg></div><ul class="nav navbar-nav"><li class="bd-sidenav-active"><a class="nav-link" href="https://github.com/killbill/killbill-docs/tree/v3/swagger" onclick="getOutboundLink('https://github.com/killbill/killbill-docs/tree/v3/swagger'); return false;">Swagger&nbsp;API Schema</a></li><li><a class="nav-link" href="/latest/catalog.xsd">Catalog XSD Reference</a></li><li><a class="nav-link" href="/latest/overdue.xsd">Overdue XSD Reference</a></li></ul></li></ul></nav><a class="doclink" href="mailto:support@killbill.io">Report a doc problem</a></aside></div><div class="article-container"><div class="center-content"><div class="main-wrapper"><article class="content-wrapper"><div class="banner"><h1>How to Maintain a Single-Tier System</h1></div><div id="content"><div class="sect1">
<h2 id="_overview">Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This guide explains how to maintain your single-tier Kill Bill installation on AWS.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_log_in">Log in</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To perform most maintenance tasks you will need to log in to your EC2 instance. Be sure that SSH is enabled on Port 22 in your security group. Login procedures are described in the setup guide  (See <a href="https://docs.killbill.io/latest/how-to-set-up-a-single-tier-system.html#step_7_login_to_your_instance">Step 7: Login to an Instance</a>)</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_troubleshooting">Troubleshooting</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If a new installation does not seem to work correctly, the first step is to review your installation process carefully, to be sure that everything has been done and checked as described in the <a href="https://docs.killbill.io/latest/how-to-set-up-a-single-tier-system">setup guide</a>. If problems persist, we will be glad to work with you to identify the problem. To help us to do this, there are several information reports that you may need to gather. These reports are somewhat technical but can be analyzed by Kill Bill personnel. This section explains how to obtain the reports that may be needed.</p>
</div>
<div class="sect2">
<h3 id="_status_reports">Status Reports</h3>
<div class="paragraph">
<p>When you launch the EC2 instance,  all required services should be enabled and running, including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An instance of <code>nginx</code> receiving traffic on port <code>443</code> and <code>8443</code></p>
</li>
<li>
<p>An instance of Kill Bill server listening on <code>127.0.0.1:8080</code> (and receiving external traffic through nginx on port <code>8443</code>)</p>
</li>
<li>
<p>An instance of Kaui listening on <code>127.0.0.1:3000</code> (and receiving external traffic through nginx on port <code>443</code>)</p>
</li>
<li>
<p>A local <code>mysql</code> server running on port <code>3306</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The status of nginx/KB/mysql services can be checked by the following commands:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Kill Bill service: <code>sudo service killbill status</code></p>
</li>
<li>
<p>Nginx service: <code>sudo service nginx status</code></p>
</li>
<li>
<p>Mysql service: <code>sudo service mysql status</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For each report there should be a line near the top with the following form:</p>
</div>
<div class="paragraph">
<p><code>Active: active (running) since Sat 2020-10-24 20:13:43 UTC; 1 day 1h ago</code></p>
</div>
<div class="paragraph">
<p>You can <code>start</code> or <code>stop</code> the services using similar commands, such as <code>sudo service killbill stop</code> to stop Kill Bill. If any service is not active, try starting it using the appropriate command.</p>
</div>
<div class="paragraph">
<p>If all services are running, the next step is to collect several reports.</p>
</div>
</div>
<div class="sect2">
<h3 id="_log_files">Log Files</h3>
<div class="paragraph">
<p>The system maintains a series of log files that may be helpful when troubleshooting is needed. These logs may be forwarded to Kill Bill to help diagnose your problem.</p>
</div>
<div class="paragraph">
<p>Tomcat/KB/Kaui logs are under <code>/var/lib/tomcat/logs/</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Kaui log: <code>/var/lib/tomcat/logs/kaui.out</code></p>
</li>
<li>
<p>Kill Bill server log: <code>/var/lib/tomcat/logs/killbill.out</code></p>
</li>
<li>
<p>Complete tomcat log: <code>/var/lib/tomcat/logs/catalina.out</code></p>
</li>
<li>
<p>Access requests to the servers: <code>localhost_access_log*.txt</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Sometimes these logs will clearly show anomalies that will pinpoint the problem. If not you should forward your logs to Kill Bill for review.Some of these logs may be very large, especially catalina.out.</p>
</div>
</div>
<div class="sect2">
<h3 id="_logging_configuration">Logging Configuration</h3>
<div class="paragraph">
<p>The logging configuration, including settings for log rotation and log levels, is defined in the <code>logback.xml file</code>. Separate <code>logback.xml</code> files are used for KB and Kaui, located at the following paths:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>KB logback file: <code>/var/lib/tomcat/webapps/ROOT/WEB-INF/classes/logback.xml</code></p>
</li>
<li>
<p>Kaui logback file: <code>/var/lib/tomcat/webapps2/ROOT/WEB-INF/classes/logback.xml</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These files can be modified to customize the logging settings for KB and Kaui. By default, the log level is configured as <code>INFO</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_system_health_check">System Health Check</h3>
<div class="paragraph">
<p>The healthcheck report checks the health of various software components, and determines if any queues are growing improperly over time. To create this report, issue the following command:</p>
</div>
<div class="paragraph">
<p><code>curl http://127.0.0.1:8080/1.0/healthcheck</code></p>
</div>
<div class="paragraph">
<p>This will return a series of messages giving the health status of each component. These messages may look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span></span><span class="tok-w">  </span>%<span class="tok-w"> </span>Total<span class="tok-w">    </span>%<span class="tok-w"> </span>Received<span class="tok-w"> </span>%<span class="tok-w"> </span>Xferd<span class="tok-w">  </span>Average<span class="tok-w"> </span>Speed<span class="tok-w">   </span>Time<span class="tok-w">    </span>Time<span class="tok-w">     </span>Time<span class="tok-w">  </span>Current
<span class="tok-w">                                 </span>Dload<span class="tok-w">  </span>Upload<span class="tok-w">   </span>Total<span class="tok-w">   </span>Spent<span class="tok-w">    </span>Left<span class="tok-w">  </span>Speed
<span class="tok-m">100</span><span class="tok-w">  </span><span class="tok-m">1412</span><span class="tok-w">    </span><span class="tok-m">0</span><span class="tok-w">  </span><span class="tok-m">1412</span><span class="tok-w">    </span><span class="tok-m">0</span><span class="tok-w">     </span><span class="tok-m">0</span><span class="tok-w">  </span><span class="tok-m">54307</span><span class="tok-w">      </span><span class="tok-m">0</span><span class="tok-w"> </span>--:--:--<span class="tok-w"> </span>--:--:--<span class="tok-w"> </span>--:--:--<span class="tok-w"> </span><span class="tok-m">56480</span>
<span class="tok-o">{</span>
<span class="tok-w">  </span><span class="tok-s2">&quot;main.pool.ConnectivityCheck&quot;</span>:<span class="tok-w"> </span><span class="tok-o">{</span>
<span class="tok-w">    </span><span class="tok-s2">&quot;healthy&quot;</span>:<span class="tok-w"> </span><span class="tok-nb">true</span>
<span class="tok-w">  </span><span class="tok-o">}</span>,
<span class="tok-w">  </span><span class="tok-s2">&quot;org.killbill.billing.server.healthchecks.KillbillHealthcheck&quot;</span>:<span class="tok-w"> </span><span class="tok-o">{</span>
<span class="tok-w">    </span><span class="tok-s2">&quot;healthy&quot;</span>:<span class="tok-w"> </span>true,
<span class="tok-w">    </span><span class="tok-s2">&quot;message&quot;</span>:<span class="tok-w"> </span><span class="tok-s2">&quot;OK&quot;</span>
<span class="tok-w">  </span><span class="tok-o">}</span>,
<span class="tok-w">  </span><span class="tok-s2">&quot;org.killbill.billing.server.healthchecks.KillbillPluginsHealthcheck&quot;</span>:<span class="tok-w"> </span><span class="tok-o">{</span>
<span class="tok-w">    </span><span class="tok-s2">&quot;healthy&quot;</span>:<span class="tok-w"> </span><span class="tok-nb">true</span>
<span class="tok-w">  </span><span class="tok-o">}</span>,
<span class="tok-w">  </span><span class="tok-s2">&quot;org.killbill.billing.server.healthchecks.KillbillQueuesHealthcheck&quot;</span>:<span class="tok-w"> </span><span class="tok-o">{</span>
<span class="tok-w">    </span><span class="tok-s2">&quot;healthy&quot;</span>:<span class="tok-w"> </span>true,
<span class="tok-w">    </span><span class="tok-s2">&quot;bus&quot;</span>:<span class="tok-w"> </span><span class="tok-o">{</span>
<span class="tok-w">      </span><span class="tok-s2">&quot;growing&quot;</span>:<span class="tok-w"> </span><span class="tok-nb">false</span>
<span class="tok-w">    </span><span class="tok-o">}</span>,
<span class="tok-w">    </span><span class="tok-s2">&quot;overdue-service:overdue-check-queue&quot;</span>:<span class="tok-w"> </span><span class="tok-o">{</span>
<span class="tok-w">      </span><span class="tok-s2">&quot;growing&quot;</span>:<span class="tok-w"> </span><span class="tok-nb">false</span>
<span class="tok-w">    </span><span class="tok-o">}</span>,
<span class="tok-w">    </span><span class="tok-s2">&quot;notifications-retries:overdue-check-queue&quot;</span>:<span class="tok-w"> </span><span class="tok-o">{</span>
<span class="tok-w">      </span><span class="tok-s2">&quot;growing&quot;</span>:<span class="tok-w"> </span><span class="tok-nb">false</span>
<span class="tok-w">    </span><span class="tok-o">}</span>,
<span class="tok-w">    </span><span class="tok-s2">&quot;entitlement-service:entitlement-events&quot;</span>:<span class="tok-w"> </span><span class="tok-o">{</span>
<span class="tok-w">      </span><span class="tok-s2">&quot;growing&quot;</span>:<span class="tok-w"> </span><span class="tok-nb">false</span>
<span class="tok-w">    </span><span class="tok-o">}</span>,
<span class="tok-w">    </span><span class="tok-s2">&quot;invoice-service:next-billing-date-queue&quot;</span>:<span class="tok-w"> </span><span class="tok-o">{</span>
<span class="tok-w">      </span><span class="tok-s2">&quot;growing&quot;</span>:<span class="tok-w"> </span><span class="tok-nb">false</span>
<span class="tok-w">    </span><span class="tok-o">}</span>,
<span class="tok-w">    </span><span class="tok-s2">&quot;notifications-retries:extBusEvent-listener&quot;</span>:<span class="tok-w"> </span><span class="tok-o">{</span>
<span class="tok-w">      </span><span class="tok-s2">&quot;growing&quot;</span>:<span class="tok-w"> </span><span class="tok-nb">false</span>
<span class="tok-w">    </span><span class="tok-o">}</span>,
<span class="tok-w">    </span><span class="tok-s2">&quot;payment-service:janitor&quot;</span>:<span class="tok-w"> </span><span class="tok-o">{</span>
<span class="tok-w">      </span><span class="tok-s2">&quot;growing&quot;</span>:<span class="tok-w"> </span><span class="tok-nb">false</span>
<span class="tok-w">    </span><span class="tok-o">}</span>,
<span class="tok-w">    </span><span class="tok-s2">&quot;externalBus&quot;</span>:<span class="tok-w"> </span><span class="tok-o">{</span>
<span class="tok-w">      </span><span class="tok-s2">&quot;growing&quot;</span>:<span class="tok-w"> </span><span class="tok-nb">false</span>
<span class="tok-w">    </span><span class="tok-o">}</span>,
<span class="tok-w">    </span><span class="tok-s2">&quot;payment-service:retry&quot;</span>:<span class="tok-w"> </span><span class="tok-o">{</span>
<span class="tok-w">      </span><span class="tok-s2">&quot;growing&quot;</span>:<span class="tok-w"> </span><span class="tok-nb">false</span>
<span class="tok-w">    </span><span class="tok-o">}</span>,
<span class="tok-w">    </span><span class="tok-s2">&quot;notifications-retries:next-billing-date-queue&quot;</span>:<span class="tok-w"> </span><span class="tok-o">{</span>
<span class="tok-w">      </span><span class="tok-s2">&quot;growing&quot;</span>:<span class="tok-w"> </span><span class="tok-nb">false</span>
<span class="tok-w">    </span><span class="tok-o">}</span>,
<span class="tok-w">    </span><span class="tok-s2">&quot;notifications-retries:payment-bus-handler&quot;</span>:<span class="tok-w"> </span><span class="tok-o">{</span>
<span class="tok-w">      </span><span class="tok-s2">&quot;growing&quot;</span>:<span class="tok-w"> </span><span class="tok-nb">false</span>
<span class="tok-w">    </span><span class="tok-o">}</span>,
<span class="tok-w">    </span><span class="tok-s2">&quot;subscription-service:subscription-events&quot;</span>:<span class="tok-w"> </span><span class="tok-o">{</span>
<span class="tok-w">      </span><span class="tok-s2">&quot;growing&quot;</span>:<span class="tok-w"> </span><span class="tok-nb">false</span>
<span class="tok-w">    </span><span class="tok-o">}</span>,
<span class="tok-w">    </span><span class="tok-s2">&quot;invoice-service:parent-invoice-commitment-queue&quot;</span>:<span class="tok-w"> </span><span class="tok-o">{</span>
<span class="tok-w">      </span><span class="tok-s2">&quot;growing&quot;</span>:<span class="tok-w"> </span><span class="tok-nb">false</span>
<span class="tok-w">    </span><span class="tok-o">}</span>,
<span class="tok-w">    </span><span class="tok-s2">&quot;server-service:push-notification-queue&quot;</span>:<span class="tok-w"> </span><span class="tok-o">{</span>
<span class="tok-w">      </span><span class="tok-s2">&quot;growing&quot;</span>:<span class="tok-w"> </span><span class="tok-nb">false</span>
<span class="tok-w">    </span><span class="tok-o">}</span>,
<span class="tok-w">    </span><span class="tok-s2">&quot;notifications-retries:overdue-async-bus-queue&quot;</span>:<span class="tok-w"> </span><span class="tok-o">{</span>
<span class="tok-w">      </span><span class="tok-s2">&quot;growing&quot;</span>:<span class="tok-w"> </span><span class="tok-nb">false</span>
<span class="tok-w">    </span><span class="tok-o">}</span>,
<span class="tok-w">    </span><span class="tok-s2">&quot;overdue-service:overdue-async-bus-queue&quot;</span>:<span class="tok-w"> </span><span class="tok-o">{</span>
<span class="tok-w">      </span><span class="tok-s2">&quot;growing&quot;</span>:<span class="tok-w"> </span><span class="tok-nb">false</span>
<span class="tok-w">    </span><span class="tok-o">}</span>,
<span class="tok-w">    </span><span class="tok-s2">&quot;notifications-retries:payment-service&quot;</span>:<span class="tok-w"> </span><span class="tok-o">{</span>
<span class="tok-w">      </span><span class="tok-s2">&quot;growing&quot;</span>:<span class="tok-w"> </span><span class="tok-nb">false</span>
<span class="tok-w">    </span><span class="tok-o">}</span>,
<span class="tok-w">    </span><span class="tok-s2">&quot;notifications-retries:invoice-listener&quot;</span>:<span class="tok-w"> </span><span class="tok-o">{</span>
<span class="tok-w">      </span><span class="tok-s2">&quot;growing&quot;</span>:<span class="tok-w"> </span><span class="tok-nb">false</span>
<span class="tok-w">    </span><span class="tok-o">}</span>
<span class="tok-w">  </span><span class="tok-o">}</span>,
<span class="tok-w">  </span><span class="tok-s2">&quot;osgi.pool.ConnectivityCheck&quot;</span>:<span class="tok-w"> </span><span class="tok-o">{</span>
<span class="tok-w">    </span><span class="tok-s2">&quot;healthy&quot;</span>:<span class="tok-w"> </span><span class="tok-nb">true</span>
<span class="tok-w">  </span><span class="tok-o">}</span>,
<span class="tok-w">  </span><span class="tok-s2">&quot;shiro.pool.ConnectivityCheck&quot;</span>:<span class="tok-w"> </span><span class="tok-o">{</span>
<span class="tok-w">    </span><span class="tok-s2">&quot;healthy&quot;</span>:<span class="tok-w"> </span><span class="tok-nb">true</span>
<span class="tok-w">  </span><span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>An unexpected message may indicate a component that is not working properly.</p>
</div>
</div>
<div class="sect2">
<h3 id="_system_information">System Information</h3>
<div class="paragraph">
<p>For a detailed system information report, showing the current version of each component, use the following command:</p>
</div>
<div class="paragraph">
<p><code>curl -u &lt;ADMIN&gt;:&lt;INSTANCE_ID&gt; http://127.0.0.1:8080/1.0/kb/nodesInfo</code></p>
</div>
<div class="paragraph">
<p>Here &lt;ADMIN&gt; is your Kaui administrator username, and &lt;INSTANCE_ID&gt; is your EC2 instance ID. THe output will look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span></span><span class="tok-o">[</span>
<span class="tok-w">  </span><span class="tok-o">{</span>
<span class="tok-w">    </span><span class="tok-s2">&quot;nodeName&quot;</span>:<span class="tok-w"> </span><span class="tok-s2">&quot;ip-192-168-241-89.ec2.internal&quot;</span>,
<span class="tok-w">    </span><span class="tok-s2">&quot;bootTime&quot;</span>:<span class="tok-w"> </span><span class="tok-s2">&quot;2024-07-11T07:30:59.000Z&quot;</span>,
<span class="tok-w">    </span><span class="tok-s2">&quot;lastUpdatedDate&quot;</span>:<span class="tok-w"> </span><span class="tok-s2">&quot;2024-07-11T07:30:59.000Z&quot;</span>,
<span class="tok-w">    </span><span class="tok-s2">&quot;kbVersion&quot;</span>:<span class="tok-w"> </span><span class="tok-s2">&quot;0.24.10&quot;</span>,
<span class="tok-w">    </span><span class="tok-s2">&quot;apiVersion&quot;</span>:<span class="tok-w"> </span><span class="tok-s2">&quot;0.54.0&quot;</span>,
<span class="tok-w">    </span><span class="tok-s2">&quot;pluginApiVersion&quot;</span>:<span class="tok-w"> </span><span class="tok-s2">&quot;0.27.1&quot;</span>,
<span class="tok-w">    </span><span class="tok-s2">&quot;commonVersion&quot;</span>:<span class="tok-w"> </span><span class="tok-s2">&quot;0.26.2&quot;</span>,
<span class="tok-w">    </span><span class="tok-s2">&quot;platformVersion&quot;</span>:<span class="tok-w"> </span><span class="tok-s2">&quot;0.41.9&quot;</span>,
<span class="tok-w">    </span><span class="tok-s2">&quot;pluginsInfo&quot;</span>:<span class="tok-w"> </span><span class="tok-o">[</span>
<span class="tok-w">      </span><span class="tok-o">{</span>
<span class="tok-w">        </span><span class="tok-s2">&quot;bundleSymbolicName&quot;</span>:<span class="tok-w"> </span><span class="tok-s2">&quot;org.kill-bill.billing.killbill-platform-osgi-bundles-kpm&quot;</span>,
<span class="tok-w">        </span><span class="tok-s2">&quot;pluginKey&quot;</span>:<span class="tok-w"> </span>null,
<span class="tok-w">        </span><span class="tok-s2">&quot;pluginName&quot;</span>:<span class="tok-w"> </span><span class="tok-s2">&quot;org.kill-bill.billing.killbill-platform-osgi-bundles-kpm&quot;</span>,
<span class="tok-w">        </span><span class="tok-s2">&quot;version&quot;</span>:<span class="tok-w"> </span>null,
<span class="tok-w">        </span><span class="tok-s2">&quot;state&quot;</span>:<span class="tok-w"> </span><span class="tok-s2">&quot;RUNNING&quot;</span>,
<span class="tok-w">        </span><span class="tok-s2">&quot;isSelectedForStart&quot;</span>:<span class="tok-w"> </span>true,
<span class="tok-w">        </span><span class="tok-s2">&quot;services&quot;</span>:<span class="tok-w"> </span><span class="tok-o">[]</span>
<span class="tok-w">      </span><span class="tok-o">}</span>,
<span class="tok-w">      </span><span class="tok-o">{</span>
<span class="tok-w">        </span><span class="tok-s2">&quot;bundleSymbolicName&quot;</span>:<span class="tok-w"> </span><span class="tok-s2">&quot;org.kill-bill.billing.killbill-platform-osgi-bundles-logger&quot;</span>,
<span class="tok-w">        </span><span class="tok-s2">&quot;pluginKey&quot;</span>:<span class="tok-w"> </span>null,
<span class="tok-w">        </span><span class="tok-s2">&quot;pluginName&quot;</span>:<span class="tok-w"> </span><span class="tok-s2">&quot;org.kill-bill.billing.killbill-platform-osgi-bundles-logger&quot;</span>,
<span class="tok-w">        </span><span class="tok-s2">&quot;version&quot;</span>:<span class="tok-w"> </span>null,
<span class="tok-w">        </span><span class="tok-s2">&quot;state&quot;</span>:<span class="tok-w"> </span><span class="tok-s2">&quot;RUNNING&quot;</span>,
<span class="tok-w">        </span><span class="tok-s2">&quot;isSelectedForStart&quot;</span>:<span class="tok-w"> </span>true,
<span class="tok-w">        </span><span class="tok-s2">&quot;services&quot;</span>:<span class="tok-w"> </span><span class="tok-o">[]</span>
<span class="tok-w">      </span><span class="tok-o">}</span>,
<span class="tok-w">      </span><span class="tok-o">{</span>
<span class="tok-w">        </span><span class="tok-s2">&quot;bundleSymbolicName&quot;</span>:<span class="tok-w"> </span><span class="tok-s2">&quot;org.kill-bill.billing.killbill-platform-osgi-bundles-metrics&quot;</span>,
<span class="tok-w">        </span><span class="tok-s2">&quot;pluginKey&quot;</span>:<span class="tok-w"> </span>null,
<span class="tok-w">        </span><span class="tok-s2">&quot;pluginName&quot;</span>:<span class="tok-w"> </span><span class="tok-s2">&quot;org.kill-bill.billing.killbill-platform-osgi-bundles-metrics&quot;</span>,
<span class="tok-w">        </span><span class="tok-s2">&quot;version&quot;</span>:<span class="tok-w"> </span>null,
<span class="tok-w">        </span><span class="tok-s2">&quot;state&quot;</span>:<span class="tok-w"> </span><span class="tok-s2">&quot;RUNNING&quot;</span>,
<span class="tok-w">        </span><span class="tok-s2">&quot;isSelectedForStart&quot;</span>:<span class="tok-w"> </span>true,
<span class="tok-w">        </span><span class="tok-s2">&quot;services&quot;</span>:<span class="tok-w"> </span><span class="tok-o">[]</span>
<span class="tok-w">      </span><span class="tok-o">}</span>
<span class="tok-w">    </span><span class="tok-o">]</span>
<span class="tok-w">  </span><span class="tok-o">}</span>
<span class="tok-o">]</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_diagnostic_command">Diagnostic Command</h3>
<div class="paragraph">
<p>The <code>diagnostic</code> option of the <code>Kill Bill Package Manager (kpm)</code> command creates an extensive report for a given tenant that may be useful for troubleshooting. See <a href="https://docs.killbill.io/latest/how-to-use-kpm-diagnostic">KPM Diagnostic Usage</a>.</p>
</div>
<div class="paragraph">
<p>To run this command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span></span><span class="tok-c1"># Login as &#39;tomcat&#39;</span>
&gt;<span class="tok-w"> </span>sudo<span class="tok-w"> </span>su<span class="tok-w"> </span>-<span class="tok-w"> </span>tomcat
<span class="tok-c1">#</span>
<span class="tok-c1"># Run the command with your access credentials:</span>
<span class="tok-c1">#</span>
&gt;<span class="tok-w"> </span>kpm<span class="tok-w">  </span>diagnostic<span class="tok-w"> </span><span class="tok-se">\</span>
<span class="tok-w">  </span>--account-export<span class="tok-o">=</span>&lt;account_id&gt;<span class="tok-w"> </span><span class="tok-se">\</span>
<span class="tok-w">  </span>--killbill-credentials<span class="tok-o">=</span>&lt;ADMIN&gt;<span class="tok-w"> </span>&lt;PASSWORD&gt;<span class="tok-w"> </span><span class="tok-se">\</span>
<span class="tok-w">  </span>--bundles-dir<span class="tok-o">=</span>/var/lib/killbill/bundles<span class="tok-w"> </span><span class="tok-se">\</span>
<span class="tok-w">  </span>--killbill-api-credentials<span class="tok-o">=</span>&lt;KEY&gt;<span class="tok-w"> </span>&lt;SECRET&gt;<span class="tok-w"> </span><span class="tok-se">\</span>
<span class="tok-w">  </span>--killbill-web-path<span class="tok-o">=</span>/var/lib/tomcat/webapps<span class="tok-w"> </span><span class="tok-se">\</span>
<span class="tok-w">  </span>--kaui-web-path<span class="tok-o">=</span>/var/lib/tomcat/webapps2<span class="tok-w"> </span><span class="tok-se">\</span>
<span class="tok-w">  </span>--killbill-url<span class="tok-o">=</span>http://127.0.0.1:8080</code></pre>
</div>
</div>
<div class="paragraph">
<p>You will need to edit this command to include:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Your admin username and password</p>
</li>
<li>
<p>The public key and secret key for your tenant (&lt;KEY&gt; &lt;SECRET&gt;)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The last line of the response should look like:</p>
</div>
<div class="paragraph">
<p><code>Diagnostic data is exported under /tmp/killbill-diagnostics-20200213-23204-u93ah5/killbill-diagnostics-02-13-20.zip</code></p>
</div>
<div class="paragraph">
<p>The specified zip file contains several reports of various sizes. This report can be downloaded to your computer using <code>sftp</code> and forwarded to Kill Bill for analysis.</p>
</div>
</div>
<div class="sect2">
<h3 id="_databases">Databases</h3>
<div class="paragraph">
<p>To access the mysql (MariaDB) databases, you can use the following command:</p>
</div>
<div class="paragraph">
<p><code>mysql -u root -proot</code></p>
</div>
<div class="paragraph">
<p>This enables interactive access to the database manager. There is one <code>killbill</code> and one <code>kaui</code> database created and used by the respective applications. To verify the tables in each database, you can type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sql"><span></span><span class="tok-n">use</span><span class="tok-w"> </span><span class="tok-n">killbill</span>
<span class="tok-k">show</span><span class="tok-w"> </span><span class="tok-n">tables</span><span class="tok-p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sql"><span></span><span class="tok-n">use</span><span class="tok-w"> </span><span class="tok-n">kaui</span>
<span class="tok-k">show</span><span class="tok-w"> </span><span class="tok-n">tables</span><span class="tok-p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Standard SQL commands can be used to explore or manipulate the tables. Be sure you know what you are doing, or the databases may become corrupted!</p>
</div>
<div class="paragraph">
<p>To exit the mysql interactive mode, type <code>exit</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_load_balancer">Load Balancer</h3>
<div class="paragraph">
<p>The load balancer <code>nginx</code> should normally require little attention. The configuration files are located under <code>/etc/nginx/</code>. The configuration file for <code>nginx</code> itself is <code>/etc/nginx/nginx.conf</code>. Additional configuration files are located under <code>/etc/nginx/sites-enabled/</code>. The only file normally present in this directory is <code>/etc/nginx/sites-enabled/killbill.conf</code>.</p>
</div>
<div class="paragraph">
<p>Nginx logs can be found under <code>/var/log/nginx/</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Access logs: <code>/var/log/nginx/access.log</code></p>
</li>
<li>
<p>Error logs: <code>/var/log/nginx/error.log</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration">Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Kill Bill defines a number of global properties and per-tenant properties that can be varied. These properties are explained in the <a href="https://docs.killbill.io/latest/userguide_configuration.html">Kill Bill and Kaui Configuration Guide</a>. Default values for these properties are built into the Kill Bill code; these values can be overridden by values defined in the file <code>/var/lib/killbill/config/killbill.properties</code>. For example, this is where you can change the database URL and credentials.</p>
</div>
<div class="paragraph">
<p>This file also defines the location of the <code>shiro.ini</code> file, which by default is in the <code>/var/lib/killbill/config</code> directory. The <code>shiro.ini</code> file defines the Kill Bill admin credentials, along with any other users and their roles. See the <a href="https://docs.killbill.io/latest/user_management.html">Users, Roles, and Permissions Management</a> guide for details about this file.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_upgrades">Upgrades</h2>
<div class="sectionbody">
<div class="paragraph">
<p>From time to time new versions of Kill Bill are released. These versions can be incorporated in your installation with minimal impact on production. This section explains how to upgrade to a new version of Kill Bill. Note that these are <strong>not</strong> the same as new versions of the AMI, which can be incorporated only by a full re-installation.</p>
</div>
<div class="paragraph">
<p>You can upgrade KB using the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Log in to your instance using <code>ssh</code>.</p>
</li>
<li>
<p>Switch to the <code>tomcat</code> user:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span></span>sudo<span class="tok-w"> </span>su<span class="tok-w"> </span>-<span class="tok-w"> </span>tomcat</code></pre>
</div>
</div>
</li>
<li>
<p>Update <code>/var/lib/killbill/kpm.yml</code> with the appropriate KB version. For example, to upgrade to KB <code>0.24.9</code>, update this file as follows:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml"><span></span><span class="tok-nt">killbill</span><span class="tok-p">:</span>
<span class="tok-w">  </span><span class="tok-nt">version</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-l tok-l-Scalar tok-l-Scalar-Plain">0.24.9</span>
<span class="tok-w">  </span><span class="tok-nt">plugins</span><span class="tok-p">:</span>
<span class="tok-w">  </span><span class="tok-nt">plugins_dir</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-l tok-l-Scalar tok-l-Scalar-Plain">/var/lib/killbill/bundles</span>
<span class="tok-w">  </span><span class="tok-nt">webapp_path</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-l tok-l-Scalar tok-l-Scalar-Plain">/var/lib/tomcat/webapps/ROOT.war</span></code></pre>
</div>
</div>
</li>
<li>
<p>Delete the cached <code>webapps/ROOT</code> directory:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span></span>rm<span class="tok-w"> </span>-rf<span class="tok-w"> </span>/var/lib/tomcat/webapps/ROOT</code></pre>
</div>
</div>
</li>
<li>
<p>Run the following command to update KB:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span></span><span class="tok-nv">$KPM_INSTALL_KB_CMD</span></code></pre>
</div>
</div>
</li>
<li>
<p>Restart KB:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span></span>sudo<span class="tok-w"> </span>service<span class="tok-w"> </span>killbill<span class="tok-w"> </span>restart</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>You can upgrade Kaui using the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Log in to your instance using <code>ssh</code>.</p>
</li>
<li>
<p>Switch to the <code>tomcat</code> user:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span></span>sudo<span class="tok-w"> </span>su<span class="tok-w"> </span>-<span class="tok-w"> </span>tomcat</code></pre>
</div>
</div>
</li>
<li>
<p>Update <code>/var/lib/kaui/kpm.yml</code> with the appropriate Kaui version. For example, to upgrade to Kaui <code>3.0.6</code>, edit this file as follows:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml"><span></span><span class="tok-nt">kaui</span><span class="tok-p">:</span>
<span class="tok-w">  </span><span class="tok-nt">version</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-l tok-l-Scalar tok-l-Scalar-Plain">3.0.6</span>
<span class="tok-w">  </span><span class="tok-c1"># Used for the sha1.yml</span>
<span class="tok-w">  </span><span class="tok-nt">plugins_dir</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-l tok-l-Scalar tok-l-Scalar-Plain">/var/lib/kaui/bundles</span>
<span class="tok-w">  </span><span class="tok-nt">webapp_path</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-l tok-l-Scalar tok-l-Scalar-Plain">/var/lib/tomcat/webapps2/ROOT.war</span></code></pre>
</div>
</div>
</li>
<li>
<p>Delete the cached <code>webapps2/ROOT</code> directory:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span></span>rm<span class="tok-w"> </span>-rf<span class="tok-w"> </span>/var/lib/tomcat/webapps2/ROOT</code></pre>
</div>
</div>
</li>
<li>
<p>Run the following command to update Kaui:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span></span><span class="tok-nv">$KPM_INSTALL_KAUI_CMD</span></code></pre>
</div>
</div>
</li>
<li>
<p>Restart KB:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span></span>sudo<span class="tok-w"> </span>service<span class="tok-w"> </span>killbill<span class="tok-w"> </span>restart</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ssl_certificate">SSL Certificate</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The KB single tier AMI comes pre-configured with a self-signed certificate. This can be found at <code>/etc/nginx/ssl/ssl-cert-snakeoil.pem</code> (public key) and <code>/etc/nginx/ssl/ssl-cert-snakeoil.key</code> (private key). Some backend systems might not trust this certificate, leading to SSL related failures. There are two possible solutions:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>You can update the backend to trust KB&#8217;s self-signed certificate. This involves configuring the backend application to trust the certificate. For instance, if your backend is using Java, you can add KB&#8217;s certificate to the truststore.</p>
</li>
<li>
<p>If you prefer not to modify the backend, you can obtain a valid certificate from a Certificate Authority. This certificate would be automatically trusted by most clients without requiring any additional configuration in your backend application. Let’s Encrypt is a root CA that is free to use. See <a href="https://docs.killbill.io/latest/using-https#_using_lets_encrypt_with_certbot">Using Let&#8217;s Encrypt</a>.</p>
</li>
</ol>
</div>
</div>
</div></div><div class="bottom-nav-links"><a href="#" id="prev-nav-link" class="bottom-nav-link card prev"><span class="arrow-icon left"><svg class="i-arrow" width="12" height="11" viewBox="0 0 12 11" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.19526 1.02876C4.45561 0.768409 4.87772 0.768409 5.13807 1.02876C5.39842 1.28911 5.39842 1.71122 5.13807 1.97157L2.27614 4.8335H11.3333C11.7015 4.8335 12 5.13197 12 5.50016C12 5.86835 11.7015 6.16683 11.3333 6.16683H2.27614L5.13807 9.02876C5.39842 9.28911 5.39842 9.71122 5.13807 9.97157C4.87772 10.2319 4.45561 10.2319 4.19526 9.97157L0.195261 5.97157C-0.0650883 5.71122 -0.0650883 5.28911 0.195261 5.02876L4.19526 1.02876Z" fill=""/></svg><span class="prev-text">Previous</span></span><span id="prev-navigator" class="bottom-nav-text">Prev</span>                               </a><a href="#" id="next-nav-link" class="bottom-nav-link card next"><span class="arrow-icon"><span class="next-text">Next</span><svg class="i-arrow icon-left" width="12" height="11" viewBox="0 0 12 11" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.19526 1.02876C4.45561 0.768409 4.87772 0.768409 5.13807 1.02876C5.39842 1.28911 5.39842 1.71122 5.13807 1.97157L2.27614 4.8335H11.3333C11.7015 4.8335 12 5.13197 12 5.50016C12 5.86835 11.7015 6.16683 11.3333 6.16683H2.27614L5.13807 9.02876C5.39842 9.28911 5.39842 9.71122 5.13807 9.97157C4.87772 10.2319 4.45561 10.2319 4.19526 9.97157L0.195261 5.97157C-0.0650883 5.71122 -0.0650883 5.28911 0.195261 5.02876L4.19526 1.02876Z" fill=""/></svg></span><span id="next-navigator" class="bottom-nav-text">Next</span></a></div></article></div><div class="bd-links-wrapper"><nav class="bd-links toc right-side-menu" id="myScrollspy" data-toggle="toc"></nav></div></div></div></div></div></main><script src="javascripts/jquery-3.6.1.min.js"></script><script src="javascripts/bootstrap.min.js"></script><script src="javascripts/bootstrap-toc.min.js"></script><script type="module" src="javascripts/kb.js"></script><script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script><script>docsearch({apiKey: '3ef227e7fd5e2e1a3fffd880484934bf', container: '#docsearch', appId: 'S2ISXITURI', indexName: 'killbill'});</script><script>
  jQuery(document).ready(function($){
    $('.sidebar-nav .icon-title').on('click', function (e) {
      e.preventDefault();
      $('.sidebar-nav .nav.navbar-nav .nav.navbar-nav').slideUp(200);
      $('.sidebar-nav > .navbar-nav > li').removeClass('open');

      if($(this).next().is(':visible')){
        $('.sidebar-nav .nav.navbar-nav .nav.navbar-nav').slideUp(200);
        $('.sidebar-nav > .navbar-nav > li').removeClass('open');
      } else {
        $(this).parent().addClass('open');
        $(this).next().slideDown(200);
      }
    });

    let pageURL = $(location).attr("href");
    pageURL = pageURL.includes('.html') ? pageURL : pageURL + '.html';
    $('.nav-link').each(function() {
      if (pageURL.toLowerCase().includes($(this).attr('href').toLowerCase())) {
        $(this).parent().addClass('list-item-active');
        $(this).parent().parent().addClass('active-list');
        $(this).parent().parent().prev().addClass('bd-link-active-wrap');
      }
    });
  });
</script>
</body></html>